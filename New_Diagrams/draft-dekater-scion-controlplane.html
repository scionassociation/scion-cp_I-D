<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SCION Control Plane</title>
<meta content="Corine de Kater" name="author">
<meta content="Nicola Rustignoli" name="author">
<meta content="Samuel Hitz" name="author">
<meta content="
       This document describes the Control Plane of the path-aware, inter-domain network architecture SCION (Scalability, Control, and Isolation On Next-generation networks). A fundamental characteristic of SCION is that it gives path control to SCION-capable endpoints that can choose between multiple path options, thereby enabling the optimization of network paths. The Control Plane is responsible for discovering these paths and making them available to the endpoints. 
       The SCION Control Plane creates and securely disseminates path segments between SCION Autonomous Systems (AS) which can then be combined into forwarding paths to transmit packets in the data plane. This document describes mechanisms of path exploration through beaconing and path registration. In addition, it describes how Endpoints construct end-to-end paths from a set of possible path segments through a path lookup process. 
       This document contains new approaches to secure path aware networking. It is not an Internet Standard, has not received any formal review of the IETF, nor was the work developed through the rough consensus process. The approaches offered in this work are offered to the community for its consideration in the further evolution of the Internet. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-dekater-scion-controlplane-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-dekater-scion-controlplane.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SCION CP</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">de Kater, et al.</td>
<td class="center">Expires 19 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dekater-scion-controlplane-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-17" class="published">17 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-19">19 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. de Kater</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">N. Rustignoli</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">S. Hitz</div>
<div class="org">Anapaya Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SCION Control Plane</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Control Plane of the path-aware, inter-domain network architecture SCION (Scalability, Control, and Isolation On Next-generation networks). A fundamental characteristic of SCION is that it gives path control to SCION-capable endpoints that can choose between multiple path options, thereby enabling the optimization of network paths. The Control Plane is responsible for discovering these paths and making them available to the endpoints.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The SCION Control Plane creates and securely disseminates path segments between SCION Autonomous Systems (AS) which can then be combined into forwarding paths to transmit packets in the data plane. This document describes mechanisms of path exploration through beaconing and path registration. In addition, it describes how Endpoints construct end-to-end paths from a set of possible path segments through a path lookup process.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document contains new approaches to secure path aware networking. It is not an Internet Standard, has not received any formal review of the IETF, nor was the work developed through the rough consensus process. The approaches offered in this work are offered to the community for its consideration in the further evolution of the Internet.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://scionassociation.github.io/scion-cp_I-D/draft-dekater-scion-controlplane.html">https://scionassociation.github.io/scion-cp_I-D/draft-dekater-scion-controlplane.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-dekater-scion-controlplane/">https://datatracker.ietf.org/doc/draft-dekater-scion-controlplane/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/scionassociation/scion-cp_I-D">https://github.com/scionassociation/scion-cp_I-D</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-paths-and-links" class="internal xref">Paths and Links</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-routing" class="internal xref">Routing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-path-segments" class="internal xref">Path Segments</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-addressing" class="internal xref">Addressing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.1">
                    <p id="section-toc.1-1.1.2.5.2.1.1"><a href="#section-1.5.1" class="auto internal xref">1.5.1</a>.  <a href="#name-isd-numbers" class="internal xref">ISD Numbers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.2">
                    <p id="section-toc.1-1.1.2.5.2.2.1"><a href="#section-1.5.2" class="auto internal xref">1.5.2</a>.  <a href="#name-scion-as-numbers" class="internal xref">SCION AS Numbers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.3">
                    <p id="section-toc.1-1.1.2.5.2.3.1"><a href="#section-1.5.3" class="auto internal xref">1.5.3</a>.  <a href="#name-text-representation" class="internal xref">Text Representation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.4">
                    <p id="section-toc.1-1.1.2.5.2.4.1"><a href="#section-1.5.4" class="auto internal xref">1.5.4</a>.  <a href="#name-wildcard-addressing" class="internal xref">Wildcard Addressing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.5">
                    <p id="section-toc.1-1.1.2.5.2.5.1"><a href="#section-1.5.5" class="auto internal xref">1.5.5</a>.  <a href="#name-special-purpose-scion-as-nu" class="internal xref">Special-Purpose SCION AS Numbers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-bootstrapping-ability" class="internal xref">Bootstrapping ability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="auto internal xref">1.7</a>.  <a href="#name-resistance-to-partitioning" class="internal xref">Resistance to partitioning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8">
                <p id="section-toc.1-1.1.2.8.1"><a href="#section-1.8" class="auto internal xref">1.8</a>.  <a href="#name-communication-protocol" class="internal xref">Communication Protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-path-exploration-or-beaconi" class="internal xref">Path Exploration or Beaconing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-introduction-and-overview" class="internal xref">Introduction and Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-peering-links" class="internal xref">Peering Links</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-appending-entries-to-a-pcb" class="internal xref">Appending Entries to a PCB</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="auto internal xref">2.1.3</a>.  <a href="#name-pcb-propagation-illustrated" class="internal xref">PCB Propagation - Illustrated Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-path-segment-construction-b" class="internal xref">Path-Segment Construction Beacons (PCBs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-pcb-message-format" class="internal xref">PCB Message Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-pcb-extensions" class="internal xref">PCB Extensions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-pcb-validity" class="internal xref">PCB Validity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="auto internal xref">2.2.4</a>.  <a href="#name-configuration" class="internal xref">Configuration</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-propagation-of-pcbs" class="internal xref">Propagation of PCBs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-reception-of-pcbs" class="internal xref">Reception of PCBs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-storing-candidate-pcbs" class="internal xref">Storing Candidate PCBs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-pcb-selection-policies" class="internal xref">PCB Selection Policies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-propagation-interval-and-be" class="internal xref">Propagation Interval and Best PCBs Set Size</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.5">
                    <p id="section-toc.1-1.2.2.3.2.5.1"><a href="#section-2.3.5" class="auto internal xref">2.3.5</a>.  <a href="#name-propagation-of-selected-pcb" class="internal xref">Propagation of Selected PCBs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-monitoring-considerations" class="internal xref">Monitoring Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-effects-of-clock-inaccuracy" class="internal xref">Effects of Clock Inaccuracy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-path-discovery-time-and-sca" class="internal xref">Path Discovery Time and Scalability</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-intra-isd-beaconing" class="internal xref">Intra-ISD Beaconing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-inter-isd-beaconing" class="internal xref">Inter-ISD Beaconing</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-registration-of-path-segmen" class="internal xref">Registration of Path Segments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-intra-isd-path-segment-regi" class="internal xref">Intra-ISD Path Segment Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-terminating-a-pcb" class="internal xref">Terminating a PCB</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-transforming-a-pcb-into-an-" class="internal xref">Transforming a PCB into an Up Segment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-transforming-a-pcb-into-a-d" class="internal xref">Transforming a PCB into a Down Segment</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-core-path-segment-registrat" class="internal xref">Core Path Segment Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-path-segment-registration-g" class="internal xref">Path Segment Registration gRPC API</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-path-mtu" class="internal xref">Path MTU</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-path-lookup" class="internal xref">Path Lookup</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-lookup-process" class="internal xref">Lookup Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-sequence-of-lookup-requests" class="internal xref">Sequence of Lookup Requests</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-caching" class="internal xref">Caching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-behavior-of-actors-in-the-l" class="internal xref">Behavior of Actors in the Lookup Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-use-of-wildcard-addresses-i" class="internal xref">Use of Wildcard Addresses in the Lookup Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-segment-request-handler-of-" class="internal xref">Segment-Request Handler of a Non-Core Source AS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-segment-request-handler-of-a" class="internal xref">Segment-Request Handler of a Core AS</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-scmp" class="internal xref">SCMP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-general-format" class="internal xref">General Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-message-types" class="internal xref">Message Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-checksum-calculation" class="internal xref">Checksum Calculation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-processing-rules" class="internal xref">Processing Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-error-messages" class="internal xref">Error Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-packet-too-big" class="internal xref">Packet Too Big</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-external-interface-down" class="internal xref">External Interface Down</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="auto internal xref">6.5.3</a>.  <a href="#name-internal-connectivity-down" class="internal xref">Internal Connectivity Down</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-informational-messages" class="internal xref">Informational Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.1">
                    <p id="section-toc.1-1.6.2.6.2.1.1"><a href="#section-6.6.1" class="auto internal xref">6.6.1</a>.  <a href="#name-echo-request" class="internal xref">Echo Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.2">
                    <p id="section-toc.1-1.6.2.6.2.2.1"><a href="#section-6.6.2" class="auto internal xref">6.6.2</a>.  <a href="#name-echo-reply" class="internal xref">Echo Reply</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.3">
                    <p id="section-toc.1-1.6.2.6.2.3.1"><a href="#section-6.6.3" class="auto internal xref">6.6.3</a>.  <a href="#name-traceroute-request" class="internal xref">Traceroute Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.4">
                    <p id="section-toc.1-1.6.2.6.2.4.1"><a href="#section-6.6.4" class="auto internal xref">6.6.4</a>.  <a href="#name-traceroute-reply" class="internal xref">Traceroute Reply</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-scmp-authentication" class="internal xref">SCMP Authentication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-security-properties" class="internal xref">Security Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-manipulation-of-the-beaconi" class="internal xref">Manipulation of the Beaconing Process by a Core Adversary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-manipulation-of-the-beaconin" class="internal xref">Manipulation of the Beaconing Process by a Non-Core Adversary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-path-hijacking-through-inte" class="internal xref">Path Hijacking through Interposition</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-creation-of-spurious-ases-a" class="internal xref">Creation of Spurious ASes and ISDs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-peering-link-misuse" class="internal xref">Peering Link Misuse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4" class="auto internal xref">7.3.4</a>.  <a href="#name-manipulation-of-the-path-se" class="internal xref">Manipulation of the Path-Selection Process</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-denial-of-service-attacks" class="internal xref">Denial of Service Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-deployment-testing-scionlab" class="internal xref">Deployment Testing: SCIONLab</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-full-control-service-grpc-a" class="internal xref">Full Control Service gRPC API</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-scion-data-plane-use-by-the" class="internal xref">SCION Data Plane use by the SCION Control Plane</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-path-lookup-examples" class="internal xref">Path-Lookup Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-F.1" class="auto internal xref"></a><a href="#name-draft-dekater-scion-control" class="internal xref">draft-dekater-scion-controlplane-08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-F.2" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlp" class="internal xref">draft-dekater-scion-controlplane-07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-F.3" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlpl" class="internal xref">draft-dekater-scion-controlplane-06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-F.4" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlpla" class="internal xref">draft-dekater-scion-controlplane-05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#appendix-F.5" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplan" class="internal xref">draft-dekater-scion-controlplane-04</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">SCION is a path-aware internetworking routing architecture as described in <span>[<a href="#RFC9217" class="cite xref">RFC9217</a>]</span>. It allows endpoints and applications to select paths across the network to use for traffic, based on trustworthy path properties. SCION is an inter-domain network architecture and is therefore not concerned with intra-domain forwarding.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">SCION has been developed with the following goals:<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><em>Availability</em> - to provide highly available communication that can send traffic over paths with optimal or required characteristics, quickly handle inter-domain link or router failures (both on the last hop or anywhere along the path) and provide continuity in the presence of adversaries.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><em>Security</em> - to introduce a new approach to inter-domain path security that leverages path awareness in combination with a unique trust model. The goal is to provide higher levels of trustworthiness in routing information to prevent traffic hijacking, and enable users to decide where their data travels based on routing information that can be unambiguously attributed to an AS, ensuring that packets are only forwarded along authorized path segments. A particular use case is to enable geofencing. Security properties are further discussed in <a href="#security-properties" class="auto internal xref">Section 7.1</a>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><em>Scalability</em> - to improve the scalability of the inter-domain control plane and data plane, avoiding existing limitations related to convergence and forwarding table size. The advertising of path segments is separated into a beaconing process within each Isolation Domain (ISD) and between ISDs which incurs minimal overhead and resource requirements on routers.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">SCION relies on three main components:<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"><em>PKI</em> - To achieve scalability and trust, SCION organizes existing ASes into logical groups of independent routing planes called <em>Isolation Domains (ISDs)</em>. All ASes in an ISD agree on a set of trust roots called the <em>Trust Root Configuration (TRC)</em> which is a collection of signed root certificates in X.509 v3 format <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The ISD is governed by a set of <em>core ASes</em> which typically manage the trust roots and provide connectivity to other ISDs. This is the basis of the public key infrastructure which the SCION Control Plane relies upon for the authentication of messages that is used for the SCION Control Plane. See <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span><a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><em>Control Plane</em> - performs inter-domain routing by discovering and securely disseminating path information between ASes. The core ASes use Path-segment Construction Beacons (PCBs) to explore intra-ISD paths, or to explore paths across different ISDs.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9"><em>Data Plane</em> - carries out secure packet forwarding between SCION-enabled ASes over paths selected by endpoints. A SCION border router reuses existing intra-domain infrastructure to communicate to other SCION routers or SCION endpoints within its AS. See <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span><a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">This document describes the SCION Control Plane component. It should be read in conjunction with the other components <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span> and <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">The SCION architecture was initially developed outside of the IETF by ETH Zurich with significant contributions from Anapaya Systems. It is deployed in the Swiss finance sector to provide resilient connectivity between financial institutions. The aim of this document is to document the existing protocol specification as deployed, to encourage interoperability among implementations, and to introduce new concepts that can potentially be further improved to address particular problems with the current Internet architecture. This document is not an Internet Standards Track specification; it does not have IETF consensus and it is published for informational purposes.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">Note (to be removed before publication): this document, together with the other components <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span> and <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>, deprecates <span>[<a href="#I-D.dekater-panrg-scion-overview" class="cite xref">I-D.dekater-panrg-scion-overview</a>]</span>.<a href="#section-1-12" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1"><strong>Autonomous System (AS)</strong>: An Autonomous System is a network under a common administrative control. For example, the network of an Internet service provider, company, or university can constitute an AS.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2"><strong>Beaconing</strong>: The Control Plane process where an AS discovers paths to other ASes.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3"><strong>Control Plane</strong>: The SCION Control Plane is responsible for the propagation and discovery of network paths, i.e., for the exchange of routing information between SCION nodes. The Control Plane thus determines where traffic can be sent and deals with questions such as how paths are discovered, which paths exist, how they are disseminated to endpoints, etc. Within a SCION AS, such functionalities are carried out by the Control Service whereas packet forwarding is a task carried out by the data plane.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4"><strong>Control Service</strong>: The Control Service is the main control plane infrastructure component within a SCION AS. It is responsible for the path exploration and registration processes that take place within the Control Plane.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5"><strong>Core AS</strong>: Each Isolation Domain (ISD) is administered by a set of distinguished autonomous systems (ASes) called core ASes, which are responsible for initiating the path-discovery and -construction process (in SCION called "beaconing"). Each ISD <span class="bcp14">MUST</span> have at least one Core AS.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6"><strong>Endpoint</strong>: An endpoint is the start or the end of a SCION path, as defined in <span>[<a href="#RFC9473" class="cite xref">RFC9473</a>]</span>.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7"><strong>Forwarding Path</strong>: A forwarding path is a complete end-to-end path between two SCION endpoints which is used to transmit packets in the data plane. It can be created with a combination of up to three path segments (an up segment, a core segment, and a down segment).<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8"><strong>Hop Field (HF)</strong>: Hop Field (HF): As they traverse the network, Path Segment Construction Beacons (PCBs) accumulate cryptographically protected AS-level path information in the form of Hop Fields. In the data plane, Hop Fields are used for packet forwarding: they contain the incoming and outgoing interface IDs of the ASes on the forwarding path.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9"><strong>Info Field (INF)</strong>: Info Field (INF): Each Path Segment Construction Beacon (PCB) contains a single Info field, which provides basic information about the PCB. Together with Hop Fields (HFs), these are used to create forwarding paths.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10"><strong>Isolation Domain (ISD)</strong>: Isolation Domain (ISD): In SCION, Autonomous Systems (ASes) are organized into logical groups called Isolation Domains or ISDs. Each ISD consists of ASes that span an area with a uniform trust environment (e.g. a common jurisdiction). A possible model is for ISDs to be formed along national boundaries or federations of nations.<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11"><strong>Leaf AS</strong>: An AS at the "edge" of an ISD, with no other downstream ASes.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12"><strong>MAC</strong>: Message Authentication Code. In the rest of this document, "MAC" always refers to "Message Authentication Code" and never to "Medium Access Control". When "Medium Access Control address" is implied, the phrase "Link Layer Address" is used.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<p id="section-1.1-13"><strong>Path Segment</strong>: Path segments are derived from Path Segment Construction Beacons (PCBs). A path segment can be (1) an up segment (i.e. a path between a non-core AS and a core AS in the same ISD), (2) a down segment (i.e. the same as an up segment, but in the opposite direction), or (3) a core segment (i.e., a path between core ASes). Up to three path segments can be used to create a forwarding path.<a href="#section-1.1-13" class="pilcrow">¶</a></p>
<p id="section-1.1-14"><strong>Path Segment Construction Beacon (PCB)</strong>: Core AS control planes generate PCBs to explore paths within their isolation domain (ISD) and among different ISDs. ASes further propagate selected PCBs to their neighboring ASes. These PCBs traverse each AS accumulating information, including Hop Fields (HFs) which can subsequently be used for traffic forwarding.<a href="#section-1.1-14" class="pilcrow">¶</a></p>
<p id="section-1.1-15"><strong>SCMP</strong>: A signaling protocol analogous to the Internet Control Message Protocol (ICMP). This is described in <a href="#scmp" class="auto internal xref">Section 6</a>.<a href="#section-1.1-15" class="pilcrow">¶</a></p>
<p id="section-1.1-16"><strong>Trust Root Configuration (TRC)</strong>: A Trust Root Configuration or TRC is a signed collection of certificates pertaining to an isolation domain (ISD). TRCs also contain ISD-specific policies.<a href="#section-1.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1.2">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="paths-links">
<section id="section-1.3">
        <h3 id="name-paths-and-links">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-paths-and-links" class="section-name selfRef">Paths and Links</a>
        </h3>
<p id="section-1.3-1">SCION routers and endpoints connect to each other via links. A SCION path between two endpoints essentially traverses one or more links.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">In SCION, Autonomous Systems (ASes) are organized into logical groups called Isolation Domains or ISDs. Each ISD consists of ASes that span an area with a uniform trust environment (i.e. a common jurisdiction). An ISD is administered by a set of distinguished ASes called core ASes.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">SCION distinguishes three types of links between ASes: (1) core links, (2) parent-child links, and (3) peering links.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-4.1">
            <p id="section-1.3-4.1.1"><em>Core</em> links connect two core ASes, which are either within the same or in different ISDs. Core links can exist for various reasons, including provider-customer (where the customer pays the provider for traffic) and peering relationships.<a href="#section-1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.2">
            <p id="section-1.3-4.2.1"><em>Parent-child</em> links create a hierarchy between the parent and the child AS within the same ISD. ASes with a parent-child link typically have a provider-customer relationship.<a href="#section-1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.3">
            <p id="section-1.3-4.3.1"><em>Peering</em> links exist between ASes with a (settlement-free or paid) peering relationship. They can be established between any two ASes (core or non-core) and can cross ISD boundaries.<a href="#section-1.3-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.3-5">These link types form the basis of the notion of "valley free" paths. Valley free paths means that a child AS does not carry transit traffic from a parent AS to another parent AS.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">The SCION paths are always valley free, and consist of at most three segments: an up segment, traversing links from child to parent, then a core segment consisting of core links, followed by a down segment traversing links from parent to child. Peering links can be used as "shortcuts" in an up-core-down path.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7">A path can contain at most one peering link shortcut which means they can only be used in paths between ASes within the "customer cone" of the ASes connected by the peering link.<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<p id="section-1.3-8"><a href="#_figure-1" class="auto internal xref">Figure 1</a> shows the three types of links for one small ISD with two core ASes A and C, and four non-core ASes D,E,F, and G.<a href="#section-1.3-8" class="pilcrow">¶</a></p>
<span id="name-the-three-types-of-scion-li"></span><div id="_figure-1">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-1.3-9.1">
<pre>
┌┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┐
┆                         ┆       #
┆        ISD Core         ┆       │      parent-child
┆ ┌─────┐         ┌─────┐ ┆       │      link
┆ │AS A │*───────*│AS C │ ┆       │
┆ └──#──┘         └──#──┘ ┆       0
┆    │               │    ┆
└┄┄┄┄│┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄│┄┄┄┄┘   *───────*  core link
     │               │
     │               │        ◀ - - - ▶  peering link
  ┌──0──┐         ┌──0──┐
  │AS D │◀ - - - ▶│AS E │
  └──#──┘         └──#──┘
     │               │
     │               │
     │               │
  ┌──0──┐         ┌──0──┐
  │AS G │         │AS F │
  └─────┘         └─────┘
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-three-types-of-scion-li" class="selfRef">The three types of SCION links in one ISD. Each node in the figure is a SCION AS.</a>
          </figcaption></figure>
</div>
<p id="section-1.3-10">Each link connecting SCION routers is bi-directional and is identified by its corresponding egress and ingress interface IDs. An interface ID consists of a 16-bit identifier that <span class="bcp14">MUST</span> be unique within each AS, with the exception of value 0 (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>). Therefore, they can be chosen and encoded by each AS independently without any need for coordination between ASes.<a href="#section-1.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing">
<section id="section-1.4">
        <h3 id="name-routing">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-routing" class="section-name selfRef">Routing</a>
        </h3>
<p id="section-1.4-1">SCION provides path-aware inter-domain routing between ASes across the Internet. The SCION Control Plane is responsible for discovering these inter-domain paths and making them available to the endpoints within the ASes.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">SCION inter-domain routing operates on two levels: within a ISD which is called <em>intra</em>-ISD routing, and between ISD which is called <em>inter</em>-ISD routing. Both levels use <em>Path Segment Construction Beacons (PCBs)</em> to explore network paths. A PCB is initiated by a core AS and then disseminated either within an ISD to explore intra-ISD paths, or among core ASes to explore core paths across different ISDs.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">The PCBs accumulate cryptographically protected path and forwarding information at an AS level and store this information in the form of <em>Hop Fields</em>. Endpoints use information from these Hop Fields to create end-to-end forwarding paths for data packets that carry this information in their headers. This also supports multi-path communication among endpoints.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">The creation of an end-to-end forwarding path consists of the following processes:<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.4-5">
<li id="section-1.4-5.1">
            <p id="section-1.4-5.1.1"><em>Path exploration (or beaconing)</em>: This is the process where an AS discovers paths to other ASes. See also <a href="#beaconing" class="auto internal xref">Section 2</a>.<a href="#section-1.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.4-5.2">
            <p id="section-1.4-5.2.1"><em>Path registration</em>: This is the process where an AS selects a few PCBs, according to defined policies, turns the selected PCBs into path segments, and adds these path segments to the relevant path infrastructure, thus making them available to other ASes. See also <a href="#path-segment-reg" class="auto internal xref">Section 4</a>.<a href="#section-1.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.4-5.3">
            <p id="section-1.4-5.3.1"><em>Path resolution</em>: This is the process of actually creating an end-to-end forwarding path from the source endpoint to the destination. For this, an endpoint performs (a) a path lookup step to obtain path segments, and (b) a path combination step to combine the forwarding path from the segments. This last step takes place in the data plane. See also <a href="#lookup" class="auto internal xref">Section 5</a>.<a href="#section-1.4-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.4-6">All processes operate concurrently.<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7">The <strong>Control Service</strong> is responsible for the path exploration and registration processes in the Control Plane. It is the main control plane infrastructure component within each SCION AS and has the following tasks:<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-8.1">
            <p id="section-1.4-8.1.1">Generating, receiving, and propagating PCBs. Periodically, the Control Service of a core AS generates a set of PCBs, which are forwarded to the child ASes or neighboring core ASes. In the latter case, the PCBs are sent over policy compliant paths to discover multiple paths between any pair of core ASes.<a href="#section-1.4-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-8.2">
            <p id="section-1.4-8.2.1">Selecting and registering the set of path segments via which the AS wants to be reached.<a href="#section-1.4-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-8.3">
            <p id="section-1.4-8.3.1">Managing certificates and keys to secure inter-AS communication. Each PCB contains signatures of all on-path ASes and each time the Control Service of an AS receives a PCB, it validates the PCB's authenticity. When the Control Service lacks an intermediate certificate, it can query the Control Service of the neighboring AS that sent the PCB through the API described in <a href="#_figure-36" class="auto internal xref">Figure 30</a>.<a href="#section-1.4-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.4-9"><strong>Note:</strong> The Control Service of an AS is decoupled from SCION border routers. The Control Service of a specific AS is part of the Control Plane, is responsible for <em>finding and registering suitable paths</em>, and can be deployed anywhere inside the AS. Border routers are deployed at the edge of an AS and their main tasks are to <em>forward data packets</em>.<a href="#section-1.4-9" class="pilcrow">¶</a></p>
<div id="path-segments">
<section id="section-1.4.1">
          <h4 id="name-path-segments">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-path-segments" class="section-name selfRef">Path Segments</a>
          </h4>
<p id="section-1.4.1-1">SCION distinguishes the following types of path segments:<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-2.1">
              <p id="section-1.4.1-2.1.1">A path segment from a non-core AS to a core AS is an <em>up segment</em>.<a href="#section-1.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-2.2">
              <p id="section-1.4.1-2.2.1">A path segment from a core AS to a non-core AS is a <em>down segment</em>.<a href="#section-1.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-2.3">
              <p id="section-1.4.1-2.3.1">A path segment between core ASes is a <em>core segment</em>.<a href="#section-1.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.1-3">Each path segment starts and/or ends at a core AS.<a href="#section-1.4.1-3" class="pilcrow">¶</a></p>
<p id="section-1.4.1-4">All path segments may be reversed: a core segment can be used bidirectionally, an up segment can be converted into a down segment, and a down segment can be converted into an up segment depending on the direction of the end-to-end path. This means that all path segments can be used to send data traffic in both directions.<a href="#section-1.4.1-4" class="pilcrow">¶</a></p>
<p id="section-1.4.1-5">The cryptographic protection of PCBs and path segments is based on the Control Plane PKI. The signatures are structured such that the entire message sequence constituting the path segment can be authenticated by anyone with access to this PKI.<a href="#section-1.4.1-5" class="pilcrow">¶</a></p>
<p id="section-1.4.1-6">For fast validation of the path information carried in individual packets during packet forwarding, symmetric key cryptography is used and the Hop Fields contain a MAC. These MACs are structured to allow verification of the sequence of hops, but in contrast to the PCBs can only be validated by the border routers of the respective AS.<a href="#section-1.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="numbering">
<section id="section-1.5">
        <h3 id="name-addressing">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-addressing" class="section-name selfRef">Addressing</a>
        </h3>
<p id="section-1.5-1">Inter-domain SCION routing is based on an &lt;ISD, AS&gt; tuple. Although a complete SCION address is composed of the &lt;ISD, AS, endpoint address&gt; 3-tuple, the endpoint address is not used for inter-domain routing or forwarding. The endpoint address is of variable length, does not need to be globally unique, and can thus be an IPv4, IPv6, or link layer address.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2"><strong>Note:</strong> As a consequence of the fact that SCION relies on existing routing protocols (e.g. IS-IS, OSPF, SR) and communication fabric (e.g. IP, MPLS) for intra-domain forwarding, existing internal routers do not need to be changed to support SCION.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<div id="isd-numbers">
<section id="section-1.5.1">
          <h4 id="name-isd-numbers">
<a href="#section-1.5.1" class="section-number selfRef">1.5.1. </a><a href="#name-isd-numbers" class="section-name selfRef">ISD Numbers</a>
          </h4>
<p id="section-1.5.1-1">An ISD number is the 16-bit global identifier for an ISD and <span class="bcp14">MUST</span> be globally unique.<a href="#section-1.5.1-1" class="pilcrow">¶</a></p>
<p id="section-1.5.1-2">The following table gives an overview of the ISD number allocation:<a href="#section-1.5.1-2" class="pilcrow">¶</a></p>
<span id="name-isd-number-allocations"></span><div id="_table-1">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-isd-number-allocations" class="selfRef">ISD number allocations</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ISD</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">The wildcard ISD.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1 - 15</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for documentation and sample code (analogous to <span>[<a href="#RFC5398" class="cite xref">RFC5398</a>]</span>).</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">16 - 63</td>
                <td class="text-left" rowspan="1" colspan="1">Private use (analogous to <span>[<a href="#RFC6996" class="cite xref">RFC6996</a>]</span>). Can be used for testing and private deployments</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">64 - 4094</td>
                <td class="text-left" rowspan="1" colspan="1">Public ISDs. Should be allocated in ascending order, without gaps and "vanity" numbers.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4095 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for future use.</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-1.5.1-4">Currently, ISD numbers are allocated by Anapaya, a provider of SCION-based networking software and solutions (see <span>[<a href="#ISD-AS-assignments" class="cite xref">ISD-AS-assignments</a>]</span>).<a href="#section-1.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scion-as-numbers">
<section id="section-1.5.2">
          <h4 id="name-scion-as-numbers">
<a href="#section-1.5.2" class="section-number selfRef">1.5.2. </a><a href="#name-scion-as-numbers" class="section-name selfRef">SCION AS Numbers</a>
          </h4>
<p id="section-1.5.2-1">A SCION AS number is the 48-bit identifier for an AS. Although they play a similar role, there is no relationship between SCION AS numbers and BGP ASNs as defined by <span>[<a href="#RFC4893" class="cite xref">RFC4893</a>]</span>. For historical reasons some SCION Autonomous Systems use a SCION AS number where the first 16 bits are 0 and the remaining 32 bits are identical to their BGP ASN, but there is no technical requirement for this.<a href="#section-1.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="text-representation">
<section id="section-1.5.3">
          <h4 id="name-text-representation">
<a href="#section-1.5.3" class="section-number selfRef">1.5.3. </a><a href="#name-text-representation" class="section-name selfRef">Text Representation</a>
          </h4>
<div id="isd-numbers-1">
<section id="section-1.5.3.1">
            <h5 id="name-isd-numbers-2">
<a href="#section-1.5.3.1" class="section-number selfRef">1.5.3.1. </a><a href="#name-isd-numbers-2" class="section-name selfRef">ISD numbers</a>
            </h5>
<p id="section-1.5.3.1-1">The text representation of SCION ISD numbers <span class="bcp14">MUST</span> be its decimal ASCII representation.<a href="#section-1.5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-numbers">
<section id="section-1.5.3.2">
            <h5 id="name-as-numbers">
<a href="#section-1.5.3.2" class="section-number selfRef">1.5.3.2. </a><a href="#name-as-numbers" class="section-name selfRef">AS numbers</a>
            </h5>
<p id="section-1.5.3.2-1">The text representation of SCION AS numbers is similar to IPv6 (see <span>[<a href="#RFC5952" class="cite xref">RFC5952</a>]</span>) but not identical. It <span class="bcp14">MUST</span> be as follows:<a href="#section-1.5.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.3.2-2.1">
                <p id="section-1.5.3.2-2.1.1">It uses a 16-bit colon-separated lower-case hex encoding with leading 0s omitted: <code>0:0:0</code> to <code>ffff:ffff:ffff</code>.<a href="#section-1.5.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5.3.2-2.2">
                <p id="section-1.5.3.2-2.2.1">The <code>::</code> zero-compression feature of IPv6 <span class="bcp14">MUST NOT</span> be used. The feature has very limited use in a 48-bit address space and would only add more complexity.<a href="#section-1.5.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5.3.2-2.3">
                <p id="section-1.5.3.2-2.3.1">A range of AS numbers can be shortened with a notation similar to the one used for CIDR IP ranges (<span>[<a href="#RFC4632" class="cite xref">RFC4632</a>]</span>). For example, the range of the lowest 32-bit AS numbers (0-4294967295) can be represented as <code>0:0:0/16</code>.<a href="#section-1.5.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5.3.2-2.4">
                <p id="section-1.5.3.2-2.4.1">For historical reasons, SCION AS numbers in the lower 32-bit range <span class="bcp14">MAY</span> also be represented as decimal for human readability. For example, if a program receives the AS number <code>0:1:f</code>, it <span class="bcp14">MAY</span> display the number as "65551".<a href="#section-1.5.3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="isd-as-tuples">
<section id="section-1.5.3.3">
            <h5 id="name-isd-as-tuples">
<a href="#section-1.5.3.3" class="section-number selfRef">1.5.3.3. </a><a href="#name-isd-as-tuples" class="section-name selfRef">&lt;ISD, AS&gt; tuples</a>
            </h5>
<p id="section-1.5.3.3-1">The text representation of SCION addresses <span class="bcp14">MUST</span> be <code>&lt;ISD&gt;-&lt;AS&gt;</code>, where <code>&lt;ISD&gt;</code> is the text representation of the ISD number, <code>&lt;AS&gt;</code> is the text representation of the AS number, and <code>-</code> is the litteral ASCII character 0x2D.<a href="#section-1.5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-1.5.3.3-2">For example, the text representation of AS number 65551 (0x1000f) in ISD number 4 is <code>4-0000:1:f</code>.<a href="#section-1.5.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="serv-disc">
<section id="section-1.5.4">
          <h4 id="name-wildcard-addressing">
<a href="#section-1.5.4" class="section-number selfRef">1.5.4. </a><a href="#name-wildcard-addressing" class="section-name selfRef">Wildcard Addressing</a>
          </h4>
<p id="section-1.5.4-1">SCION endpoints use wildcard AS <code>0:0:0</code> to designate any core AS, e.g. to place requests for core segments or down segments during path lookup. These wildcard addresses are of the form I-0, to designate any AS in ISD I. For more information, see <a href="#wildcard" class="auto internal xref">Section 5.2.1</a>.<a href="#section-1.5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="special-purpose-scion-as-numbers">
<section id="section-1.5.5">
          <h4 id="name-special-purpose-scion-as-nu">
<a href="#section-1.5.5" class="section-number selfRef">1.5.5. </a><a href="#name-special-purpose-scion-as-nu" class="section-name selfRef">Special-Purpose SCION AS Numbers</a>
          </h4>
<span id="name-as-number-allocations"></span><div id="_table-2">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-as-number-allocations" class="selfRef">AS number allocations</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">AS</th>
                <th class="text-left" rowspan="1" colspan="1">Size</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>0:0:0</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">The wildcard AS</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>0:0:1-0:ffff:ffff</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">~4.3 bill.</td>
                <td class="text-left" rowspan="1" colspan="1">Public SCION AS numbers</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>1:0:0</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>2:0:0/16</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">~4.3 bill.</td>
                <td class="text-left" rowspan="1" colspan="1">Additional public SCION AS numbers</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ff00:0:0/32</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for documentation and test/sample code (analogous to <span>[<a href="#RFC5398" class="cite xref">RFC5398</a>]</span>).</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ffaa:0:0/24</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">~16.8 mill.</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for private use (analogous to <span>[<a href="#RFC6996" class="cite xref">RFC6996</a>]</span>). These numbers can be used for testing/private deployments.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ffff:ffff:ffff</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-1.5.5-2">The rest of the space is currently unallocated.<a href="#section-1.5.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bootstrapping-ability">
<section id="section-1.6">
        <h3 id="name-bootstrapping-ability">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-bootstrapping-ability" class="section-name selfRef">Bootstrapping ability</a>
        </h3>
<p id="section-1.6-1">A secure and reliable routing architecture has to be designed specifically to avoid circular dependencies during network bootstrapping. One goal is that the SCION network can start up even after large outages or attacks, in addition to avoiding cascades of outages caused by fragile interdependencies. This section lists the concepts SCION uses to prevent circular dependencies:<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-2.1">
            <p id="section-1.6-2.1.1">Neighbor-based path discovery: Path discovery in SCION is performed by the beaconing mechanism. In order to participate in this process, an AS only needs to be aware of its direct neighbors. As long as no path segments are available, communicating with the neighboring ASes is possible with the one-hop path type which does not rely on any path information. SCION uses these <em>one-hop paths</em> to propagate PCBs to neighboring ASes to which no forwarding path is available yet. The One-Hop Path Type is described in more detail in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-1.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.2">
            <p id="section-1.6-2.2.1">Path reversal: In SCION, every path is reversible. That is, the receiver of a packet can reverse the path in the packet header in order to produce a reply packet without having to perform a path lookup. Such a packet follows the original packet's path backwards.<a href="#section-1.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.3">
            <p id="section-1.6-2.3.1">Availability of certificates: In SCION, every entity is required to be in possession of all cryptographic material (including the ISD's TRC and certificates) that is needed to verify any message it sends. This (together with the path reversal) means that the receiver of a message can always obtain all this material by contacting the sender. This avoids circular dependencies between the PKI and connectivity.<br><a href="#section-1.6-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.6-3"><strong>Note:</strong> For a detailed description of a TRC and more information on the availability of certificates and TRCs, see the SCION Control-Plane PKI <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>.<a href="#section-1.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resistance-to-partitioning">
<section id="section-1.7">
        <h3 id="name-resistance-to-partitioning">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-resistance-to-partitioning" class="section-name selfRef">Resistance to partitioning</a>
        </h3>
<p id="section-1.7-1">Partitioning occurs when a network splits into two because of link failures. Partitioning of the global SCION inter-domain network is much less likely to happen, thanks to its path awareness that exposes multiple paths between SCION ASes. Even during failures there is no special failure mode required as SCION-enabled ASes can always switch to already known paths that use other links.<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<p id="section-1.7-2">Recovering from a partitioned network is also seamless as only coarse time synchronization between the partitions is required to resume normal operation and move forward with updates of the cryptographic material. <a href="#clock-inaccuracy" class="auto internal xref">Section 3.2</a> further describes the impact of time synchronization and path discovery time.<a href="#section-1.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="communication-protocol">
<section id="section-1.8">
        <h3 id="name-communication-protocol">
<a href="#section-1.8" class="section-number selfRef">1.8. </a><a href="#name-communication-protocol" class="section-name selfRef">Communication Protocol</a>
        </h3>
<p id="section-1.8-1">All communication between the Control Services in different ASes is expressed in terms of gRPC remote procedure calls (for details, see <span>[<a href="#gRPC" class="cite xref">gRPC</a>]</span>). Service interfaces and messages are defined in the Protocol Buffer "proto3" interface definition language (for details, see <span>[<a href="#proto3" class="cite xref">proto3</a>]</span>).<a href="#section-1.8-1" class="pilcrow">¶</a></p>
<p id="section-1.8-2">The RPC messages are transported via the <span>[<a href="#Connect" class="cite xref">Connect</a>]</span>'s rpc protocol; a gRPC-like protocol that carries messages over HTTP/3 (see <span>[<a href="#RFC9114" class="cite xref">RFC9114</a>]</span>)). HTTP3 traffic uses QUIC/UDP (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>) as a transport layer. In the case of SCION, UDP relies on the data plane.<a href="#section-1.8-2" class="pilcrow">¶</a></p>
<p id="section-1.8-3"><a href="#app-a" class="auto internal xref">Appendix "Full Control Service gRPC API"</a> provides the entire Control Service API definition in protobuf format.<a href="#section-1.8-3" class="pilcrow">¶</a></p>
<p id="section-1.8-4"><a href="#app-b" class="auto internal xref">Appendix "SCION Data Plane use by the SCION Control Plane"</a> provides details about the establishment of the underlying QUIC connections through the data plane.<a href="#section-1.8-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="beaconing">
<section id="section-2">
      <h2 id="name-path-exploration-or-beaconi">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-path-exploration-or-beaconi" class="section-name selfRef">Path Exploration or Beaconing</a>
      </h2>
<div id="introduction-and-overview">
<section id="section-2.1">
        <h3 id="name-introduction-and-overview">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-introduction-and-overview" class="section-name selfRef">Introduction and Overview</a>
        </h3>
<p id="section-2.1-1"><strong>Path Exploration</strong> is the process where an AS discovers paths to other ASes. In SCION, this process is referred to as <em>beaconing</em> and this section provides a detailed explanation of this.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">In SCION, the <em>Control Service</em> of each AS is responsible for the beaconing process. The Control Service generates, receives, and propagates the <em>Path Segment Construction Beacons (PCBs)</em> on a regular basis, to iteratively construct path segments.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">PCBs contain inter-domain topology and authentication information, and can also include additional metadata that helps with path management and selection. The beaconing process itself is divided into routing processes on two levels, where <em>inter-ISD</em> or core beaconing is based on the (selective) sending of PCBs without a defined direction, and <em>intra-ISD</em> beaconing on top-to-bottom propagation. Beaconing is initiated by core ASes, therefore each ISD <span class="bcp14">MUST</span> have at least one core AS.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">
            <p id="section-2.1-4.1.1"><em>Inter-ISD or core beaconing</em> is the process of constructing path segments between core ASes in the same or in different ISDs. During core beaconing, the Control Service of a core AS either initiates PCBs or propagates PCBs received from neighboring core ASes to other neighboring core ASes. PCBs are periodically sent over policy compliant paths to discover multiple paths between any pair of core ASes.<a href="#section-2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1"><em>Intra-ISD beaconing</em> creates path segments from core ASes to non-core ASes. For this, the Control Services of core ASes create PCBs and sends them to the non-core child ASes (typically customer ASes) at regular intervals. The Control Service of a non-core child AS receives these PCBs and forwards them to its child ASes, and so on until the PCB reaches an AS without any children (leaf AS). As a result, all ASes within an ISD receive path segments to reach the core ASes of their ISD and register reciprocal segments with the Control Service of the associated core ASes.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-5">On its way, a PCB accumulates cryptographically protected path and forwarding information per traversed AS. At every AS, metadata as well as information about the AS's ingress and egress interfaces is added to the PCB. The full PCB message format is described in <a href="#pcbs" class="auto internal xref">Section 2.2</a>. PCBs are used to construct path segments. ASes register them to make them available to other ASes, as described in <a href="#path-segment-reg" class="auto internal xref">Section 4</a>.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<div id="peering-links">
<section id="section-2.1.1">
          <h4 id="name-peering-links">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-peering-links" class="section-name selfRef">Peering Links</a>
          </h4>
<p id="section-2.1.1-1">PCBs do not traverse peering links. Instead, peering links are announced along with a regular path in a PCB. If both ASes at either end of a peering link have registered path segments that include this specific peering link, then it is possible to use this peering link during segment combination to create the end-to-end path.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appending-entries-to-a-pcb">
<section id="section-2.1.2">
          <h4 id="name-appending-entries-to-a-pcb">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-appending-entries-to-a-pcb" class="section-name selfRef">Appending Entries to a PCB</a>
          </h4>
<p id="section-2.1.2-1">Every propagation interval (as configured by the AS), the Control Service:<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.2-2.1">
              <p id="section-2.1.2-2.1.1">selects the best combinations of PCBs and interfaces connecting to a neighboring AS (i.e. a child AS or a core AS). This is described in <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-2.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.2-2.2">
              <p id="section-2.1.2-2.2.1">propagates each selected PCB to the selected egress interface(s) associated with it. This is described in <a href="#path-segment-prop" class="auto internal xref">Section 2.3.5</a>.<a href="#section-2.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.1.2-3">For every selected PCB and egress interface combination, the AS appends an <em>AS entry</em> to the selected PCB. This includes a Hop Field that specifies the ingress and egress interface for the packet forwarding through this AS, in the beaconing direction. The AS entry can also contain peer entries.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pcb-propagation-illustrated-examples">
<section id="section-2.1.3">
          <h4 id="name-pcb-propagation-illustrated">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-pcb-propagation-illustrated" class="section-name selfRef">PCB Propagation - Illustrated Examples</a>
          </h4>
<p id="section-2.1.3-1">The following three figures show how intra-ISD PCB propagation works, from the ISD's core AS down to child ASes. Interface identifiers of each AS are numbered with integer values while ASes are described with an upper case letter for the sake of illustration.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.3-2">In <a href="#_figure-3a" class="auto internal xref">Figure 2</a> below, core AS X sends the two different PCBs "a" and "b" via two different links to child AS Y: PCB "a" leaves core AS X via egress interface "2", whereas PCB "b" is sent over egress interface "1". Core AS X adds the respective egress information to the PCBs when sending them off, as can be seen in the figure (the entries "<em>Core - Out:2</em>" and "<em>Core - Out:1</em>", respectively).<a href="#section-2.1.3-2" class="pilcrow">¶</a></p>
<span id="name-intra-isd-pcb-propagation-f"></span><div id="_figure-3a">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-2.1.3-3.1">
<pre>
                           ┌─────────────┐
                           │  Core AS X  │
                           │             │
                           │    2   1    │
                           └────#───#────┘
           ┌────────┐┐          │   │          ┌┌────────┐
           │ PCB a  ││  ┌─────┐ │   │ ┌─────┐  ││ PCB b  │
           ┝━━━━━━━━┥│◀─┤PCB a│ │   │ │PCB b├─▶│┝━━━━━━━━┥
           │ Core   ││  └──┬──┘ │   │ └──┬──┘  ││Core    │
           │- Out:2 ││     │    │   │    │     ││- Out:1 │
           └────────┘┘     ▼    │   │    ▼     └└────────┘
                                ▼   ▼
                           ┌────#───#────┐
                           │    AS Y     │
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-intra-isd-pcb-propagation-f" class="selfRef">Intra-ISD PCB propagation from the ISD core to child ASes - Part 1</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-4">AS Y receives the two PCBs "a" and "b" through two different (ingress) interfaces, namely "2" and "3", respectively (see <a href="#_figure-3b" class="auto internal xref">Figure 3</a> below). Additionally, AS Y forwards to AS Z four PCBs that were previously sent by core AS X. For this, AS Y uses the two different (egress) links "5" and "6". AS Y appends the corresponding ingress and egress interface information to the four PCBs. As can be seen in the figure, AS Y also has two peering links to its neighboring peers V and W, through the interfaces "1" and "4", respectively - AS Y includes this information in the PCBs, as well. Thus, each forwarded PCB cumulates path information on its way "down" from core AS X.<a href="#section-2.1.3-4" class="pilcrow">¶</a></p>
<span id="name-intra-isd-pcb-propagation-fr"></span><div id="_figure-3b">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-2.1.3-5.1">
<pre>
                        ┌─────┐ │   │ ┌─────┐
                        │PCB a│ │   │ │PCB b│
                        └──┬──┘ │   │ └──┬──┘
                           │    │   │    │
                           ▼    │   │    ▼
                                ▼   ▼
       ┌─────────────┐     ┌────#───#────┐     ┌─────────────┐
       │             │     │    2   3    │     │             │
       │             #- - -# 1           │     │             │
       │    AS V     │     │    AS Y     │     │    AS W     │
       │             │     │           4 #- - -#             │
       │             │     │    6   5    │     │             │
       └─────────────┘     └────#───#────┘     └─────────────┘
            ┌────────┐┐         │   │         ┌┌────────┐
            │ PCB c  ││         │   │         ││ PCB d  │
            ┝━━━━━━━━┥│         │   │         │┝━━━━━━━━┥
            │Core X  ││         │   │         ││Core X  │
            │- Out:2 ││         │   │         ││- Out:2 │
┌────────┐┐ ├────────┤│  ┌─────┐│   │┌─────┐  │├────────┤ ┌┌────────┐
│ PCB e  ││ │AS Y    ││◀─┤PCB c││   ││PCB d├─▶││AS Y    │ ││ PCB f  │
┝━━━━━━━━┥│ │-In:2   ││  └──┬──┘│   │└──┬──┘  ││-In:2   │ │┝━━━━━━━━┥
│Core X  ││ │-Out:6  ││     │   │   │   │     ││-Out:5  │ ││Core X  │
│- Out:1 ││ │-PeerV:1││     ▼   │   │   ▼     ││-PeerV:1│ ││- Out:1 │
├────────┤│ │-PeerW:4││         │   │         ││-PeerW:4│ │├────────┤
│AS Y    ││ └────────┘┘         │   │         └└────────┘ ││AS Y    │
│-In:3   ││             ┌─────┐ │   │ ┌─────┐             ││-In:3   │
│-Out:6  ││◀────────────┤PCB e│ │   │ │PCB f├────────────▶││-Out:5  │
│-PeerV:1││             └──┬──┘ │   │ └──┬──┘             ││-PeerV:1│
│-PeerW:4││                │    │   │    │                ││-PeerW:4│
└────────┘┘                ▼    │   │    ▼                └└────────┘
                                ▼   ▼
                           ┌────#───#────┐
                           │    AS Z     │
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-intra-isd-pcb-propagation-fr" class="selfRef">Intra-ISD PCB propagation from the ISD core to child ASes - Part 2</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-6">The following figure shows how the four PCBs "c", "d", "e", and "f", coming from AS Y, are received by AS Z over two different links: PCBs "c" and "e" reach AS Z over ingress interface "5", whereas PCBs "d" and "f" enter AS Z via ingress interface "1". Additionally, AS Z propagates PCBs "g", "h", "i", and "j" further down, all over the same link (egress interface "3"). AS Z extends the PCBs with the relevant information, so that each of these PCBs now includes AS hop entries from core AS X, AS Y, and AS Z.<a href="#section-2.1.3-6" class="pilcrow">¶</a></p>
<span id="name-intra-isd-pcb-propagation-fro"></span><div id="_figure-3c">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-2.1.3-7.1">
<pre>
                   ┌─────┐      │   │      ┌─────┐
                   │PCB c│      │   │      │PCB d│
                   └─┬───┘      │   │      └───┬─┘
                     │  ┌─────┐ │   │ ┌─────┐  │
                     ▼  │PCB e│ │   │ │PCB f│  ▼
                        └──┬──┘ │   │ └──┬──┘
                           │    │   │    │
                           ▼    │   │    ▼
                                ▼   ▼
                           ┌────#───#────┐
                           │    5   1    │
                           │             │
                           │    AS Z     │
            ┌────────┐┐    │             │    ┌┌────────┐
            │ PCB g  ││    │      3      │    ││ PCB h  │
            ┝━━━━━━━━┥│    └──────#──────┘    │┝━━━━━━━━┥
            │Core X  ││           │           ││Core X  │
┌────────┐┐ │- Out:2 ││           │           ││- Out:2 │ ┌┌────────┐
│ PCB i  ││ ├────────┤│           │           │├────────┤ ││ PCB j  │
┝━━━━━━━━┥│ │AS Y    ││           │           ││AS Y    │ │┝━━━━━━━━┥
│Core X  ││ │-In:2   ││           │           ││-In:2   │ ││Core X  │
│- Out:1 ││ │-Out:6  ││  ┌─────┐  │  ┌─────┐  ││-Out:5  │ ││- Out:1 │
├────────┤│ │-PeerV:1││◀─┤PCB g│  │  │PCB h├─▶││-PeerV:1│ │├────────┤
│AS Y    ││ │-PeerW:4││  └──┬──┘  │  └──┬──┘  ││-PeerW:4│ ││AS Y    │
│-In:3   ││ ├────────┤│     │     │     │     │├────────┤ ││-In:3   │
│-Out:6  ││ │AS Z    ││     ▼     │     ▼     ││AS Z    │ ││-Out:5  │
│-PeerV:1││ │-In:5   ││           │           ││-In:1   │ ││-PeerV:1│
│-PeerW:4││ │-Out:3  ││           │           ││-Out:3  │ ││-PeerW:4│
├────────┤│ └────────┘┘           │           └└────────┘ │├────────┤
│AS Z    ││              ┌─────┐  │  ┌─────┐              ││AS Z    │
│-In:5   ││◀─────────────┤PCB i│  │  │PCB j├─────────────▶││-In:1   │
│-Out:3  ││              └──┬──┘  │  └──┬──┘              ││-Out:3  │
└────────┘┘                 │     │     │                 └└────────┘
                            ▼     │     ▼
                                  ▼

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-intra-isd-pcb-propagation-fro" class="selfRef">Intra-ISD PCB propagation from the ISD core to child ASes - Part 3</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-8">Based on the figures above, one could say that a PCB represents a single path segment. However, there is a difference between a PCB and a registered path segment as a PCB is a so-called "travelling path segment" that accumulates AS entries when traversing the Internet. A registered path segment is instead a "snapshot" of a travelling PCB at a given time T and from the vantage point of a particular AS A. This is illustrated by <a href="#_figure-4" class="auto internal xref">Figure 5</a>. This figure shows several possible path segments to reach AS Z, based on the PCBs "g", "h", "i", and "j" from <a href="#_figure-3c" class="auto internal xref">Figure 4</a> above. It is up to AS Z to use all of these path segments or just a selection of them.<a href="#section-2.1.3-8" class="pilcrow">¶</a></p>
<span id="name-possible-up-or-down-segment"></span><div id="_figure-4">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-2.1.3-9.1">
<pre>
                AS Entry Core        AS Entry Y          AS Entry Z

               ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
               │  Core AS X  │     │    AS Y     │     │    AS Z     │
Path Segment 1 │            1#     #3           5#     #1            │
               │             │     │             │     │             │
               │            2#─────#2───────────6#─────#5            │
               │             │     │             │     │             │
               └─────────────┘     └─────────────┘     └─────────────┘
                  Egress 2       Ingress 2 - Egress 6     Ingress 5

----------------------------------------------------------------------

               ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
               │  Core AS X  │     │    AS Y     │     │    AS Z     │
               │            1#     #3     ┌─────5#─────#1            │
Path Segment 2 │             │     │      │      │     │             │
               │            2#─────#2─────┘     6#     #5            │
               │             │     │             │     │             │
               └─────────────┘     └─────────────┘     └─────────────┘
                  Egress 2       Ingress 2 - Egress 5     Ungress 1

------------------------------------------------------------------------

               ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
               │  Core AS X  │     │    AS Y     │     │    AS Z     │
               │            1#─────#3─────┐     5#     #1            │
Path Segment 3 │             │     │      │      │     │             │
               │            2#     #2     └─────6#─────#5            │
               │             │     │             │     │             │
               └─────────────┘     └─────────────┘     └─────────────┘
                  Egress 1       Ingress 3 - Egress 6     Ingress 5

------------------------------------------------------------------------

               ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
               │  Core AS X  │     │    AS Y     │     │    AS Z     │
               │            1#─────#3───────────5#─────#1            │
path segment 4 │             │     │             │     │             │
               │            2#     #2           6#     #5            │
               │             │     │             │     │             │
               └─────────────┘     └─────────────┘     └─────────────┘
                  egress 1       ingress 3 - egress 5      ingress 1

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-possible-up-or-down-segment" class="selfRef">Possible up- or down segments for AS Z</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="pcbs">
<section id="section-2.2">
        <h3 id="name-path-segment-construction-b">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-path-segment-construction-b" class="section-name selfRef">Path-Segment Construction Beacons (PCBs)</a>
        </h3>
<div id="pcb-compos">
<section id="section-2.2.1">
          <h4 id="name-pcb-message-format">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-pcb-message-format" class="section-name selfRef">PCB Message Format</a>
          </h4>
<p id="section-2.2.1-1"><a href="#_figure-5" class="auto internal xref">Figure 6</a> graphically represents the PCB message format:<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<span id="name-top-down-composition-of-one"></span><div id="_figure-5">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-2.2.1-2.1">
<pre>
                           PCB/PATH SEGMENT

┌─────────────┬────────────┬────────────┬────────┬-───────────────────┐
│Segment Info │ AS Entry 0 │ AS Entry 1 │  ...   │     AS Entry N     │
└─────────────┴────────────┴────────────┴────────┴────────────────────┘
└───────┬─────┘            └──────┬─────┘
        ▼                         │
┌────────────────┐                │
┌─────────┬──────┐                │
│Timestamp│Seg ID│                │
└─────────┴──────┘                │
                                  ▼
┌──────────────────────────────────────────────────────────────────────┐
┌───────────────────────┬──────────────────────────────────────────────┐
│    Unsigned Ext.      │               Signed AS Entry                │
└───────────────────────┴──────────────────────────────────────────────┘
                        └───────────────────────┬──────────────────────┘
                                                ▼
┌──────────────────────────────────────────────────────────────────────┐
┌────────────────────┬──────────────────┬─────────-────────────────────┐
│     Signature      │      Header      │             Body             │
└────────────────────┴──────────────────┴──────────────────────────────┘
                     └────────┬─────────┴───────────────┬──────────────┘
                              ▼                         │
┌──────────────────────────────────────┐                │
┌────────────────┬─────────────────────┐                │
│ Signature Alg. │ Verification Key ID │                │
└────────────────┴─────────────────────┘                │
                 └──────────┬──────────┘                │
                            ▼                           │
┌───────────────────────────────────────────────┐       │
┌─────────┬─────────┬────────────┬──────────────┐       │
│ ISD-AS  │TRC Base │ TRC Serial │Subject Key ID│       │
└─────────┴─────────┴────────────┴──────────────┘       │
                                                        ▼
┌──────────────────────────────────────────────────────────────────────┐
┌──────┬───────────┬─────────┬────────────┬─────┬────────────┬────┬────┐
│ISD-AS│Next ISD-AS│Hop Entry│Peer Entry 0│ ... │Peer Entry N│MTU │Ext.│
└──────┴───────────┴─────────┴────────────┴─────┴────────────┴────┴────┘
                   └────┬────┴──────┬─────┘
                        ▼           ▼
┌──────────────────────────┐ ┌─────────────────────────────────────────┐
┌─────────────┬────────────┐ ┌─────────┬────────┬──────────┬───────────┐
│ Ingress MTU │ Hop Field  │ │Hop Field│PeerMTU │PeerISD-AS│PeerInterf.│
└─────────────┴────────────┘ └─────────┴────────┴──────────┴───────────┘
                       └────┬────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
┌────────────┬─────────────┬───────────────────┬───────────┐
│  Ingress   │    Egress   │  Expiration Time  │    MAC    │
└────────────┴─────────────┴───────────────────┴───────────┘
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-top-down-composition-of-one" class="selfRef">Top-down composition of one PCB</a>
            </figcaption></figure>
</div>
<p id="section-2.2.1-3">Note: For a full example of one PCB in the Protobuf message format, please see , <a href="#_figure-14" class="auto internal xref">Figure 15</a>.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<div id="segment">
<section id="section-2.2.1.1">
            <h5 id="name-pcb-top-level-message-forma">
<a href="#section-2.2.1.1" class="section-number selfRef">2.2.1.1. </a><a href="#name-pcb-top-level-message-forma" class="section-name selfRef">PCB Top-Level Message Format</a>
            </h5>
<span id="name-pcb-top-level-message-format"></span><div id="_figure-6">
<figure id="figure-7">
              <div class="alignLeft art-text artwork" id="section-2.2.1.1-1.1">
<pre>
┌─────────────┬────────────┬────────────┬─────┬────────────┐
│Segment Info │ AS Entry 0 │ AS Entry 1 │ ... │ AS Entry N │
└─────────────┴────────────┴-───────────┴─────┴-───────────┘
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-pcb-top-level-message-format" class="selfRef">PCB Top-Level Message Format</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.1-2">Each PCB <span class="bcp14">MUST</span> consists of at least:<a href="#section-2.2.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-3.1">
                <p id="section-2.2.1.1-3.1.1">An information field with an identifier and a timestamp.<a href="#section-2.2.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-3.2">
                <p id="section-2.2.1.1-3.2.1">Entries of all ASes on the path segment represented by this PCB.<a href="#section-2.2.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.1-4">The following code block defines the PCB at the top level in Protobuf message format.<a href="#section-2.2.1.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.1-5">
<pre>
   message PathSegment {
       bytes segment_info = 1;
       repeated ASEntry as_entries = 2;
   }
</pre><a href="#section-2.2.1.1-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-6.1">
                <p id="section-2.2.1.1-6.1.1"><code>segment_info</code>: This field is used as input for the PCB signature. It is the encoded version of the component <code>SegmentInformation</code>, which provides basic information about the PCB. The <code>SegmentInformation</code> component is specified in detail in <a href="#seginfo" class="auto internal xref">Section 2.2.1.2</a>.<a href="#section-2.2.1.1-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-6.2">
                <p id="section-2.2.1.1-6.2.1"><code>as_entries</code>: Contains the <code>ASEntry</code> component of all ASes on the path segment represented by this PCB.<a href="#section-2.2.1.1-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-6.2.2.1">
                    <p id="section-2.2.1.1-6.2.2.1.1"><code>ASEntry</code>: The <code>ASEntry</code> component contains the complete path information of a specific AS that is part of the path segment represented by the PCB. The <code>ASEntry</code> component is specified in detail in <a href="#ase-message" class="auto internal xref">Section 2.2.1.3</a>.<a href="#section-2.2.1.1-6.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
<div id="seginfo">
<section id="section-2.2.1.2">
            <h5 id="name-segment-information">
<a href="#section-2.2.1.2" class="section-number selfRef">2.2.1.2. </a><a href="#name-segment-information" class="section-name selfRef">Segment Information</a>
            </h5>
<span id="name-segment-information-compone"></span><div id="_figure-7">
<figure id="figure-8">
              <div class="alignLeft art-text artwork" id="section-2.2.1.2-1.1">
<pre>
┌────────────────────────────┐
│         Segment Info       │
└────────────────────────────┘
└─────────────┬──────────────┘
              ▼
┌────────────────────────────┐
┌─────────────┬──────────────┐
│  Timestamp  │    Seg ID    │
└─────────────┴──────────────┘
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-segment-information-compone" class="selfRef">Segment Information Component</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.2-2">Each PCB <span class="bcp14">MUST</span> include an information component with basic information about the PCB.<a href="#section-2.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2-3">In the Protobuf message format, the information component of a PCB is called the <code>SegmentInformation</code> message. The following code block shows the Protobuf message definition for the <code>SegmentInformation</code> message.<a href="#section-2.2.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.2-4">
<pre>
   message SegmentInformation {
       int64 timestamp = 1;
       uint32 segment_id = 2;
   }
</pre><a href="#section-2.2.1.2-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.2-5.1">
                <p id="section-2.2.1.2-5.1.1"><code>timestamp</code>: The 32-bit timestamp indicates the creation time of this PCB. It is set by the originating core AS and the expiration time of each Hop Field in the PCB is computed relative to this timestamp. The timestamp is encoded as the number of seconds elapsed since the POSIX Epoch (1970-01-01 00:00:00 UTC).<a href="#section-2.2.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.2-5.2">
                <p id="section-2.2.1.2-5.2.1"><code>segment_id</code>: The 16-bit identifier of this PCB and the corresponding path segment. The segment ID is <span class="bcp14">REQUIRED</span> for the computation of the message authentication code (MAC) of an AS's Hop Field. The MAC is used for Hop Field verification in the data plane and the originating core AS <span class="bcp14">MUST</span> fill this field with a cryptographically random number.<a href="#section-2.2.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.2-6"><strong>Note:</strong> See <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a> for more information on the Hop Field message format. <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> provides a detailed description of the computation of the MAC and the verification of the Hop Field in the data plane.<a href="#section-2.2.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ase-message">
<section id="section-2.2.1.3">
            <h5 id="name-as-entry">
<a href="#section-2.2.1.3" class="section-number selfRef">2.2.1.3. </a><a href="#name-as-entry" class="section-name selfRef">AS Entry</a>
            </h5>
<span id="name-as-entry-message"></span><div id="_figure-8">
<figure id="figure-9">
              <div class="alignLeft art-text artwork" id="section-2.2.1.3-1.1">
<pre>
                           ┌──────────────┐
                           │   AS Entry   │
                           └──────────────┘
                           └──────┬───────┘
                                  ▼
┌──────────────────────────────────────────────────────────────────┐
┌───────────────────────┬──────────────────────────────────────────┐
│  Unsigned Extension   │             Signed AS Entry              │
└───────────────────────┴-─────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-as-entry-message" class="selfRef">AS Entry Message</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.3-2">Each PCB <span class="bcp14">MUST</span> also contain the entries of all ASes included in the corresponding path segment. This means that the originating core AS <span class="bcp14">MUST</span> add its AS entry to each PCB it creates, and each traversed AS <span class="bcp14">MUST</span> attach its AS entry to the PCB.<a href="#section-2.2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.3-3">One AS entry contains the complete hop information for this specific AS in this specific path segment. It consists of a signed and an unsigned component.<a href="#section-2.2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1.3-4">The code block below defines an AS entry <code>ASEntry</code> in Protobuf message format.<a href="#section-2.2.1.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.3-5">
<pre>
   message ASEntry {
       SignedMessage signed = 1;
       PathSegmentUnsignedExtensions unsigned = 2;
   }
</pre><a href="#section-2.2.1.3-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1.3-6">It includes the following components:<a href="#section-2.2.1.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.3-7.1">
                <p id="section-2.2.1.3-7.1.1"><code>SignedMessage</code>: The signed component of an AS entry. For the specification of this part of the AS entry, see <a href="#signed-compo" class="auto internal xref">Section 2.2.1.4</a> below.<a href="#section-2.2.1.3-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.3-7.2">
                <p id="section-2.2.1.3-7.2.1"><code>PathSegmentUnsignedExtensions</code>: The unsigned and thus unprotected part of the AS entry. These are extensions with metadata that need no explicit protection.<a href="#section-2.2.1.3-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="signed-compo">
<section id="section-2.2.1.4">
            <h5 id="name-as-entry-signed-component">
<a href="#section-2.2.1.4" class="section-number selfRef">2.2.1.4. </a><a href="#name-as-entry-signed-component" class="section-name selfRef">AS Entry Signed Component</a>
            </h5>
<span id="name-as-entry-signed-component-2"></span><div id="_figure-9">
<figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-2.2.1.4-1.1">
<pre>
        ┌──────────────────────────────────────────────────────┐
        │                   Signed AS Entry                    │
        └──────────────────────────────────────────────────────┘
        └──────────────────────────┬───────────────────────────┘
                                   ▼
┌─────────────────────────────────────────────────────────────────────┐
┌────────────────────┬─────────────────┬──────────────────────────────┐
│       Header       │      Body       │          Signature           │
└────────────────────┴-────────────────┴──────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-as-entry-signed-component-2" class="selfRef">AS Entry Signed Component</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.4-2">Each AS entry of a PCB <span class="bcp14">MUST</span> include a signed component as well as a signature computed over the signed component. Each AS entry <span class="bcp14">MUST</span> be signed with the Control Plane AS Certificate (See <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>).<a href="#section-2.2.1.4-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.4-3">The signed component of an AS entry <span class="bcp14">MUST</span> include the following elements:<a href="#section-2.2.1.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.4-4.1">
                <p id="section-2.2.1.4-4.1.1">a header,<a href="#section-2.2.1.4-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.4-4.2">
                <p id="section-2.2.1.4-4.2.1">a body, and<a href="#section-2.2.1.4-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.4-4.3">
                <p id="section-2.2.1.4-4.3.1">a signature.<a href="#section-2.2.1.4-4.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.4-5">In the Protobuf message format implementation, the signed component of an AS entry is specified by the <code>SignedMessage</code>. It consists of a header-and-body part (<code>header_and_body</code>) and a raw signature (<code>signature</code>). See also the code block below.<a href="#section-2.2.1.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.4-6">
<pre>
   message SignedMessage {
       bytes header_and_body = 1;
       bytes signature = 2;
   }
</pre><a href="#section-2.2.1.4-6" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1.4-7">The following code block shows the low level representation of the <code>HeaderAndBodyInternal</code> message used for signature computation input. This message <span class="bcp14">SHOULD NOT</span> be used by external code.<a href="#section-2.2.1.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.4-8">
<pre>
   message HeaderAndBodyInternal {
       // Encoded header suitable for signature computation.
       bytes header = 1;
       // Raw payload suitable for signature computation.
       bytes body = 2;
   }
</pre><a href="#section-2.2.1.4-8" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.4-9.1">
                <p id="section-2.2.1.4-9.1.1">For the specification of the signed header, see <a href="#ase-header" class="auto internal xref">Section 2.2.1.4.1</a>.<a href="#section-2.2.1.4-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.4-9.2">
                <p id="section-2.2.1.4-9.2.1">For the specification of the signed body, see <a href="#ase-sign" class="auto internal xref">Section 2.2.1.4.2</a>.<a href="#section-2.2.1.4-9.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.4-9.3">
                <p id="section-2.2.1.4-9.3.1">For the specification of the <code>signature</code> field, see <a href="#sign" class="auto internal xref">Section 2.2.1.4.3</a>.<a href="#section-2.2.1.4-9.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<div id="ase-header">
<section id="section-2.2.1.4.1">
              <h6 id="name-as-entry-signed-header">
<a href="#section-2.2.1.4.1" class="section-number selfRef">2.2.1.4.1. </a><a href="#name-as-entry-signed-header" class="section-name selfRef">AS Entry Signed Header</a>
              </h6>
<span id="name-as-entry-signed-header-2"></span><div id="_figure-10">
<figure id="figure-11">
                <div class="alignLeft art-text artwork" id="section-2.2.1.4.1-1.1">
<pre>
           ┌─────────────────┐
           │     Header      │
           └─────────────────┘
           └────────┬────────┘
                    ▼
┌──────────────────────────────────────┐
┌────────────────┬─────────────────────┐
│ Signature Alg. │ Verification Key ID │
└────────────────┴─────────────────────┘
                 └──────────┬──────────┘
                            ▼
┌───────────────────────────────────────────────┐
┌─────────┬─────────┬────────────┬──────────────┐
│ ISD-AS  │TRC Base │ TRC Serial │Subject Key ID|
└─────────┴─────────┴────────────┴──────────────┘
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-as-entry-signed-header-2" class="selfRef">AS Entry Signed Header</a>
                </figcaption></figure>
</div>
<p id="section-2.2.1.4.1-2">The header part defines metadata that is relevant to the computation and verification of the signature. It <span class="bcp14">MUST</span> include at least the following metadata:<a href="#section-2.2.1.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.4.1-3.1">
                  <p id="section-2.2.1.4.1-3.1.1">The algorithm to compute the signature<a href="#section-2.2.1.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.1-3.2">
                  <p id="section-2.2.1.4.1-3.2.1">The subjectKeyIdentifier of the public key to be used to verify the signature (see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>)<a href="#section-2.2.1.4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.1-3.3">
                  <p id="section-2.2.1.4.1-3.3.1">The ISD-AS number of the AS<a href="#section-2.2.1.4.1-3.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-2.2.1.4.1-4">The following code block defines the signed header of an AS entry in Protobuf message format (called the <code>Header</code> message).<a href="#section-2.2.1.4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.4.1-5">
<pre>
   message Header {
       SignatureAlgorithm signature_algorithm = 1;
       bytes verification_key_id = 2;
       // Optional
       google.protobuf.Timestamp timestamp = 3;
       // Optional
       bytes metadata = 4;
       int32 associated_data_length = 5;
   }

   message VerificationKeyID {
       uint64 isd_as = 1;
       bytes subject_key_id = 2;
       uint64 trc_base = 3;
       uint64 trc_serial = 4;
   }
</pre><a href="#section-2.2.1.4.1-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.4.1-6.1">
                  <p id="section-2.2.1.4.1-6.1.1"><code>signature_algorithm</code>: Specifies the algorithm to compute the signature.<a href="#section-2.2.1.4.1-6.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.1-6.2">
                  <p id="section-2.2.1.4.1-6.2.1"><code>verification_key_id</code>: Contains information that is relevant to signing and verifying PCBs and other control-plane messages. It includes the following fields (see also the above code block):<a href="#section-2.2.1.4.1-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.4.1-6.2.2.1">
                      <p id="section-2.2.1.4.1-6.2.2.1.1"><code>isd_as</code>: The ISD-AS number of the current AS.<a href="#section-2.2.1.4.1-6.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-2.2.1.4.1-6.2.2.2">
                      <p id="section-2.2.1.4.1-6.2.2.2.1"><code>subject_key_id</code>: Refers to the certificate that contains the public key needed to verify this PCB's signature.<a href="#section-2.2.1.4.1-6.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-2.2.1.4.1-6.2.2.3">
                      <p id="section-2.2.1.4.1-6.2.2.3.1"><code>trc_base</code>: Defines the <em>base</em> number of the latest Trust Root Configuration (TRC) available to the signer at the time of the signature creation.<a href="#section-2.2.1.4.1-6.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-2.2.1.4.1-6.2.2.4">
                      <p id="section-2.2.1.4.1-6.2.2.4.1"><code>trc_serial</code>: Defines the <em>serial</em> number of the latest TRC available to the signer at the time of the signature creation.<a href="#section-2.2.1.4.1-6.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
<p id="section-2.2.1.4.1-7"><strong>Note:</strong> For more information on signing and verifying control plane messages (such as PCBs), see the chapter Signing and Verifying Control Plane Messages of the SCION Control Plane PKI Specification <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>. For more information on the TRC base and serial number, see the chapter Trust Root Configuration Specification of the SCION Control Plane PKI Specification <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>.<a href="#section-2.2.1.4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.4.1-8.1">
                  <p id="section-2.2.1.4.1-8.1.1"><code>timestamp</code>: Defines the signature creation timestamp. This field is <span class="bcp14">OPTIONAL</span>.<a href="#section-2.2.1.4.1-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.1-8.2">
                  <p id="section-2.2.1.4.1-8.2.1"><code>metadata</code>: Can be used to include arbitrary per-protocol metadata. This field is <span class="bcp14">OPTIONAL</span>.<a href="#section-2.2.1.4.1-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.1-8.3">
                  <p id="section-2.2.1.4.1-8.3.1"><code>associated_data_length</code>: Specifies the length of associated data that is covered by the signature, but is not included in the header and body. The value of this field is zero, if no associated data is covered by the signature.<a href="#section-2.2.1.4.1-8.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="ase-sign">
<section id="section-2.2.1.4.2">
              <h6 id="name-as-entry-signed-body">
<a href="#section-2.2.1.4.2" class="section-number selfRef">2.2.1.4.2. </a><a href="#name-as-entry-signed-body" class="section-name selfRef">AS Entry Signed Body</a>
              </h6>
<span id="name-as-entry-signed-body-2"></span><div id="_figure-11">
<figure id="figure-12">
                <div class="alignLeft art-text artwork" id="section-2.2.1.4.2-1.1">
<pre>
                ┌──────────────────────────────────────┐
                │                 Body                 │
                └──────────────────────────────────────┘
                └───────────────────┬──────────────────┘
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
┌──────┬───────────┬─────────┬─────────────┬───┬─────────────┬───┬────┐
│ISD-AS│Next ISD-AS│Hop Entry│Peer Entry 0 |...|Peer Entry N │MTU│Ext.│
└──────┴───────────┴─────────┴─────────────┴───┴─────────────┴───┴────┘
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-as-entry-signed-body-2" class="selfRef">AS Entry Signed Body</a>
                </figcaption></figure>
</div>
<p id="section-2.2.1.4.2-2">The body of an AS entry <span class="bcp14">MUST</span> consist of the signed component <code>ASEntrySignedBody</code> of all ASes in the path segment represented by the PCB, up until and including the current AS.<a href="#section-2.2.1.4.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.4.2-3">The following code block defines the signed body of one AS entry in Protobuf message format (called the <code>ASEntrySignedBody</code> message).<a href="#section-2.2.1.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.4.2-4">
<pre>
   message ASEntrySignedBody {
       uint64 isd_as = 1;
       uint64 next_isd_as = 2;
       HopEntry hop_entry = 3;
       repeated PeerEntry peer_entries = 4;
       uint32 mtu = 5;
       PathSegmentExtensions extensions = 6;
   }
</pre><a href="#section-2.2.1.4.2-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.4.2-5.1">
                  <p id="section-2.2.1.4.2-5.1.1"><code>isd_as</code>: The ISD-AS number of the AS that created this AS entry.<a href="#section-2.2.1.4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.2-5.2">
                  <p id="section-2.2.1.4.2-5.2.1"><code>next_isd_as</code>: The ISD-AS number of the downstream AS to which the PCB <span class="bcp14">SHOULD</span> be forwarded. The presence of this field prevents path hijacking attacks, as further discussed in <a href="#path-hijack" class="auto internal xref">Section 7.3.1</a>.<a href="#section-2.2.1.4.2-5.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.2-5.3">
                  <p id="section-2.2.1.4.2-5.3.1"><code>hop_entry</code>: The hop entry (<code>HopEntry</code>) with the information required to forward this PCB through the current AS to the next AS. This information is used in the data plane. For a specification of the hop entry, see <a href="#hopentry" class="auto internal xref">Section 2.2.1.5</a>.<a href="#section-2.2.1.4.2-5.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.2-5.4">
                  <p id="section-2.2.1.4.2-5.4.1"><code>peer_entries</code>: The list of optional peer entries (<code>PeerEntry</code>). For a specification of one peer entry, see <a href="#peerentry" class="auto internal xref">Section 2.2.1.7</a>.<a href="#section-2.2.1.4.2-5.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.2-5.5">
                  <p id="section-2.2.1.4.2-5.5.1"><code>mtu</code>: The maximum transmission unit (MTU) that is supported by all intra-domain links within the current AS. This value is set by the control service when adding the AS entry to the beacon. How the control service obtains this information is implementation dependent. Current practice is to make it a configuration item.<a href="#section-2.2.1.4.2-5.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.2-5.6">
                  <p id="section-2.2.1.4.2-5.6.1"><code>extensions</code>: List of (signed) extensions (optional). PCB extensions defined here are part of the signed AS entry. This field <span class="bcp14">SHOULD</span> therefore only contain extensions that include important metadata for which cryptographic protection is required. For more information on PCB extensions, see <a href="#pcb-ext" class="auto internal xref">Section 2.2.2</a>.<a href="#section-2.2.1.4.2-5.6.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="sign">
<section id="section-2.2.1.4.3">
              <h6 id="name-as-entry-signature">
<a href="#section-2.2.1.4.3" class="section-number selfRef">2.2.1.4.3. </a><a href="#name-as-entry-signature" class="section-name selfRef">AS Entry Signature</a>
              </h6>
<p id="section-2.2.1.4.3-1">Each AS entry <span class="bcp14">MUST</span> be signed with the AS certificate's private key K<sub>i</sub>. The certificate <span class="bcp14">MUST</span> have a validity period fully containing that of the segment being verified, regardless of current time. The signature Sig<sub>i</sub> of an AS entry ASE<sub>i</sub> is computed over the AS entry's signed component.<a href="#section-2.2.1.4.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1.4.3-2">This is the input for the computation of the signature:<a href="#section-2.2.1.4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.4.3-3.1">
                  <p id="section-2.2.1.4.3-3.1.1">The signed header and body of the current AS (<code>header_and_body</code>).<a href="#section-2.2.1.4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.3-3.2">
                  <p id="section-2.2.1.4.3-3.2.1">The <code>segment_info</code> component of the current AS. This is the encoded version of the <code>SegmentInformation</code> component containing basic information about the path segment represented by the PCB. For the specification of <code>SegmentInformation</code>, see <a href="#seginfo" class="auto internal xref">Section 2.2.1.2</a>.<a href="#section-2.2.1.4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.4.3-3.3">
                  <p id="section-2.2.1.4.3-3.3.1">The signed <code>header_and_body</code>/<code>signature</code> combination of each previous AS on this specific path segment.<a href="#section-2.2.1.4.3-3.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-2.2.1.4.3-4">The signature Sig<sub>i</sub> of an AS entry ASE<sub>i</sub> is now computed as follows:<a href="#section-2.2.1.4.3-4" class="pilcrow">¶</a></p>
<p id="section-2.2.1.4.3-5">Sig<sub>i</sub> =
K<sub>i</sub>( SegInfo || ASE<sub>0</sub><sup>(signed)</sup> || Sig<sub>0</sub> || ... || ASE<sub>i-1</sub><sup>(signed)</sup> || Sig<sub>i-1</sub> || ASE<sub>i</sub><sup>(signed)</sup> )<a href="#section-2.2.1.4.3-5" class="pilcrow">¶</a></p>
<p id="section-2.2.1.4.3-6">The signature metadata minimally contains the ISD-AS number of the signing entity and the key identifier of the public key to be used to verify the message. For more information on signing and verifying control plane messages, see the chapter "Signing and Verifying Control Plane Messages" of the SCION Control Plane PKI Specification <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>.<a href="#section-2.2.1.4.3-6" class="pilcrow">¶</a></p>
<p id="section-2.2.1.4.3-7">The following code block shows how the signature input is defined in the SCION Protobuf implementation ("ps" stands for path segment). Note that the signature has a nested structure.<a href="#section-2.2.1.4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.4.3-8">
<pre>
input(ps, i) = signed.header_and_body || associated_data(ps, i)

associated_data(ps, i) = ps.segment_info ||
                         ps.as_entries[1].signed.header_and_body ||
                         ps.as_entries[1].signed.signature ||
                         ...
                         ps.as_entries[i-1].signed.header_and_body ||
                         ps.as_entries[i-1].signed.signature
</pre><a href="#section-2.2.1.4.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="hopentry">
<section id="section-2.2.1.5">
            <h5 id="name-hop-entry">
<a href="#section-2.2.1.5" class="section-number selfRef">2.2.1.5. </a><a href="#name-hop-entry" class="section-name selfRef">Hop Entry</a>
            </h5>
<span id="name-hop-entry-component"></span><div id="_figure-12">
<figure id="figure-13">
              <div class="alignLeft art-text artwork" id="section-2.2.1.5-1.1">
<pre>
        ┌───────────┐
        │ Hop Entry │
        └───────────┘
        └─────┬─────┘
              ▼
┌───────────────────────────┐
┌─────────────┬─────────────┐
│ Ingress MTU │  Hop Field  │
└─────────────┴─────────────┘
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-hop-entry-component" class="selfRef">Hop Entry Component</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.5-2">Each body of an AS entry <span class="bcp14">MUST</span> contain exactly one hop entry component. The hop entry component specifies forwarding information which the data plane requires to create the hop through the current AS (in the direction of the beaconing).<a href="#section-2.2.1.5-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.5-3">The following code block defines the hop entry component <code>HopEntry</code> in Protobuf message format:<a href="#section-2.2.1.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.5-4">
<pre>
   message HopEntry {
       HopField hop_field = 1;
       uint32 ingress_mtu = 2;
   }
</pre><a href="#section-2.2.1.5-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.5-5.1">
                <p id="section-2.2.1.5-5.1.1"><code>hop_field</code>: Contains the authenticated information about the ingress and egress interfaces in the direction of beaconing. Routers need this information to forward packets through the current AS. For further specifications, see <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>.<a href="#section-2.2.1.5-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.5-5.2">
                <p id="section-2.2.1.5-5.2.1"><code>ingress_mtu</code>: Specifies the maximum transmission unit (MTU) of the ingress interface (in beaconing direction) of the hop being described. The MTU of paths constructed from the containing beacon is necessarily less than or equal to this value. How the control service obtains the MTU of an inter-AS link is implementation dependent. It may be discovered or configured. Current practice to make it a configuration item.<a href="#section-2.2.1.5-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.5-6">In this description, MTU and packet size are to be understood in the same sense as in <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>. That is, exclusive of any layer 2 framing or packet encapsulation (for links using an underlay network).<a href="#section-2.2.1.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hopfield">
<section id="section-2.2.1.6">
            <h5 id="name-hop-field">
<a href="#section-2.2.1.6" class="section-number selfRef">2.2.1.6. </a><a href="#name-hop-field" class="section-name selfRef">Hop Field</a>
            </h5>
<span id="name-hop-field-2"></span><div id="_figure-13">
<figure id="figure-14">
              <div class="alignLeft art-text artwork" id="section-2.2.1.6-1.1">
<pre>
                      ┌───────────┐
                      │ Hop Entry │
                      └───────────┘
                      └─────┬─────┘
                            ▼
┌──────────────────────────────────────────────────────────┐
┌─────────────┬─────────────┬───────────────────┬──────────┐
│   Ingress   │    Egress   │  Expiration Time  │   MAC    │
└─────────────┴─────────────┴───────────────────┴──────────┘
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-hop-field-2" class="selfRef">Hop Field</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.6-2">The Hop Field, part of both hop entries and peer entries, is used directly in the data plane for packet forwarding and specifies the incoming and outgoing interfaces of the ASes on the forwarding path. To prevent forgery, this information is authenticated with a message authentication code (MAC) which will be checked by the SCION border routers during packet forwarding. The algorithm used to compute the Hop Field MAC is an AS-specific choice and the operator of an AS can freely choose a MAC algorithm without outside coordination. However, the Control Service and routers of the AS do need to agree on the algorithm used.<a href="#section-2.2.1.6-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.6-3">Control Service and router implementations <span class="bcp14">MUST</span> support the Default Hop Field MAC algorithm described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>. This document does not specify any further mechanism to coordinate this choice between Control Services and routers of one AS.<a href="#section-2.2.1.6-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1.6-4">The following code block defines the Hop Field component <code>HopField</code> in Protobuf message format:<a href="#section-2.2.1.6-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.6-5">
<pre>
   message HopField {
       uint64 ingress = 1;
       uint64 egress = 2;
       uint32 exp_time = 3;
       bytes mac = 4;
   }
</pre><a href="#section-2.2.1.6-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.6-6.1">
                <p id="section-2.2.1.6-6.1.1"><code>ingress</code>: The 16-bit ingress interface identifier (in the direction of the path construction, that is, in the direction of beaconing through the current AS).<a href="#section-2.2.1.6-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.6-7"><strong>Note:</strong> For the core AS that initiates the PCB, the ingress interface identifier <span class="bcp14">MUST NOT</span> be specified. This initiating AS is a core AS.<a href="#section-2.2.1.6-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.6-8.1">
                <p id="section-2.2.1.6-8.1.1"><code>egress</code>: The 16-bit egress interface identifier (in the direction of beaconing).<a href="#section-2.2.1.6-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.6-8.2">
                <p id="section-2.2.1.6-8.2.1"><code>exp_time</code>: The 8-bit encoded expiration time of the Hop Field, indicating its validity. This field expresses a duration in seconds according to the formula: <code>duration = (1 + exp_time) * (24*60*60/256)</code>. The minimum duration is therefore 337.5 s. This duration is relative to the PCB creation timestamp set in the PCB's segment information component (see also <a href="#seginfo" class="auto internal xref">Section 2.2.1.2</a>). Therefore, the absolute expiration time of the Hop Field is the sum of these two values.<a href="#section-2.2.1.6-8.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.6-8.3">
                <p id="section-2.2.1.6-8.3.1"><code>mac</code>: The message authentication code (MAC) used in the data plane to verify the Hop Field, as described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-2.2.1.6-8.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="peerentry">
<section id="section-2.2.1.7">
            <h5 id="name-peer-entry">
<a href="#section-2.2.1.7" class="section-number selfRef">2.2.1.7. </a><a href="#name-peer-entry" class="section-name selfRef">Peer Entry</a>
            </h5>
<span id="name-peer-entry-component"></span><div id="_figure-14">
<figure id="figure-15">
              <div class="alignLeft art-text artwork" id="section-2.2.1.7-1.1">
<pre>
                      ┌──────────────┐
                      │  Peer Entry  │
                      └──────────────┘
                      └───────┬──────┘
                              ▼
┌──────────────────────────────────────────────────────────┐
┌─────────────┬────────────┬──────────────┬────────────────┐
│  Hop Field  │  Peer MTU  │ Peer ISD-AS  │ Peer Interface │
└─────────────┴────────────┴──────────────┴────────────────┘
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-peer-entry-component" class="selfRef">Peer Entry Component</a>
              </figcaption></figure>
</div>
<p id="section-2.2.1.7-2">By means of a peer entry, an AS can announce that it has a peering link to another AS. A peer entry is an optional component of a PCB - it is only included if there is a peering link to a peer AS.<a href="#section-2.2.1.7-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.7-3">The following code block defines the peer entry component <code>PeerEntry</code> in Protobuf message format:<a href="#section-2.2.1.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1.7-4">
<pre>
   message PeerEntry {
       uint64 peer_isd_as = 1;
       uint64 peer_interface = 2;
       uint32 peer_mtu = 3;
       HopField hop_field = 4;
   }
</pre><a href="#section-2.2.1.7-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1.7-5.1">
                <p id="section-2.2.1.7-5.1.1"><code>peer_isd_as</code>: The ISD-AS number of the peer AS. This number is used to match peering segments during path construction.<a href="#section-2.2.1.7-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.7-5.2">
                <p id="section-2.2.1.7-5.2.1"><code>peer_interface</code>: The 16-bit interface identifier of the peering link on the peer AS side. This identifier is used to match peering segments during path construction.<a href="#section-2.2.1.7-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.7-5.3">
                <p id="section-2.2.1.7-5.3.1"><code>peer_mtu</code>: Specifies the maximum transmission unit (MTU) of the peering link being described. The MTU of paths via such link is necessarily less than or equal to this value. How the control service obtains the MTU of an inter-AS link is implementation dependent. It may be discovered or configured, but current practice is to make it a configuration item.<a href="#section-2.2.1.7-5.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.7-5.4">
                <p id="section-2.2.1.7-5.4.1"><code>hop_field</code>: Contains the authenticated information about the ingress and egress interfaces in the current AS (coming from the peering link, in the direction of beaconing - see also <a href="#_figure-6" class="auto internal xref">Figure 7</a>). The data plane needs this information to forward packets through the current AS. For further specifications, see <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>.<a href="#section-2.2.1.7-5.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.7-6">In this description, MTU and packet size are to be understood in the same sense as in <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>. That is, exclusive of any layer 2 framing or packet encapsulation (for links using an underlay network).<a href="#section-2.2.1.7-6" class="pilcrow">¶</a></p>
<span id="name-peer-entry-information-in-t"></span><div id="_figure-15">
<figure id="figure-16">
              <div class="alignLeft art-text artwork" id="section-2.2.1.7-7.1">
<pre>
   ┌───────────┐
   │           │
   │ Parent AS │
   │           │
   └─────┬─────┘
         │
         │ ASE.HF.ingress_interface
┌────────#───────────┐
│        ┆           │        PE.peer_  ┌───────────┐
│        ┆           │        interface │           │
│        ┆ ┌┄┄┄┄┄┄┄┄┄#──────────────────#  Peer AS  │
│        ┆ ┆         │ PE.HF.ingress_   │           │
│        ┆ ┆         │ interface        └───────────┘
│        ┆ ┆         │
│        ▼ ▼         │
└─────────#──────────┘
          │ PE.HF.egress_interface
          │ ASE.HF.egress_interface
          │
    ┌─────┴─────┐
    │           │
    │ Child AS  │
    │           │
    └───────────┘
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-peer-entry-information-in-t" class="selfRef">Peer entry information, in the direction of beaconing</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="pcb-ext">
<section id="section-2.2.2">
          <h4 id="name-pcb-extensions">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-pcb-extensions" class="section-name selfRef">PCB Extensions</a>
          </h4>
<p id="section-2.2.2-1">In addition to basic routing information such a hop entries and peer entries, PCBs can be used to communicate additional metadata in extensions. Extensions can be signed and unsigned: signed extensions are protected by the AS signature, whereas unsigned extensions are not.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">In Protobuf, extensions are specified as follows:<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-3.1">
              <p id="section-2.2.2-3.1.1">Unsigned extensions <code>PathSegmentUnsignedExtensions</code> are part of the AS entry component (the <code>ASEntry</code> message, see also <a href="#ase-message" class="auto internal xref">Section 2.2.1.3</a>).<a href="#section-2.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.2">
              <p id="section-2.2.2-3.2.1">Signed extensions <code>PathSegmentExtensions</code> are part of the signed body component of an AS entry (the <code>ASEntrySignedBody</code> message, see also <a href="#ase-sign" class="auto internal xref">Section 2.2.1.4.2</a>).<a href="#section-2.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.2-4"><strong>Note:</strong> SCION also supports so-called "detachable extensions". The detachable extension is part of a PCB's unsigned extensions, but a cryptographic hash of the detachable extension data is added to the signed extensions. Thus, a PCB with a detachable extension can be signed and verified without actually including the detachable extension in the signature. This prevents a possible processing overhead caused by large cryptographically-protected extensions.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pcb-validity">
<section id="section-2.2.3">
          <h4 id="name-pcb-validity">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-pcb-validity" class="section-name selfRef">PCB Validity</a>
          </h4>
<p id="section-2.2.3-1">To be valid (that is, usable to construct a valid path), a PCB <span class="bcp14">MUST</span>:<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3-2.1">
              <p id="section-2.2.3-2.1.1">Contain valid AS Entry signatures (<a href="#sign" class="auto internal xref">Section 2.2.1.4.3</a>).<a href="#section-2.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-2.2">
              <p id="section-2.2.3-2.2.1">Have a timestamp (<a href="#seginfo" class="auto internal xref">Section 2.2.1.2</a>) that is not in the future.<a href="#section-2.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-2.3">
              <p id="section-2.2.3-2.3.1">Contain only unexpired hops (<a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>).<a href="#section-2.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.3-3">For the purpose of validation, a timestamp is considered "future" if it is later than the current time at the point of validation plus an allowance for differences between the validator's and originator's clock. As an allowance, it is recommended to use the granularity of the hopfield expiration time (that is 337.5 seconds, see <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>).<a href="#section-2.2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.2.3-4">For the purpose of validation, a hop is considered expired if its absolute expiration time, calculated as defined in <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>, is later than the current time at the point of validation.<a href="#section-2.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuration">
<section id="section-2.2.4">
          <h4 id="name-configuration">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
          </h4>
<p id="section-2.2.4-1">For the purpose of constructing and propagating path segments, an AS Control Service <span class="bcp14">MUST</span> be configured with links to neighboring ASes. Such information may be conveyed to the Control Service in an out-of-band fashion (e.g in a configuration file). For each link, these values <span class="bcp14">MUST</span> be configured:<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.4-2.1">
              <p id="section-2.2.4-2.1.1">Local interface ID. This <span class="bcp14">MUST</span> be unique within each AS.<a href="#section-2.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.4-2.2">
              <p id="section-2.2.4-2.2.1">Neighbor type (core, parent, child, peer), depending on link type (see <a href="#paths-links" class="auto internal xref">Section 1.3</a>). Link type depends on mutual agreements between the organizations operating the ASes at each end of each link.<a href="#section-2.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.4-2.3">
              <p id="section-2.2.4-2.3.1">Neighbor ISD-AS number<a href="#section-2.2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.4-2.4">
              <p id="section-2.2.4-2.4.1">Neighbor interface underlay address<a href="#section-2.2.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.4-3">In addition, the maximum MTU supported by all intra-AS links <span class="bcp14">MAY</span> be configured.
Last, the AS <span class="bcp14">SHOULD</span> adopt a PCB selection policy that it does not accidentally isolate the AS from the network, i.e., such that it does not block connectivity to parent providers and that ensures downstream connectivity for children. For more details, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="path-prop">
<section id="section-2.3">
        <h3 id="name-propagation-of-pcbs">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-propagation-of-pcbs" class="section-name selfRef">Propagation of PCBs</a>
        </h3>
<p id="section-2.3-1">This section describes how PCBs are received, selected and further propagated in the path exploration process.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="reception-of-pcbs">
<section id="section-2.3.1">
          <h4 id="name-reception-of-pcbs">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-reception-of-pcbs" class="section-name selfRef">Reception of PCBs</a>
          </h4>
<p id="section-2.3.1-1">Upon receiving a PCB, the Control Service of an AS performs the following checks:<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.1-2">
<li id="section-2.3.1-2.1">
              <p id="section-2.3.1-2.1.1">PCB validity: It verifies the validity of the PCB (see <a href="#pcb-validity" class="auto internal xref">Section 2.2.3</a>) and invalid PCBs <span class="bcp14">MUST</span> be discarded. The PCB contains the version numbers of the TRC(s) and certificate(s) that <span class="bcp14">MUST</span> be used to verify its signatures which enables the Control Service to check whether it has the relevant TRC(s) and certificate(s). If not, they can be requested from the Control Service of the sending AS through the API described in <a href="#_figure-36" class="auto internal xref">Figure 30</a>.<a href="#section-2.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-2.2">
              <p id="section-2.3.1-2.2.1">Loop avoidance: If it is a core AS, the Control Service <span class="bcp14">MUST</span> check whether the PCB includes duplicate hop entries created by the core AS itself or by other ASes. If so, the PCB <span class="bcp14">MUST</span> be discarded in order to avoid loops. This step is necessary because core beaconing is based on propagating PCBs to all AS neighbors. Additionally, core ASes <span class="bcp14">SHOULD</span> discard PCBs that were propagated at any point by a non-core AS. Ultimately, core ASes <span class="bcp14">MAY</span> make a policy decision not to propagate beacons containing path segments that traverse the same ISD more than once as this can be legitimate, e.g. if the ISD spans a large geographical area, a path transiting another ISD may constitute a shortcut.<a href="#section-2.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-2.3">
              <p id="section-2.3.1-2.3.1">Incoming Interface: the last ISD-AS entry in a received PCB (in its AS Entry Signed Body) <span class="bcp14">MUST</span> coincide with the ISD-AS neighbor of the interface where the PCB was received. If not, the PCB <span class="bcp14">MUST</span> be discarded.<a href="#section-2.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-2.4">
              <p id="section-2.3.1-2.4.1">Continuity: when a PCB contains two or more AS entries, the receiver Control Service must check every AS entry except the last and discard beacons where the ISD-AS of an entry does not equal the ISD-AS of the next entry.<a href="#section-2.3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.3.1-3">If the PCB verification is successful, the Control Service decides whether to store the PCB as a candidate for propagation based on selection criteria and polices specific for each AS.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="storing-candidate-pcbs">
<section id="section-2.3.2">
          <h4 id="name-storing-candidate-pcbs">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-storing-candidate-pcbs" class="section-name selfRef">Storing Candidate PCBs</a>
          </h4>
<p id="section-2.3.2-1">An AS stores candidate PCBs in a temporary storage called the <em>Beacon Store</em>. The management of this storage is implementation defined.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">Current practice is to retain all PCBs until expired or replaced by one describing the same path with a later origination time.<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selection">
<section id="section-2.3.3">
          <h4 id="name-pcb-selection-policies">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-pcb-selection-policies" class="section-name selfRef">PCB Selection Policies</a>
          </h4>
<p id="section-2.3.3-1">An AS <span class="bcp14">MUST</span> select which PCBs to propagate further. The selection process can inspect and compare the properties of the candidate PCBs (e.g. length, disjointness across different paths, age, expiration time) and/or take into account which PCBs have been propagated in the past. The PCBs to select or eliminate is determined by the policy of the AS.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-2">Only a relatively small subset of the viable PCBs <span class="bcp14">SHOULD</span> be propagated to avoid excessive overhead of the path discovery system in bigger networks. The goal of the AS <span class="bcp14">SHOULD</span> be to propagate those candidate PCBs with the highest probability of collectively meeting the needs of the endpoints that will perform path construction.<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3.3-3">As SCION does not provide any in-band signal about the intentions of endpoints nor about the policies of downstream ASes, the policy will typically select a somewhat diverse set optimized for multiple, generic parameters. Selection may be based on criteria such as:<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.3-4.1">
              <p id="section-2.3.3-4.1.1">AS path length: from the originator core AS to the child (non-core) AS.<a href="#section-2.3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.2">
              <p id="section-2.3.3-4.2.1">Expiration time: the maximum value for the expiration time when extending the segment.<a href="#section-2.3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.3">
              <p id="section-2.3.3-4.3.1">ISD or AS blacklists: certain ASes or ISD that may not appear in a segment.<a href="#section-2.3.3-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.4">
              <p id="section-2.3.3-4.4.1">ISD loops: if permitted, they allow core AS to reach other core ASes in the same ISD via a third party ISDs.<a href="#section-2.3.3-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.5">
              <p id="section-2.3.3-4.5.1">Availability of peering links: that is the number of different peering ASes from all non-core ASes on the PCB or path segment. A greater number of peering ASes increases the likelihood of finding a shortcut on the path segment.<a href="#section-2.3.3-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.6">
              <p id="section-2.3.3-4.6.1">Path disjointness: Paths can be either AS disjointed or link disjointed. AS disjointed paths have no common upstream/core AS for the current AS, whereas link disjointed paths do not share any AS-to-AS link. AS disjointness allows path diversity in the event that an AS becomes unresponsive, and link disjointness provides resilience in case of link failure. Both criteria can be used depending on the objective of the AS.<a href="#section-2.3.3-4.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.3-5">The relative disjointness of two PCBs A and B may be calculated by assigning a disjointness score, calculated as the number of links in A that don't appear in B. The beacon that has the highest disjointness score and is not the shortest path <span class="bcp14">SHOULD</span> be selected. If this is not better than what has already been selected, then the beacon with the shortest path yet to be selected <span class="bcp14">SHOULD</span> be chosen instead.<a href="#section-2.3.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3.3-6">A PCB Selection Policy can be expressed as a stateful filter of segments, i.e., a function which indicates whether to accept or deny a given segment. This filter is stateful in that it can be updated each time its AS registers a new segment.
Naturally, an AS's policy selects PCBs corresponding to paths that are commercially or otherwise operationally viable.<a href="#section-2.3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="propagation-interval-size">
<section id="section-2.3.4">
          <h4 id="name-propagation-interval-and-be">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-propagation-interval-and-be" class="section-name selfRef">Propagation Interval and Best PCBs Set Size</a>
          </h4>
<p id="section-2.3.4-1">PCBs are propagated in batches to each neighboring AS at a fixed frequency known as the <em>propagation interval</em> which happens for both intra-ISD beaconing and core beaconing. At each propagation event, each AS selects a set of the best PCBs from the candidates in the Beacon Store according to the AS's selection policy. This set <span class="bcp14">SHOULD</span> have a fixed size, the <em>best PCBs set size</em>.<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4-2">The <em>best PCBs set size</em> <span class="bcp14">SHOULD</span> be:<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-3.1">
              <p id="section-2.3.4-3.1.1">For intra-AS beaconing (i.e. propagating to children ASes): at most 50.<a href="#section-2.3.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-3.2">
              <p id="section-2.3.4-3.2.1">For core beaconing (i.e. propagation between core ASes): at most 5 per immediate neighbor core AS. Current practice is that each set of 5 is chosen among the PCBs received from each neighbor.<a href="#section-2.3.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-4">Note that the PCBs set size should not be too low, in order to make sure that beaconing can discover a wide amount of paths.
Values above are <span class="bcp14">RECOMMENDED</span> maxima which represent a tradeoff between scalability and amount of paths discovered.
In current practice the intra-ISD set size is typically 20.<a href="#section-2.3.4-4" class="pilcrow">¶</a></p>
<p id="section-2.3.4-5">Depending on the selection criteria, it may be necessary to keep more candidate PCBs than the <em>best PCBs set size</em> in the Beacon Store in order to determine the best set of PCBs. If this is the case, an AS <span class="bcp14">SHOULD</span> have a suitable pre-selection of candidate PCBs in place in order to keep the Beacon Store capacity limited.<a href="#section-2.3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-6.1">
              <p id="section-2.3.4-6.1.1">The <em>propagation interval</em> <span class="bcp14">SHOULD</span> be at least "5" (seconds) for intra-ISD beaconing and at least "60" (seconds) for core beaconing.<a href="#section-2.3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-7">Note that to ensure establish quick connectivity, an AS <span class="bcp14">MAY</span> attempt to forward a PCB more frequently ("fast recovery"). Current practice is to increase the frequency of attempts if no PCB propagation is known to have succeeded within the last propagation interval:<a href="#section-2.3.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-8.1">
              <p id="section-2.3.4-8.1.1">because the corresponding RPC failed;<a href="#section-2.3.4-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-8.2">
              <p id="section-2.3.4-8.2.1">or because no beacon was available to propagate.<a href="#section-2.3.4-8.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-9">The scalability implications of such parameters are further discussed in <a href="#scalability" class="auto internal xref">Section 3.3</a>.<a href="#section-2.3.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-segment-prop">
<section id="section-2.3.5">
          <h4 id="name-propagation-of-selected-pcb">
<a href="#section-2.3.5" class="section-number selfRef">2.3.5. </a><a href="#name-propagation-of-selected-pcb" class="section-name selfRef">Propagation of Selected PCBs</a>
          </h4>
<p id="section-2.3.5-1">To bootstrap the initial communication with a neighboring beacon service, ASes use one-hop paths. This special kind of path handles beaconing between neighboring ASes for which no forwarding path may be available yet. It is the task of beaconing to discover such forwarding paths and the purpose of one-hop paths is to break this circular dependency. The One-Hop Path Type is described in more detail in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-2.3.5-1" class="pilcrow">¶</a></p>
<div id="intra-prop">
<section id="section-2.3.5.1">
            <h5 id="name-propagation-of-pcbs-in-intr">
<a href="#section-2.3.5.1" class="section-number selfRef">2.3.5.1. </a><a href="#name-propagation-of-pcbs-in-intr" class="section-name selfRef">Propagation of PCBs in Intra-ISD Beaconing</a>
            </h5>
<p id="section-2.3.5.1-1">The propagation process in intra-ISD beaconing includes the following steps:<a href="#section-2.3.5.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.5.1-2">
<li id="section-2.3.5.1-2.1">
                <p id="section-2.3.5.1-2.1.1">From the candidate PCBs stored in the Beacon Store, the Control Service of an AS selects the best PCBs to propagate to its downstream neighboring ASes, based on a selection algorithm specific for this AS.<a href="#section-2.3.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.5.1-2.2">
                <p id="section-2.3.5.1-2.2.1">The Control Service adds a new AS entry to every selected PCB which <span class="bcp14">MUST</span> at least include:<a href="#section-2.3.5.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.1-2.2.2.1">
                    <p id="section-2.3.5.1-2.2.2.1.1">The ingress interface to this AS, in the Hop Field component.<a href="#section-2.3.5.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-2.3.5.1-2.2.2.2">
                    <p id="section-2.3.5.1-2.2.2.2.1">The egress interface to the neighboring AS, also in the Hop Field component.<a href="#section-2.3.5.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-2.3.5.1-2.2.2.3">
                    <p id="section-2.3.5.1-2.2.2.3.1">The ISD_AS number of the next AS, in the signed body component of the AS entry.<a href="#section-2.3.5.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-2.3.5.1-2.2.2.4">
                    <p id="section-2.3.5.1-2.2.2.4.1">If the AS has peering links, the Control Service <span class="bcp14">MAY</span> add corresponding peer entry components to the signed body of the AS entry; one peer entry component for each peering link that the AS wants to advertise. The Hop Field component of each added peer entry <span class="bcp14">MUST</span> have a specified egress interface.<a href="#section-2.3.5.1-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-2.3.5.1-2.3">
                <p id="section-2.3.5.1-2.3.1">The Control Service <span class="bcp14">MUST</span> now sign each selected, extended PCB and append the computed signature.<a href="#section-2.3.5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.5.1-2.4">
                <p id="section-2.3.5.1-2.4.1">As a final step, the Control Service propagates each extended PCB to the correct neighboring ASes by invoking the <code>SegmentCreationService.Beacon</code> remote procedure call (RPC) in the Control Services of the neighboring ASes (see also <a href="#prop-proto" class="auto internal xref">Section 2.3.5.3</a>).<a href="#section-2.3.5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="propagation-of-pcbs-in-core-beaconing">
<section id="section-2.3.5.2">
            <h5 id="name-propagation-of-pcbs-in-core">
<a href="#section-2.3.5.2" class="section-number selfRef">2.3.5.2. </a><a href="#name-propagation-of-pcbs-in-core" class="section-name selfRef">Propagation of PCBs in Core Beaconing</a>
            </h5>
<p id="section-2.3.5.2-1">The propagation process in core beaconing includes the following steps:<a href="#section-2.3.5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.5.2-2">
<li id="section-2.3.5.2-2.1">
                <p id="section-2.3.5.2-2.1.1">The core Control Service selects the best PCBs to forward to neighboring core ASes observed so far.<a href="#section-2.3.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.5.2-2.2">
                <p id="section-2.3.5.2-2.2.1">The service adds a new AS entry to every selected PCB which <span class="bcp14">MUST</span> at least include:<a href="#section-2.3.5.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.2-2.2.2.1">
                    <p id="section-2.3.5.2-2.2.2.1.1">The egress interface to the neighboring core AS in the Hop Field component.<a href="#section-2.3.5.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-2.3.5.2-2.2.2.2">
                    <p id="section-2.3.5.2-2.2.2.2.1">The ISD_AS number of the neighboring core AS in the signed body component of the AS entry.<a href="#section-2.3.5.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-2.3.5.2-2.3">
                <p id="section-2.3.5.2-2.3.1">The core Control Service <span class="bcp14">MUST</span> sign the extended PCBs and append the computed signature.<a href="#section-2.3.5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.5.2-2.4">
                <p id="section-2.3.5.2-2.4.1">As a final step, the service propagates the extended PCBs to the neighboring core ASes by invoking the <code>SegmentCreationService.Beacon</code> remote procedure call (RPC) in the Control Services of the neighboring core ASes (see also <a href="#prop-proto" class="auto internal xref">Section 2.3.5.3</a>).<a href="#section-2.3.5.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="prop-proto">
<section id="section-2.3.5.3">
            <h5 id="name-propagation-of-pcbs-in-prot">
<a href="#section-2.3.5.3" class="section-number selfRef">2.3.5.3. </a><a href="#name-propagation-of-pcbs-in-prot" class="section-name selfRef">Propagation of PCBs in Protobuf Message Format</a>
            </h5>
<p id="section-2.3.5.3-1">The last step of the above described core and intra-ISD propagation procedures is implemented as follows in Protobuf message format:<a href="#section-2.3.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.5.3-2">
<pre>
   service SegmentCreationService {
       rpc Beacon(BeaconRequest) returns (BeaconResponse) {}
   }

   message BeaconRequest {
       PathSegment segment = 1;
   }

   message BeaconResponse {}
</pre><a href="#section-2.3.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.5.3-3">The propagation procedure includes the following elements:<a href="#section-2.3.5.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.3-4.1">
                <p id="section-2.3.5.3-4.1.1"><code>SegmentCreationService</code>: Specifies the service via which the extended PCB is propagated to the Control Service of the neighboring AS.<a href="#section-2.3.5.3-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.3-4.1.2.1">
                    <p id="section-2.3.5.3-4.1.2.1.1"><code>Beacon</code>: Specifies the method that calls the Control Service at the neighboring AS in order to propagate the extended PCB.<a href="#section-2.3.5.3-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.3.5.3-4.2">
                <p id="section-2.3.5.3-4.2.1"><code>BeaconRequest</code>: Specifies the request message sent by the <code>Beacon</code> method to the Control Service of the neighboring AS. It contains the following element:<a href="#section-2.3.5.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.3-4.2.2.1">
                    <p id="section-2.3.5.3-4.2.2.1.1"><code>PathSegment</code>: Specifies the path segment to propagate to the neighboring AS. For more information on the Protobuf message type <code>PathSegment</code>, see <a href="#segment" class="auto internal xref">Section 2.2.1.1</a>.<a href="#section-2.3.5.3-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.3.5.3-4.3">
                <p id="section-2.3.5.3-4.3.1"><code>BeaconResponse</code>: An empty message returned as an acknowledgement upon success.<a href="#section-2.3.5.3-4.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deployment-considerations">
<section id="section-3">
      <h2 id="name-deployment-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations</a>
      </h2>
<div id="monitoring-considerations">
<section id="section-3.1">
        <h3 id="name-monitoring-considerations">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-monitoring-considerations" class="section-name selfRef">Monitoring Considerations</a>
        </h3>
<p id="section-3.1-1">In order to maintain service availability, an AS <span class="bcp14">SHOULD</span> monitor the following aspects when deploying the SCION control plane:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">For routers (to enable correlation with link states): state of configured links (core, child, parent)<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">For any control service:<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.2.2.1">
                <p id="section-3.1-2.2.2.1.1">Fraction of path lookups served successfully (see <a href="#lookup" class="auto internal xref">Section 5</a>)<a href="#section-3.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.2.2.2">
                <p id="section-3.1-2.2.2.2.1">Time synchronization offset with other ASes (see <a href="#clock-inaccuracy" class="auto internal xref">Section 3.2</a>)<a href="#section-3.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.2.2.3">
                <p id="section-3.1-2.2.2.3.1">Fraction of ASes found in non-expired segments for which a non-expired certificate exists<a href="#section-3.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">For a core AS:<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.3.2.1">
                <p id="section-3.1-2.3.2.1.1">Fraction of core ASes (preferably only those to which the link is up) that can be found in non-expired core segments<a href="#section-3.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.3.2.2">
                <p id="section-3.1-2.3.2.2.1">Fraction of ASes, core or children, (preferably only those to which the link is up) whereto a beacon was initiated during the last propagation interval<a href="#section-3.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.3.2.3">
                <p id="section-3.1-2.3.2.3.1">Fraction of freshly propagated beacons for which at least one corresponding down segment has been registered (see <a href="#path-segment-reg" class="auto internal xref">Section 4</a>)<a href="#section-3.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">For a non-core AS:<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.4.2.1">
                <p id="section-3.1-2.4.2.1.1">Number of up segments available (may be just 0/non-0) younger than the propagation interval (or some multiple thereof).<a href="#section-3.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.4.2.2">
                <p id="section-3.1-2.4.2.2.1">Fraction of up segments that were successfully registered as down segments (see <a href="#path-segment-reg" class="auto internal xref">Section 4</a>).<a href="#section-3.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.4.2.3">
                <p id="section-3.1-2.4.2.3.1">Fraction of children ASes (preferably only those to which the link is up) whereto a beacon was propagated during the last propagation interval<a href="#section-3.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="clock-inaccuracy">
<section id="section-3.2">
        <h3 id="name-effects-of-clock-inaccuracy">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-effects-of-clock-inaccuracy" class="section-name selfRef">Effects of Clock Inaccuracy</a>
        </h3>
<p id="section-3.2-1">A PCB originated by a given Control Service is validated by all the Control Services that receive it. All have different clocks and their differences affect the validation process:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">A fast clock at origination or a slow clock at reception will yield a lengthened expiration time for hops, and possibly an origination time in the future.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">A slow clock at origination or a fast clock at reception will yield a shortened expiration time for hops, and possibly an expiration time in the past.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">This bias comes in addition to a structural delay: PCBs are propagated at a configurable interval - typically around one minute. As a result of this and the way they are iteratively constructed, PCBs with N hops may be validated up to N intervals (so maximally N minutes) after origination which creates a constraint on the expiration of hops. Hops of the minimal expiration time (337.5 seconds - see <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>) would make any PCB describing a path longer than 5 hops expire. For this reason it is unadvisable to create hops with a short expiration time - they <span class="bcp14">SHOULD</span> be around 6 hours.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The Control Service and its clients authenticate each-other according to their respective AS's certificate. Path segments are authenticated based on the certificates of the ASes that they refer to. The <span class="bcp14">RECOMMENDED</span> expiration time of a SCION AS certificate is between 3h and 3 days. Some deployments use up to 5 days.
In comparison to these time scales, clock offsets in the order of minutes are immaterial.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">Each administrator of a SCION Control Service is responsible for maintaining sufficient clock accuracy. No particular method is assumed by this specification.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scalability">
<section id="section-3.3">
        <h3 id="name-path-discovery-time-and-sca">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-path-discovery-time-and-sca" class="section-name selfRef">Path Discovery Time and Scalability</a>
        </h3>
<p id="section-3.3-1">The path discovery mechanism balances the number of discovered paths and the time it takes to discover them versus resource overhead of the discovery.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The resource costs for path discovery are as follows:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">
            <p id="section-3.3-3.1.1">Communication overhead is transmitting the PCBs and occasionally obtaining the required PKI material.<a href="#section-3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.2">
            <p id="section-3.3-3.2.1">Processing overhead is validating the signatures of the AS entries, signing new AS entries, and to a lesser extent, evaluating the beaconing policies.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.3">
            <p id="section-3.3-3.3.1">Storage overhead is both the temporary storage of PCBs before the next propagation interval, and the storage of complete discovered path segments.<a href="#section-3.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-4">All of these are dependent on the number and length of the discovered path segments, i.e. the total number of AS entries of the discovered path segments.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">Interesting metrics for scalability and speed of path discovery are the time until all discoverable path segments have been discovered after a network bootstrap, and the time until new link is usable. In general, the time until a specific PCB is built depends on its length, the propagation interval, and whether on-path ASes use "fast recovery".<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">At each AS, the PCB will be processed and propagated at the subsequent propagation event. As propagation events are not synchronized between different ASes, a PCB arrives at a random point in time during the interval and may be buffered before potentially being propagated. With a propagation interval T at each AS, the mean time until the PCB is propagated in one AS therefore is T / 2 and the mean total time for the propagation steps of a PCB of length L is at worst L * T / 2 (with a variance of L * T^2 / 12).<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">Note that link removal is not part of path discovery in SCION. For scheduled removal of links, operators let path segments expire. On link failures, endpoints route around the failed link by switching to different paths in the data plane.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">To achieve scalability, SCION partitions ASes into ISDs and in an ideal topology the inter-ISD core network should be kept to a moderate size. For more specific observations, we distinguish between intra-ISD and inter-ISD beaconing.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<div id="intra-isd-beaconing">
<section id="section-3.3.1">
          <h4 id="name-intra-isd-beaconing">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-intra-isd-beaconing" class="section-name selfRef">Intra-ISD Beaconing</a>
          </h4>
<p id="section-3.3.1-1">In the intra-ISD beaconing, PCBs are propagated top down along parent-child links from core to leaf ASes. Each AS discovers path segments from itself to the core ASes of its ISD.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">This typically produces an acyclic graph which is narrow at the top, widens towards the leafs, and is relatively shallow. Intermediate provider ASes will have a large number of children, while they only have a small number of parents and the chain of intermediate providers from a leaf AS to a core AS is typically not long (e.g. local, regional, national provider, then core).<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">Each AS potentially receives PCBs for all down path segments from the core to itself. While the number of distinct provider chains to the core is typically moderate, the multiplicity of links between provider ASes has multiplicative effect on the number of PCBs. Once this number grows above the maximum recommended best PCBs set size of 50, ASes <span class="bcp14">SHOULD</span> trim the set of PCBs propagated.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">Ultimately, the number of PCBs received by an AS per propagation interval remains bounded by 50 for each parent link of an AS, and at most 50 PCBs per child link are propagated. The length of these PCBs and thus the number of AS entries to be processed and stored, is expected to be moderate and not grow considerably with network size. The total resource overhead for beacon propagation is easily manageable even for highly connected ASes.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">To illustrate this, an AS with a rather large number of 100 parent links receives at most 5000 PCBs during a propagation interval. Assuming a generous average length of 10 AS entries for these PCBs, this corresponds to 50000 AS entries.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1-6">Due to the variable length fields in AS entries, the sizes for storage and transmission cannot be predicted exactly, but assume an average of 250 bytes per AS entry. At the shortest recommended propagation interval of 5 seconds, this corresponds to an average bandwidth of around 2.5 MB/s and the processing of 10000 signature verifications per second.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.3.1-7">If the same AS has 1000 child links, the propagation of the beacons will require signing one new AS entry for each of the propagated PCBs for each link (at most 50 per link), i.e. at most 50000 signatures per propagation event. The total bandwidth for the propagation of these PCBs for all 1000 child links would, be roughly around 25 MB/s which is manageable with even modest consumer hardware.<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.3.1-8">On a network bootstrap, path segments to each AS are discovered within a number of propagation steps proportional to the longest path. With a 5 second propagation interval and a generous longest path of length 10, all path segments are discovered after 25 seconds on average. When all ASes start propagation just after they've received the first PCBs from any of their upstreams (see 'fast recovery'), the construction of a first path to connect each AS to the ISD core is accelerated.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.3.1-9">When a new parent-child link is added to the network, the parent AS will propagate the available PCBs in the next propagation event. If the AS on the child side of the new link is a leaf AS, path discovery is thus complete after at most one propagation interval. Otherwise, child ASes at distance D below the new link, learn of the new link after at worst D further propagation intervals.<a href="#section-3.3.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="inter-isd-beaconing">
<section id="section-3.3.2">
          <h4 id="name-inter-isd-beaconing">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-inter-isd-beaconing" class="section-name selfRef">Inter-ISD Beaconing</a>
          </h4>
<p id="section-3.3.2-1">In the inter-ISD core beaconing, PCBs are propagated omnidirectionally along core links. Each AS discovers path segments from itself to any other core AS.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">The number of distinct paths through the core network is typically very large. To keep the overhead manageable, at most 5 path segments to every destination AS are discovered and the propagation frequency is slower than in the intra-ISD beaconing (at least 60 seconds between propagation events).<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.2-3">Without making strong assumptions on the topology of the core network, we can assume that shortest paths through real world networks are relatively short: e.g. the Barabási-Albert random graph model predicts a diameter of log(N)/log(log(N)) for a network with N nodes <span>[<a href="#BollRio-2000" class="cite xref">BollRio-2000</a>]</span> and The average distance scales in the same way. Whilst we cannot assume that the selected PCBs are strictly the shortest paths through the network, they are likely to be not very much longer than the shortest paths either.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.2-4">With N the number of participating core ASes, an AS receives up to 5 * N PCBs per propagation interval per core link interface. For highly connected ASes, the number of PCBs received thus becomes rather large and in a network of 1000 ASes, a AS with 300 core links receives up to 1.5 million PCBs per propagation interval.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.3.2-5">Assuming an average PCB length of 6 and the shortest propagation interval of 60 seconds, this corresponds to roughly 150 thousand signature validations per second or roughly 38 MB/s. For much larger, more highly connected ASes, the path discovery tasks of the Control Service can be distributed over many instances in order to increase the PCB throughput.<a href="#section-3.3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.3.2-6">On a network bootstrap, full connectivity is obtained after a number of propagation steps corresponding to the diameter of the network. Assuming a network diameter of 6, this corresponds to roughly 3 minutes on average. When a new link is added to the network, it will be available to connect two ASes at distances D1 and D2 from the link, respectively, at worst after a mean time (D1+D2)*T/2.<a href="#section-3.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="path-segment-reg">
<section id="section-4">
      <h2 id="name-registration-of-path-segmen">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-registration-of-path-segmen" class="section-name selfRef">Registration of Path Segments</a>
      </h2>
<p id="section-4-1"><strong>Path registration</strong> is the process where an AS transforms selected PCBs into path segments, and adding these segments to the relevant path databases thereby making them available to other ASes.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">As mentioned previously, a non-core AS typically receives several PCBs representing several path segments to the core ASes of the ISD the AS belongs to. Out of these PCBs, the non-core AS selects those down path segments through which it wants to be reached, based on AS-specific selection criteria.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The next step is to register the selected down segments with the Control Service of the relevant core ASes in accordance with a process called <em>intra-ISD path segment registration</em>. As a result, a core AS's Control Service contains all intra-ISD path segments registered by the non-core ASes of its ISD. In addition, each core AS Control Service also stores the preferred core path segments to other core ASes during the <em>core segment registration</em> process.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Both processes are described below.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="intra-reg">
<section id="section-4.1">
        <h3 id="name-intra-isd-path-segment-regi">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-intra-isd-path-segment-regi" class="section-name selfRef">Intra-ISD Path Segment Registration</a>
        </h3>
<p id="section-4.1-1">Every <em>registration period</em> (determined by each AS), the AS's Control Service selects two sets of PCBs to transform into two types of path segments:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">Up segments, which allow the infrastructure entities and endpoints in this AS to communicate with core ASes; and<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">Down segments, which allow remote entities to reach this AS.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">The up segments and down segments do not have to be equal as AS may want to communicate with core ASes via one or more up segments that differ from the down segment(s) through which it wants to be reached. Therefore, an AS can define different selection policies for the up segment and down segment sets. In addition, the processes of transforming a PCB in an up segment or a down segment differ slightly.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div id="term-pcb">
<section id="section-4.1.1">
          <h4 id="name-terminating-a-pcb">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-terminating-a-pcb" class="section-name selfRef">Terminating a PCB</a>
          </h4>
<p id="section-4.1.1-1">Both the up segments and down segments end at the AS, so by transforming a PCB into a path segment, an AS "terminates" the PCB for this AS ingress interface and at that moment in time.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">The Control Service of a non-core AS <span class="bcp14">MUST</span> perform the following steps to "terminate" a PCB:<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1-3">
<li id="section-4.1.1-3.1">
              <p id="section-4.1.1-3.1.1">The Control Service adds a new AS entry to the PCB which <span class="bcp14">MUST</span> be defined as follows:<a href="#section-4.1.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.1.2.1">
                  <p id="section-4.1.1-3.1.2.1.1">The next AS <span class="bcp14">MUST NOT</span> be specified.<a href="#section-4.1.1-3.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.1.2.1.2.1">
                      <p id="section-4.1.1-3.1.2.1.2.1.1">In Protobuf message format, this means that the value of the <code>next_isd_as</code> field in the <code>ASEntrySignedBody</code> component <span class="bcp14">MUST</span> be "0".<a href="#section-4.1.1-3.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-4.1.1-3.1.2.2">
                  <p id="section-4.1.1-3.1.2.2.1">The egress interface in the Hop Field component <span class="bcp14">MUST NOT</span> be specified.<a href="#section-4.1.1-3.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.1.2.2.2.1">
                      <p id="section-4.1.1-3.1.2.2.2.1.1">In Protobuf message format, this means that the value of the <code>egress</code> field in the <code>HopField</code> component <span class="bcp14">MUST</span> be "0".<a href="#section-4.1.1-3.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-4.1.1-3.2">
              <p id="section-4.1.1-3.2.1">If the AS has peering links, the Control Service <span class="bcp14">MAY</span> add corresponding peer entry components to the signed body of the AS entry - one peer entry component for each peering link that the AS wants to advertise. The egress interface ID in the Hop Field component of each added peer entry <span class="bcp14">MUST NOT</span> be specified.<a href="#section-4.1.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.2.2.1">
                  <p id="section-4.1.1-3.2.2.1.1">In Protobuf message format, this means that the value of the <code>egress</code> field in the <code>HopField</code> component <span class="bcp14">MUST</span> be "0".<a href="#section-4.1.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-4.1.1-3.3">
              <p id="section-4.1.1-3.3.1">The Control Service <span class="bcp14">MUST</span> sign the modified PCB and append the computed signature.<a href="#section-4.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.1.1-4"><strong>Note:</strong><a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-5.1">
              <p id="section-4.1.1-5.1.1">For more information on the signed body component of an AS entry, see <a href="#ase-sign" class="auto internal xref">Section 2.2.1.4.2</a>.<a href="#section-4.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-5.2">
              <p id="section-4.1.1-5.2.1">For more information on a peer entry, see <a href="#peerentry" class="auto internal xref">Section 2.2.1.7</a>.<a href="#section-4.1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-5.3">
              <p id="section-4.1.1-5.3.1">For more information on the Hop Field component, see <a href="#hopfield" class="auto internal xref">Section 2.2.1.6</a>.<a href="#section-4.1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-5.4">
              <p id="section-4.1.1-5.4.1">For more information on signing an AS entry, see <a href="#sign" class="auto internal xref">Section 2.2.1.4.3</a>.<a href="#section-4.1.1-5.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="transforming-a-pcb-into-an-up-segment">
<section id="section-4.1.2">
          <h4 id="name-transforming-a-pcb-into-an-">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-transforming-a-pcb-into-an-" class="section-name selfRef">Transforming a PCB into an Up Segment</a>
          </h4>
<p id="section-4.1.2-1">Every registration period, the Control Service of a non-core AS performs the following steps to transform PCBs into up segments:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.2-2">
<li id="section-4.1.2-2.1">
              <p id="section-4.1.2-2.1.1">The Control Service selects the PCBs that it wants to transform into up segments from the candidate PCBs in the Beacon Store.<a href="#section-4.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.2-2.2">
              <p id="section-4.1.2-2.2.1">The Control Service "terminates" the selected PCBs by performing the steps described in <a href="#term-pcb" class="auto internal xref">Section 4.1.1</a>. From this moment on, the modified PCBs are called <strong>up segments</strong>.<a href="#section-4.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.2-2.3">
              <p id="section-4.1.2-2.3.1">The Control Service adds the newly created up segments to its own path database.<a href="#section-4.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.1.2-3"><strong>Note:</strong> For more information on possible selection strategies of PCBs, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transforming-a-pcb-into-a-down-segment">
<section id="section-4.1.3">
          <h4 id="name-transforming-a-pcb-into-a-d">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-transforming-a-pcb-into-a-d" class="section-name selfRef">Transforming a PCB into a Down Segment</a>
          </h4>
<p id="section-4.1.3-1">Every registration period, the Control Service of a non-core AS performs the following steps to transform PCBs into down segments:<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.3-2">
<li id="section-4.1.3-2.1">
              <p id="section-4.1.3-2.1.1">The Control Service selects the PCBs that it wants to transform into down segments from the candidate PCBs in the Beacon Store.<a href="#section-4.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.3-2.2">
              <p id="section-4.1.3-2.2.1">The Control Service "terminates" the selected PCBs by performing the steps described in <a href="#term-pcb" class="auto internal xref">Section 4.1.1</a>. From this moment on, the modified PCBs are called <strong>down segments</strong>.<a href="#section-4.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.3-2.3">
              <p id="section-4.1.3-2.3.1">The Control Service registers the newly created down segments with the Control Services of the core ASes that originated the corresponding PCBs. This is done by invoking the <code>SegmentRegistrationService.SegmentsRegistration</code> remote procedure call (RPC) in the Control Services of the relevant core ASes (see also <a href="#reg-proto" class="auto internal xref">Section 4.3</a>). The first ISD-AS entry of the path segment <span class="bcp14">SHOULD</span> be equal to the core ISD-AS where the segment is being registered. If not, the core AS <span class="bcp14">SHOULD</span> reject the segment.<a href="#section-4.1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.1.3-3"><strong>Note:</strong> For more information on possible selection strategies of PCBs, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="core-path-segment-registration">
<section id="section-4.2">
        <h3 id="name-core-path-segment-registrat">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-core-path-segment-registrat" class="section-name selfRef">Core Path Segment Registration</a>
        </h3>
<p id="section-4.2-1">The core beaconing process creates path segments from core AS to core AS. These core segments are then added to the Control Service path database of the core AS that created the segment, so that local and remote endpoints can obtain and use these core segments. In contrast to the intra-ISD registration procedure, there is no need to register core segments with other core ASes as each core AS will receive PCBs originated from every other core AS.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">In every registration period, the Control Service of a core AS performs the following operations:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-3">
<li id="section-4.2-3.1">
            <p id="section-4.2-3.1.1">The core Control Service selects the best PCBs towards each core AS observed so far.<a href="#section-4.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-3.2">
            <p id="section-4.2-3.2.1">The core Control Service "terminates" the selected PCBs by performing the steps described in <a href="#term-pcb" class="auto internal xref">Section 4.1.1</a>. From this moment on, the modified PCBs are called <strong>core segments</strong>.<a href="#section-4.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-3.3">
            <p id="section-4.2-3.3.1">The Control Service adds the newly created core segments to its own path database.<a href="#section-4.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.2-4"><strong>Note:</strong> For more information on possible selection strategies of PCBs, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reg-proto">
<section id="section-4.3">
        <h3 id="name-path-segment-registration-g">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-path-segment-registration-g" class="section-name selfRef">Path Segment Registration gRPC API</a>
        </h3>
<p id="section-4.3-1">The Control Service of a non-core AS has to register the newly created down segments with the Control Services of the core ASes that originated the corresponding PCBs. This registration step is implemented as follows in Protobuf message format:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
   enum SegmentType {
       SEGMENT_TYPE_UNSPECIFIED = 0;
       SEGMENT_TYPE_UP = 1;
       SEGMENT_TYPE_DOWN = 2;
       SEGMENT_TYPE_CORE = 3;
   }

   service SegmentRegistrationService {
       rpc SegmentsRegistration(SegmentsRegistrationRequest) returns (
         SegmentsRegistrationResponse) {}
   }

   message SegmentsRegistrationRequest {
       message Segments {
           repeated PathSegment segments = 1;
       }

       map&lt;int32, Segments&gt; segments = 1;
   }

   message SegmentsRegistrationResponse {}
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">
            <p id="section-4.3-3.1.1"><code>SegmentType</code>: Specifies the type of the path segment to be registered. Currently, only the following type is used:<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1.2.1">
                <p id="section-4.3-3.1.2.1.1"><code>SEGMENT_TYPE_DOWN</code>: Specifies a down segment.<a href="#section-4.3-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-3.2">
            <p id="section-4.3-3.2.1"><code>map&lt;int32, Segments&gt; segments</code>: Represents a separate list of segments for each path segment type. The key is the integer representation of the corresponding <code>SegmentType</code>.<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-3.3">
            <p id="section-4.3-3.3.1"><code>SegmentRegistrationResponse</code>: an empty message returned as an acknowledgement upon success.<a href="#section-4.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="path-mtu">
<section id="section-4.4">
        <h3 id="name-path-mtu">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-path-mtu" class="section-name selfRef">Path MTU</a>
        </h3>
<p id="section-4.4-1">SCION paths represent a sequence of ASes and inter-AS links; each with possibly different MTUs. As a result, the path MTU is the minimum of the MTUs of each inter-AS link and intra-AS networks it traverses. Such MTU information is disseminated during path construction:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1">The MTU of each intra-AS network traversed (represented by the MTU field of the corresponding <span><a href="#ase-sign" class="internal xref">AS Entries</a> (<a href="#ase-sign" class="auto internal xref">Section 2.2.1.4.2</a>)</span>)<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1">The MTU of each inter-AS link or peering link (indicated by the ingress_mtu field of each <a href="#hopentry" class="auto internal xref">Section 2.2.1.5</a> or the peer_mtu field of each <a href="#peerentry" class="auto internal xref">Section 2.2.1.7</a> used)<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-3">Such information is then made available to endpoints during the path lookup process (See <a href="#lookup" class="auto internal xref">Section 5</a>). SCION endpoints are oblivious to the topology of intermediate ASes, therefore when looking up a path they <span class="bcp14">MUST</span> assume that all hops are constrained by the intra-AS MTU of each AS traversed.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="lookup">
<section id="section-5">
      <h2 id="name-path-lookup">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-path-lookup" class="section-name selfRef">Path Lookup</a>
      </h2>
<p id="section-5-1">The <em>path lookup</em> is a fundamental building block of SCION's path management as it enables endpoints to obtain path segments found during path exploration and registered during path registration. This allows the endpoints to construct end-to-end paths from the set of possible path segments returned by the path lookup process. The lookup of paths still happens in the control plane, whereas the construction of the actual end-to-end paths happens in the data plane.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="lookup-process">
<section id="section-5.1">
        <h3 id="name-lookup-process">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-lookup-process" class="section-name selfRef">Lookup Process</a>
        </h3>
<p id="section-5.1-1">An endpoint (source) that wants to start communication with another endpoint (destination) requires up to three path segments:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">An up segment to reach the core of the source ISD (only if the source endpoint is a non-core AS);<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">a core segment to reach<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.2.2.1">
                <p id="section-5.1-2.2.2.1.1">another core AS in the source ISD, in case the destination AS is in the same source ISD, or;<a href="#section-5.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-2.2.2.2">
                <p id="section-5.1-2.2.2.2.1">a core AS in a remote ISD, if the destination AS is in another ISD, and;<a href="#section-5.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">a down segment to reach the destination AS.<a href="#section-5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-3">The actual number of required path segments depends on the location of the destination AS as well as on the availability of shortcuts and peering links. More information on combining and constructing paths is provided by <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The process to look up and fetch path segments consists of the following steps:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-5">
<li id="section-5.1-5.1">
            <p id="section-5.1-5.1.1">The source endpoint queries the Control Service in its own AS (i.e. the source AS) for the required segments by sending a SegmentsRequest. The Control Service has up segments stored in its path database and additionally checks if it has appropriate core segments and down segments stored as well - in this case it returns them immediately in a SegmentsResponse.<a href="#section-5.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-5.2">
            <p id="section-5.1-5.2.1">If there are no appropriate core segments and down segments, the Control Service in the source AS queries the Control Services of the reachable core ASes in the source ISD for core segments to core ASes in the destination ISD. To reach the core Control Services, the Control Service of the source AS uses the locally stored up segments.<a href="#section-5.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-5.3">
            <p id="section-5.1-5.3.1">The Control Service of the source AS combines up segments with the newly retrieved core segments. The Control Service then queries the Control Services of the remote core ASes in the destination ISD to fetch down segments to the destination AS. To reach the remote core ASes, the Control Service of the source AS uses the previously obtained and combined up segments and core segments.<a href="#section-5.1-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-5.4">
            <p id="section-5.1-5.4.1">The Control Service of the source AS returns all retrieved path segments to the source endpoint.<a href="#section-5.1-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-5.5">
            <p id="section-5.1-5.5.1">Once it has obtained all path segments, the source endpoint combines them into an end-to-end path in the data plane.<a href="#section-5.1-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-5.6">
            <p id="section-5.1-5.6.1">The destination endpoint, once it receives the first packet, <span class="bcp14">MAY</span> revert the path in the received packet in order to construct a response. This ensures that traffic flows on the same path bidirectionally.<a href="#section-5.1-5.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.1-6"><a href="#_table-3" class="auto internal xref">Table 3</a> below shows which Control Service provides the source endpoint with which type of path segment.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<span id="name-control-services-responsibl"></span><div id="_table-3">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-control-services-responsibl" class="selfRef">Control services responsible for different types of path segments</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Segment Type</th>
              <th class="text-left" rowspan="1" colspan="1">Responsible Control Service(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Up-segment</td>
              <td class="text-left" rowspan="1" colspan="1">Control service of the source AS</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Core-segment</td>
              <td class="text-left" rowspan="1" colspan="1">Control service of core ASes in source ISD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Down-segment</td>
              <td class="text-left" rowspan="1" colspan="1">Control service of core ASes in destination ISD (either the local ISD or a remote ISD)</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="sequence-of-lookup-requests">
<section id="section-5.1.1">
          <h4 id="name-sequence-of-lookup-requests">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-sequence-of-lookup-requests" class="section-name selfRef">Sequence of Lookup Requests</a>
          </h4>
<p id="section-5.1.1-1">The overall sequence of requests to resolve a path <span class="bcp14">SHOULD</span> be as follows:<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-2">
<li id="section-5.1.1-2.1">
              <p id="section-5.1.1-2.1.1">Request up segments for the source endpoint at the Control Service of the source AS.<a href="#section-5.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.1.1-2.2">
              <p id="section-5.1.1-2.2.1">Request core segments, which start at the core ASes that are reachable with up segments, and end at the core ASes in the destination ISD. If the destination ISD coincides with the source ISD, this step requests core segments to core ASes that the source endpoint cannot directly reach with an up segment.<a href="#section-5.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.1.1-2.3">
              <p id="section-5.1.1-2.3.1">Request down segments starting at core ASes in the destination ISD.<a href="#section-5.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.1.1-3">The segment lookup API gRPC definition can be found in <a href="#_figure-11" class="auto internal xref">Figure 12</a>.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="caching">
<section id="section-5.1.2">
          <h4 id="name-caching">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-caching" class="section-name selfRef">Caching</a>
          </h4>
<p id="section-5.1.2-1">For the sake of efficiency, the Control Service of the source AS <span class="bcp14">SHOULD</span> cache each returned path segment request. Caching ensures that path lookups are fast for frequently used destinations and is also essential to ensure that the path lookup process is scalable and can be performed with low latency.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">In general, to improve overall efficiency, the Control Services of all ASes <span class="bcp14">SHOULD</span> do the following:<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-3.1">
              <p id="section-5.1.2-3.1.1">Cache the returned path segments.<a href="#section-5.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-3.2">
              <p id="section-5.1.2-3.2.1">Send requests in parallel when requesting path segments from other Control Services.<a href="#section-5.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="behavior-of-actors-in-the-lookup-process">
<section id="section-5.2">
        <h3 id="name-behavior-of-actors-in-the-l">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-behavior-of-actors-in-the-l" class="section-name selfRef">Behavior of Actors in the Lookup Process</a>
        </h3>
<p id="section-5.2-1">As described above, the source endpoint resolves paths with a sequence of segment requests to the Control Service of the source AS. The Control Service in the source AS either answers directly or forwards these requests to the responsible Control Services of core ASes. In SCION, the instances that handle these segment requests at the Control Services are called <em>source AS segment-request handler</em> and <em>core AS segment-request handler</em>, respectively.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">This section specifies the behavior of the segment request handlers in the lookup process.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div id="wildcard">
<section id="section-5.2.1">
          <h4 id="name-use-of-wildcard-addresses-i">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-use-of-wildcard-addresses-i" class="section-name selfRef">Use of Wildcard Addresses in the Lookup Process</a>
          </h4>
<p id="section-5.2.1-1">Endpoints can use wildcard addresses to designate any core AS in path segment requests. The segment request handlers <span class="bcp14">MUST</span> expand these wildcard addresses and translate them into one or more actual addresses. <a href="#_table-4" class="auto internal xref">Table 4</a> below shows who is responsible for what.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2"><strong>Note:</strong> For general information on the use of wildcard addresses in SCION, see <a href="#serv-disc" class="auto internal xref">Section 1.5.4</a>.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<span id="name-use-of-wildcards-in-path-se"></span><div id="_table-4">
<table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-use-of-wildcards-in-path-se" class="selfRef">Use of wildcards in path segments requests</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Segment Request</th>
                <th class="text-left" rowspan="1" colspan="1">Wildcard Represents</th>
                <th class="text-left" rowspan="1" colspan="1">Expanded/Translated By</th>
                <th class="text-left" rowspan="1" colspan="1">Translated Into</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Up segment</td>
                <td class="text-left" rowspan="1" colspan="1">"Destination" core AS (where up segment ends)</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address destination core AS in source ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Core segment</td>
                <td class="text-left" rowspan="1" colspan="1">Source core AS (where core segment starts)<sup>1</sup>
</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address source core AS in source ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Core segment</td>
                <td class="text-left" rowspan="1" colspan="1">Destination core AS (where core segment ends)</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source core AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address destination core AS in destination ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Down segment</td>
                <td class="text-left" rowspan="1" colspan="1">"Source" core AS (where down segment starts)<sup>2</sup>
</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address source core AS in destination ISD</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.2.1-4">1) Includes all core ASes for which an up segment from the source AS exists.<br>
2) Includes all core ASes in destination ISD with a down segment to destination AS.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="segment-request-handler-of-a-non-core-source-as">
<section id="section-5.2.2">
          <h4 id="name-segment-request-handler-of-">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-segment-request-handler-of-" class="section-name selfRef">Segment-Request Handler of a Non-Core Source AS</a>
          </h4>
<p id="section-5.2.2-1">When the segment request handler of the Control Service of a <em>non-core</em> source AS receives a path segment request, it <span class="bcp14">MUST</span> proceed as follows:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-2">
<li id="section-5.2.2-2.1">
              <p id="section-5.2.2-2.1.1">Determine the requested segment type.<a href="#section-5.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.2">
              <p id="section-5.2.2-2.2.1">In the case of an up segment request, look up matching up segments in the path database and return them.<a href="#section-5.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.3">
              <p id="section-5.2.2-2.3.1">In the case of a core segment request from a source core AS to a destination core AS:<a href="#section-5.2.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.3.2.1">
                  <p id="section-5.2.2-2.3.2.1.1">Expand the source wildcard into separate requests for each reachable core AS in the source ISD.<a href="#section-5.2.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.2.2-2.3.2.2">
                  <p id="section-5.2.2-2.3.2.2.1">For each core segment request;<a href="#section-5.2.2-2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.3.2.2.2.1">
                      <p id="section-5.2.2-2.3.2.2.2.1.1">If possible, return matching core segments from cache;<a href="#section-5.2.2-2.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.2.2-2.3.2.2.2.2">
                      <p id="section-5.2.2-2.3.2.2.2.2.1">Otherwise, request the core segments from the Control Services of each reachable core AS at the source of the core segment, and then add the retrieved core segments to the cache.<a href="#section-5.2.2-2.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-5.2.2-2.4">
              <p id="section-5.2.2-2.4.1">In the case of a down segment request:<a href="#section-5.2.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.4.2.1">
                  <p id="section-5.2.2-2.4.2.1.1">Expand the source wildcard into separate requests for every core AS in the destination ISD (destination ISD refers to the ISD to which the destination endpoint belongs).<a href="#section-5.2.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.2.2-2.4.2.2">
                  <p id="section-5.2.2-2.4.2.2.1">For each segment request;<a href="#section-5.2.2-2.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.4.2.2.2.1">
                      <p id="section-5.2.2-2.4.2.2.2.1.1">If possible, return matching down segments from cache;<a href="#section-5.2.2-2.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.2.2-2.4.2.2.2.2">
                      <p id="section-5.2.2-2.4.2.2.2.2.1">Otherwise, request the down segment from the Control Services of the core ASes at the source of the down segment. Sending the request may require looking up core segments to the source core AS of the down segment, and then adding the retrieved down segments to the cache.<a href="#section-5.2.2-2.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
<div id="segment-request-handler-of-a-core-as">
<section id="section-5.2.3">
          <h4 id="name-segment-request-handler-of-a">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-segment-request-handler-of-a" class="section-name selfRef">Segment-Request Handler of a Core AS</a>
          </h4>
<p id="section-5.2.3-1">When the segment request handler of a <em>core AS</em> Control Service receives a path segment request, it <span class="bcp14">MUST</span> proceed as follows:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-2">
<li id="section-5.2.3-2.1">
              <p id="section-5.2.3-2.1.1">Validate the request:<a href="#section-5.2.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.1.2.1">
                  <p id="section-5.2.3-2.1.2.1.1">The source of the path segment <span class="bcp14">MUST</span> be this core AS.<a href="#section-5.2.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.2.3-2.1.2.2">
                  <p id="section-5.2.3-2.1.2.2.1">The request <span class="bcp14">MUST</span> either be;<a href="#section-5.2.3-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.1.2.2.2.1">
                      <p id="section-5.2.3-2.1.2.2.2.1.1">for a core segment to a core AS in this ISD or another ISD, or;<a href="#section-5.2.3-2.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.2.3-2.1.2.2.2.2">
                      <p id="section-5.2.3-2.1.2.2.2.2.1">for a down segment to an AS in this ISD.<a href="#section-5.2.3-2.1.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-5.2.3-2.2">
              <p id="section-5.2.3-2.2.1">If the destination is a core or wildcard address, then load matching core segments from the path database and return.<a href="#section-5.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.3-2.3">
              <p id="section-5.2.3-2.3.1">Otherwise, load the matching down segments from the path database and return.<a href="#section-5.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.2.3-3"><a href="#app-c" class="auto internal xref">Appendix "Path-Lookup Examples"</a> shows by means of an illustration how the lookup of path segments in SCION works.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="scmp">
<section id="section-6">
      <h2 id="name-scmp">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-scmp" class="section-name selfRef">SCMP</a>
      </h2>
<p id="section-6-1">The SCION Control Message Protocol (SCMP) provides functionality for network diagnostics, such as traceroute, and error messages that signal packet processing or network-layer problems. SCMP is a helpful tool for network diagnostics and, in the case of External Interface Down and Internal Connectivity Down messages, a signal for endpoints to detect network failures more rapidly and fail-over to different paths. However, SCION nodes should not strictly rely on the availability of SCMP, as this protocol may not be supported by all devices and/or may be subject to rate limiting.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This document specifies only messages <span class="bcp14">RECOMMENDED</span> for the purposes of path diagnosis and recovery. An extended specification, still a work in progress, can be found in <span>[<a href="#SCMP" class="cite xref">SCMP</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="general-format">
<section id="section-6.1">
        <h3 id="name-general-format">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-general-format" class="section-name selfRef">General Format</a>
        </h3>
<p id="section-6.1-1">Every SCMP message is preceded by a SCION header, and zero or more SCION extension headers. The SCMP header is identified by a <code>NextHdr</code> value of <code>202</code> in the immediately preceding header.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The messages have the following general format:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<span id="name-scmp-message-format"></span><div id="_scmp-format">
<figure id="figure-17">
          <div id="section-6.1-3.1">
            <div class="alignLeft art-svg artwork" id="section-6.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="456" height="118" viewBox="0 0 456.0 118.0">
                <path d="M 2.878906 39.319336 L 2.878906 25.300781 L 3.738281 25.300781 L 3.738281 32.412109 L 6.729980 32.412109 L 6.729980 33.335938 L 3.738281 33.335938 L 3.738281 39.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 2.878906 52.319336 L 2.878906 38.300781 L 3.738281 38.300781 L 3.738281 52.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 2.878906 65.319336 L 2.878906 51.300781 L 3.738281 51.300781 L 3.738281 58.412109 L 6.729980 58.412109 L 6.729980 59.335938 L 3.738281 59.335938 L 3.738281 65.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 2.878906 78.319336 L 2.878906 64.300781 L 3.738281 64.300781 L 3.738281 78.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 2.878906 91.319336 L 2.878906 77.300781 L 3.738281 77.300781 L 3.738281 84.412109 L 6.729980 84.412109 L 6.729980 85.335938 L 3.738281 85.335938 L 3.738281 91.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 2.878906 104.319336 L 2.878906 90.300781 L 3.738281 90.300781 L 3.738281 104.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 2.878906 111.335938 L 2.878906 103.300781 L 3.738281 103.300781 L 3.738281 110.412109 L 6.729980 110.412109 L 6.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 6.892578 111.335938 L 6.892578 110.412109 L 13.729980 110.412109 L 13.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 13.892578 111.335938 L 13.892578 110.412109 L 20.729980 110.412109 L 20.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 20.892578 111.335938 L 20.892578 110.412109 L 27.729980 110.412109 L 27.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 27.892578 111.335938 L 27.892578 110.412109 L 34.729980 110.412109 L 34.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 34.892578 111.335938 L 34.892578 110.412109 L 41.729980 110.412109 L 41.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 41.892578 111.335938 L 41.892578 110.412109 L 48.729980 110.412109 L 48.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 48.892578 111.335938 L 48.892578 110.412109 L 55.729980 110.412109 L 55.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 55.892578 111.335938 L 55.892578 110.412109 L 62.729980 110.412109 L 62.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 62.892578 111.335938 L 62.892578 110.412109 L 69.729980 110.412109 L 69.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 69.892578 111.335938 L 69.892578 110.412109 L 76.729980 110.412109 L 76.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 76.892578 111.335938 L 76.892578 110.412109 L 83.729980 110.412109 L 83.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 83.892578 111.335938 L 83.892578 110.412109 L 90.729980 110.412109 L 90.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 90.892578 111.335938 L 90.892578 110.412109 L 97.729980 110.412109 L 97.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 97.892578 111.335938 L 97.892578 110.412109 L 104.729980 110.412109 L 104.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 104.892578 111.335938 L 104.892578 110.412109 L 111.729980 110.412109 L 111.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 111.892578 111.335938 L 111.892578 110.412109 L 118.729980 110.412109 L 118.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 118.892578 111.335938 L 118.892578 110.412109 L 125.729980 110.412109 L 125.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 125.892578 111.335938 L 125.892578 110.412109 L 132.729980 110.412109 L 132.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 132.892578 111.335938 L 132.892578 110.412109 L 139.729980 110.412109 L 139.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 139.892578 111.335938 L 139.892578 110.412109 L 146.729980 110.412109 L 146.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 146.892578 111.335938 L 146.892578 110.412109 L 153.729980 110.412109 L 153.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 153.892578 111.335938 L 153.892578 110.412109 L 160.729980 110.412109 L 160.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 160.892578 111.335938 L 160.892578 110.412109 L 167.729980 110.412109 L 167.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 167.892578 111.335938 L 167.892578 110.412109 L 174.729980 110.412109 L 174.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 174.892578 111.335938 L 174.892578 110.412109 L 181.729980 110.412109 L 181.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 181.892578 111.335938 L 181.892578 110.412109 L 188.729980 110.412109 L 188.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 188.892578 111.335938 L 188.892578 110.412109 L 195.729980 110.412109 L 195.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 195.892578 111.335938 L 195.892578 110.412109 L 202.729980 110.412109 L 202.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 202.892578 111.335938 L 202.892578 110.412109 L 209.729980 110.412109 L 209.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 209.892578 111.335938 L 209.892578 110.412109 L 216.729980 110.412109 L 216.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 216.892578 111.335938 L 216.892578 110.412109 L 223.729980 110.412109 L 223.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 223.892578 111.335938 L 223.892578 110.412109 L 230.729980 110.412109 L 230.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 230.892578 111.335938 L 230.892578 110.412109 L 237.729980 110.412109 L 237.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 237.892578 111.335938 L 237.892578 110.412109 L 244.729980 110.412109 L 244.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 244.892578 111.335938 L 244.892578 110.412109 L 251.729980 110.412109 L 251.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 251.892578 111.335938 L 251.892578 110.412109 L 258.729980 110.412109 L 258.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 258.892578 111.335938 L 258.892578 110.412109 L 265.729980 110.412109 L 265.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 265.892578 111.335938 L 265.892578 110.412109 L 272.729980 110.412109 L 272.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 272.892578 111.335938 L 272.892578 110.412109 L 279.729980 110.412109 L 279.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 279.892578 111.335938 L 279.892578 110.412109 L 286.729980 110.412109 L 286.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 286.892578 111.335938 L 286.892578 110.412109 L 293.729980 110.412109 L 293.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 293.892578 111.335938 L 293.892578 110.412109 L 300.729980 110.412109 L 300.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 300.892578 111.335938 L 300.892578 110.412109 L 307.729980 110.412109 L 307.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 307.892578 111.335938 L 307.892578 110.412109 L 314.729980 110.412109 L 314.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 314.892578 111.335938 L 314.892578 110.412109 L 321.729980 110.412109 L 321.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 321.892578 111.335938 L 321.892578 110.412109 L 328.729980 110.412109 L 328.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 328.892578 111.335938 L 328.892578 110.412109 L 335.729980 110.412109 L 335.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 335.892578 111.335938 L 335.892578 110.412109 L 342.729980 110.412109 L 342.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 342.892578 111.335938 L 342.892578 110.412109 L 349.729980 110.412109 L 349.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 349.892578 111.335938 L 349.892578 110.412109 L 356.729980 110.412109 L 356.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 356.892578 111.335938 L 356.892578 110.412109 L 363.729980 110.412109 L 363.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 363.892578 111.335938 L 363.892578 110.412109 L 370.729980 110.412109 L 370.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 370.892578 111.335938 L 370.892578 110.412109 L 377.729980 110.412109 L 377.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 377.892578 111.335938 L 377.892578 110.412109 L 384.729980 110.412109 L 384.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 384.892578 111.335938 L 384.892578 110.412109 L 391.729980 110.412109 L 391.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 391.892578 111.335938 L 391.892578 110.412109 L 398.729980 110.412109 L 398.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 398.892578 111.335938 L 398.892578 110.412109 L 405.729980 110.412109 L 405.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 405.892578 111.335938 L 405.892578 110.412109 L 412.729980 110.412109 L 412.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 412.892578 111.335938 L 412.892578 110.412109 L 419.729980 110.412109 L 419.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 419.892578 111.335938 L 419.892578 110.412109 L 426.729980 110.412109 L 426.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 426.892578 111.335938 L 426.892578 110.412109 L 433.729980 110.412109 L 433.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 433.892578 111.335938 L 433.892578 110.412109 L 440.729980 110.412109 L 440.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 440.892578 111.335938 L 440.892578 110.412109 L 447.729980 110.412109 L 447.729980 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 447.892578 111.335938 L 447.892578 110.412109 L 450.878906 110.412109 L 450.878906 103.300781 L 451.738281 103.300781 L 451.738281 111.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 172.592285 92.116211 Q 171.877930 93.340820 171.526123 94.557373 Q 171.174316 95.773926 171.174316 97.009277 Q 171.174316 98.239258 171.526123 99.458496 Q 171.877930 100.677734 172.592285 101.913086 L 171.732910 101.913086 Q 170.921875 100.634766 170.524414 99.423584 Q 170.126953 98.212402 170.126953 97.009277 Q 170.126953 95.811523 170.524414 94.597656 Q 170.921875 93.383789 171.732910 92.116211 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 175.537109 94.984375 L 176.562988 94.984375 L 178.308594 100.033203 L 180.059570 94.984375 L 181.085449 94.984375 L 178.947754 101.000000 L 177.674805 101.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 185.770508 97.976074 L 185.442871 97.976074 Q 184.578125 97.976074 184.140381 98.279541 Q 183.702637 98.583008 183.702637 99.184570 Q 183.702637 99.727051 184.030273 100.027832 Q 184.357910 100.328613 184.937988 100.328613 Q 185.754395 100.328613 186.221680 99.761963 Q 186.688965 99.195312 186.694336 98.196289 L 186.694336 97.976074 Z M 187.687988 97.567871 L 187.687988 101.000000 L 186.694336 101.000000 L 186.694336 100.108398 Q 186.377441 100.645508 185.896729 100.900635 Q 185.416016 101.155762 184.728516 101.155762 Q 183.810059 101.155762 183.262207 100.637451 Q 182.714355 100.119141 182.714355 99.249023 Q 182.714355 98.244629 183.388428 97.723633 Q 184.062500 97.202637 185.367676 97.202637 L 186.694336 97.202637 L 186.694336 97.046875 Q 186.688965 96.327148 186.329102 96.002197 Q 185.969238 95.677246 185.179688 95.677246 Q 184.674805 95.677246 184.159180 95.822266 Q 183.643555 95.967285 183.154785 96.246582 L 183.154785 95.258301 Q 183.702637 95.048828 184.204834 94.944092 Q 184.707031 94.839355 185.179688 94.839355 Q 185.926270 94.839355 186.455322 95.059570 Q 186.984375 95.279785 187.312012 95.720215 Q 187.516113 95.988770 187.602051 96.383545 Q 187.687988 96.778320 187.687988 97.567871 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 195.203613 96.225098 Q 194.886719 95.978027 194.559082 95.865234 Q 194.231445 95.752441 193.839355 95.752441 Q 192.915527 95.752441 192.426758 96.332520 Q 191.937988 96.912598 191.937988 98.008301 L 191.937988 101.000000 L 190.944336 101.000000 L 190.944336 94.984375 L 191.937988 94.984375 L 191.937988 96.160645 Q 192.185059 95.521484 192.697998 95.180420 Q 193.210938 94.839355 193.914551 94.839355 Q 194.279785 94.839355 194.596680 94.930664 Q 194.913574 95.021973 195.203613 95.215332 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 197.697266 95.005859 L 200.227051 95.005859 L 200.227051 100.231934 L 202.187500 100.231934 L 202.187500 101.000000 L 197.278320 101.000000 L 197.278320 100.231934 L 199.238770 100.231934 L 199.238770 95.773926 L 197.697266 95.773926 Z M 199.238770 92.669434 L 200.227051 92.669434 L 200.227051 93.915527 L 199.238770 93.915527 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 206.770508 97.976074 L 206.442871 97.976074 Q 205.578125 97.976074 205.140381 98.279541 Q 204.702637 98.583008 204.702637 99.184570 Q 204.702637 99.727051 205.030273 100.027832 Q 205.357910 100.328613 205.937988 100.328613 Q 206.754395 100.328613 207.221680 99.761963 Q 207.688965 99.195312 207.694336 98.196289 L 207.694336 97.976074 Z M 208.687988 97.567871 L 208.687988 101.000000 L 207.694336 101.000000 L 207.694336 100.108398 Q 207.377441 100.645508 206.896729 100.900635 Q 206.416016 101.155762 205.728516 101.155762 Q 204.810059 101.155762 204.262207 100.637451 Q 203.714355 100.119141 203.714355 99.249023 Q 203.714355 98.244629 204.388428 97.723633 Q 205.062500 97.202637 206.367676 97.202637 L 207.694336 97.202637 L 207.694336 97.046875 Q 207.688965 96.327148 207.329102 96.002197 Q 206.969238 95.677246 206.179688 95.677246 Q 205.674805 95.677246 205.159180 95.822266 Q 204.643555 95.967285 204.154785 96.246582 L 204.154785 95.258301 Q 204.702637 95.048828 205.204834 94.944092 Q 205.707031 94.839355 206.179688 94.839355 Q 206.926270 94.839355 207.455322 95.059570 Q 207.984375 95.279785 208.312012 95.720215 Q 208.516113 95.988770 208.602051 96.383545 Q 208.687988 96.778320 208.687988 97.567871 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 214.930664 97.997559 Q 214.930664 96.848145 214.565430 96.262695 Q 214.200195 95.677246 213.485840 95.677246 Q 212.766113 95.677246 212.395508 96.265381 Q 212.024902 96.853516 212.024902 97.997559 Q 212.024902 99.136230 212.395508 99.727051 Q 212.766113 100.317871 213.485840 100.317871 Q 214.200195 100.317871 214.565430 99.732422 Q 214.930664 99.146973 214.930664 97.997559 Z M 212.024902 95.752441 Q 212.261230 95.312012 212.677490 95.075684 Q 213.093750 94.839355 213.641602 94.839355 Q 214.726562 94.839355 215.349609 95.674561 Q 215.972656 96.509766 215.972656 97.976074 Q 215.972656 99.463867 215.346924 100.309814 Q 214.721191 101.155762 213.630859 101.155762 Q 213.093750 101.155762 212.682861 100.922119 Q 212.271973 100.688477 212.024902 100.242676 L 212.024902 101.000000 L 211.036621 101.000000 L 211.036621 92.642578 L 212.024902 92.642578 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 220.861816 98.824707 Q 220.861816 99.490723 221.106201 99.829102 Q 221.350586 100.167480 221.828613 100.167480 L 222.983398 100.167480 L 222.983398 101.000000 L 221.731934 101.000000 Q 220.845703 101.000000 220.359619 100.433350 Q 219.873535 99.866699 219.873535 98.824707 L 219.873535 93.383789 L 218.289062 93.383789 L 218.289062 92.610352 L 220.861816 92.610352 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 230.015625 97.498047 L 230.015625 97.981445 L 225.734863 97.981445 L 225.734863 98.013672 Q 225.691895 99.243652 226.204834 99.780762 Q 226.717773 100.317871 227.652344 100.317871 Q 228.125000 100.317871 228.640625 100.167480 Q 229.156250 100.017090 229.741699 99.710938 L 229.741699 100.693848 Q 229.177734 100.924805 228.654053 101.040283 Q 228.130371 101.155762 227.641602 101.155762 Q 226.239746 101.155762 225.450195 100.315186 Q 224.660645 99.474609 224.660645 97.997559 Q 224.660645 96.558105 225.434082 95.698730 Q 226.207520 94.839355 227.496582 94.839355 Q 228.645996 94.839355 229.309326 95.618164 Q 229.972656 96.396973 230.015625 97.498047 Z M 229.027344 97.208008 Q 228.962891 96.584961 228.573486 96.131104 Q 228.184082 95.677246 227.453613 95.677246 Q 226.739258 95.677246 226.277344 96.149902 Q 225.815430 96.622559 225.772461 97.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 241.861816 98.824707 Q 241.861816 99.490723 242.106201 99.829102 Q 242.350586 100.167480 242.828613 100.167480 L 243.983398 100.167480 L 243.983398 101.000000 L 242.731934 101.000000 Q 241.845703 101.000000 241.359619 100.433350 Q 240.873535 99.866699 240.873535 98.824707 L 240.873535 93.383789 L 239.289062 93.383789 L 239.289062 92.610352 L 241.861816 92.610352 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 251.015625 97.498047 L 251.015625 97.981445 L 246.734863 97.981445 L 246.734863 98.013672 Q 246.691895 99.243652 247.204834 99.780762 Q 247.717773 100.317871 248.652344 100.317871 Q 249.125000 100.317871 249.640625 100.167480 Q 250.156250 100.017090 250.741699 99.710938 L 250.741699 100.693848 Q 250.177734 100.924805 249.654053 101.040283 Q 249.130371 101.155762 248.641602 101.155762 Q 247.239746 101.155762 246.450195 100.315186 Q 245.660645 99.474609 245.660645 97.997559 Q 245.660645 96.558105 246.434082 95.698730 Q 247.207520 94.839355 248.496582 94.839355 Q 249.645996 94.839355 250.309326 95.618164 Q 250.972656 96.396973 251.015625 97.498047 Z M 250.027344 97.208008 Q 249.962891 96.584961 249.573486 96.131104 Q 249.184082 95.677246 248.453613 95.677246 Q 247.739258 95.677246 247.277344 96.149902 Q 246.815430 96.622559 246.772461 97.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 257.645020 97.272461 L 257.645020 101.000000 L 256.651367 101.000000 L 256.651367 97.272461 Q 256.651367 96.461426 256.366699 96.080078 Q 256.082031 95.698730 255.475098 95.698730 Q 254.782227 95.698730 254.408936 96.190186 Q 254.035645 96.681641 254.035645 97.600098 L 254.035645 101.000000 L 253.047363 101.000000 L 253.047363 94.984375 L 254.035645 94.984375 L 254.035645 95.886719 Q 254.298828 95.371094 254.750000 95.105225 Q 255.201172 94.839355 255.818848 94.839355 Q 256.737305 94.839355 257.191162 95.443604 Q 257.645020 96.047852 257.645020 97.272461 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 263.608398 97.943848 Q 263.608398 96.832031 263.245850 96.254639 Q 262.883301 95.677246 262.190430 95.677246 Q 261.465332 95.677246 261.083984 96.254639 Q 260.702637 96.832031 260.702637 97.943848 Q 260.702637 99.055664 261.086670 99.638428 Q 261.470703 100.221191 262.201172 100.221191 Q 262.883301 100.221191 263.245850 99.635742 Q 263.608398 99.050293 263.608398 97.943848 Z M 264.596680 100.613281 Q 264.596680 101.966797 263.957520 102.665039 Q 263.318359 103.363281 262.077637 103.363281 Q 261.669434 103.363281 261.223633 103.288086 Q 260.777832 103.212891 260.332031 103.067871 L 260.332031 102.090332 Q 260.858398 102.337402 261.288086 102.455566 Q 261.717773 102.573730 262.077637 102.573730 Q 262.877930 102.573730 263.243164 102.138672 Q 263.608398 101.703613 263.608398 100.758301 L 263.608398 100.715332 L 263.608398 100.043945 Q 263.372070 100.548828 262.963867 100.795898 Q 262.555664 101.042969 261.970215 101.042969 Q 260.917480 101.042969 260.289062 100.199707 Q 259.660645 99.356445 259.660645 97.943848 Q 259.660645 96.525879 260.289062 95.682617 Q 260.917480 94.839355 261.970215 94.839355 Q 262.550293 94.839355 262.953125 95.070312 Q 263.355957 95.301270 263.608398 95.784668 L 263.608398 95.005859 L 264.596680 95.005859 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 269.297852 93.276367 L 269.297852 94.984375 L 271.542969 94.984375 L 271.542969 95.752441 L 269.297852 95.752441 L 269.297852 99.018066 Q 269.297852 99.684082 269.550293 99.947266 Q 269.802734 100.210449 270.431152 100.210449 L 271.542969 100.210449 L 271.542969 101.000000 L 270.334473 101.000000 Q 269.222656 101.000000 268.766113 100.554199 Q 268.309570 100.108398 268.309570 99.018066 L 268.309570 95.752441 L 266.703613 95.752441 L 266.703613 94.984375 L 268.309570 94.984375 L 268.309570 93.276367 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 278.645020 97.272461 L 278.645020 101.000000 L 277.651367 101.000000 L 277.651367 97.272461 Q 277.651367 96.461426 277.366699 96.080078 Q 277.082031 95.698730 276.475098 95.698730 Q 275.782227 95.698730 275.408936 96.190186 Q 275.035645 96.681641 275.035645 97.600098 L 275.035645 101.000000 L 274.047363 101.000000 L 274.047363 92.642578 L 275.035645 92.642578 L 275.035645 95.886719 Q 275.298828 95.371094 275.750000 95.105225 Q 276.201172 94.839355 276.818848 94.839355 Q 277.737305 94.839355 278.191162 95.443604 Q 278.645020 96.047852 278.645020 97.272461 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 281.869141 92.116211 L 282.728516 92.116211 Q 283.539551 93.383789 283.937012 94.597656 Q 284.334473 95.811523 284.334473 97.009277 Q 284.334473 98.217773 283.937012 99.431641 Q 283.539551 100.645508 282.728516 101.913086 L 281.869141 101.913086 Q 282.583496 100.666992 282.935303 99.447754 Q 283.287109 98.228516 283.287109 97.009277 Q 283.287109 95.784668 282.935303 94.565430 Q 282.583496 93.346191 281.869141 92.116211 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 450.878906 104.319336 L 450.878906 90.300781 L 451.738281 90.300781 L 451.738281 104.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 450.878906 91.319336 L 450.878906 85.335938 L 447.892578 85.335938 L 447.892578 84.412109 L 450.878906 84.412109 L 450.878906 77.300781 L 451.738281 77.300781 L 451.738281 91.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 154.252441 66.980957 L 160.370117 66.980957 L 160.370117 67.894043 L 157.861816 67.894043 L 157.861816 75.000000 L 156.771484 75.000000 L 156.771484 67.894043 L 154.252441 67.894043 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 165.608398 73.066406 Q 165.361328 73.694824 164.979980 74.720703 Q 164.448242 76.138672 164.265625 76.450195 Q 164.018555 76.869141 163.647949 77.078613 Q 163.277344 77.288086 162.783203 77.288086 L 161.988281 77.288086 L 161.988281 76.460938 L 162.573730 76.460938 Q 163.008789 76.460938 163.255859 76.208496 Q 163.502930 75.956055 163.884277 74.903320 L 161.558594 68.984375 L 162.605957 68.984375 L 164.389160 73.689453 L 166.145508 68.984375 L 167.192871 68.984375 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 170.014160 74.242676 L 170.014160 77.288086 L 169.020508 77.288086 L 169.020508 68.984375 L 170.014160 68.984375 L 170.014160 69.752441 Q 170.261230 69.306641 170.672119 69.072998 Q 171.083008 68.839355 171.620117 68.839355 Q 172.710449 68.839355 173.330811 69.682617 Q 173.951172 70.525879 173.951172 72.019043 Q 173.951172 73.485352 173.328125 74.320557 Q 172.705078 75.155762 171.620117 75.155762 Q 171.072266 75.155762 170.661377 74.922119 Q 170.250488 74.688477 170.014160 74.242676 Z M 172.914551 71.997559 Q 172.914551 70.848145 172.552002 70.262695 Q 172.189453 69.677246 171.475098 69.677246 Q 170.755371 69.677246 170.384766 70.265381 Q 170.014160 70.853516 170.014160 71.997559 Q 170.014160 73.136230 170.384766 73.727051 Q 170.755371 74.317871 171.475098 74.317871 Q 172.189453 74.317871 172.552002 73.732422 Q 172.914551 73.146973 172.914551 71.997559 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 181.015625 71.498047 L 181.015625 71.981445 L 176.734863 71.981445 L 176.734863 72.013672 Q 176.691895 73.243652 177.204834 73.780762 Q 177.717773 74.317871 178.652344 74.317871 Q 179.125000 74.317871 179.640625 74.167480 Q 180.156250 74.017090 180.741699 73.710938 L 180.741699 74.693848 Q 180.177734 74.924805 179.654053 75.040283 Q 179.130371 75.155762 178.641602 75.155762 Q 177.239746 75.155762 176.450195 74.315186 Q 175.660645 73.474609 175.660645 71.997559 Q 175.660645 70.558105 176.434082 69.698730 Q 177.207520 68.839355 178.496582 68.839355 Q 179.645996 68.839355 180.309326 69.618164 Q 180.972656 70.396973 181.015625 71.498047 Z M 180.027344 71.208008 Q 179.962891 70.584961 179.573486 70.131104 Q 179.184082 69.677246 178.453613 69.677246 Q 177.739258 69.677246 177.277344 70.149902 Q 176.815430 70.622559 176.772461 71.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 182.547852 71.111328 L 188.241211 71.111328 L 188.241211 72.019043 L 182.547852 72.019043 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 193.608398 69.752441 L 193.608398 66.642578 L 194.596680 66.642578 L 194.596680 75.000000 L 193.608398 75.000000 L 193.608398 74.242676 Q 193.361328 74.688477 192.950439 74.922119 Q 192.539551 75.155762 192.002441 75.155762 Q 190.912109 75.155762 190.286377 74.309814 Q 189.660645 73.463867 189.660645 71.976074 Q 189.660645 70.509766 190.289062 69.674561 Q 190.917480 68.839355 192.002441 68.839355 Q 192.544922 68.839355 192.958496 69.072998 Q 193.372070 69.306641 193.608398 69.752441 Z M 190.702637 71.997559 Q 190.702637 73.146973 191.067871 73.732422 Q 191.433105 74.317871 192.147461 74.317871 Q 192.861816 74.317871 193.235107 73.727051 Q 193.608398 73.136230 193.608398 71.997559 Q 193.608398 70.853516 193.235107 70.265381 Q 192.861816 69.677246 192.147461 69.677246 Q 191.433105 69.677246 191.067871 70.262695 Q 190.702637 70.848145 190.702637 71.997559 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 202.015625 71.498047 L 202.015625 71.981445 L 197.734863 71.981445 L 197.734863 72.013672 Q 197.691895 73.243652 198.204834 73.780762 Q 198.717773 74.317871 199.652344 74.317871 Q 200.125000 74.317871 200.640625 74.167480 Q 201.156250 74.017090 201.741699 73.710938 L 201.741699 74.693848 Q 201.177734 74.924805 200.654053 75.040283 Q 200.130371 75.155762 199.641602 75.155762 Q 198.239746 75.155762 197.450195 74.315186 Q 196.660645 73.474609 196.660645 71.997559 Q 196.660645 70.558105 197.434082 69.698730 Q 198.207520 68.839355 199.496582 68.839355 Q 200.645996 68.839355 201.309326 69.618164 Q 201.972656 70.396973 202.015625 71.498047 Z M 201.027344 71.208008 Q 200.962891 70.584961 200.573486 70.131104 Q 200.184082 69.677246 199.453613 69.677246 Q 198.739258 69.677246 198.277344 70.149902 Q 197.815430 70.622559 197.772461 71.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 205.014160 74.242676 L 205.014160 77.288086 L 204.020508 77.288086 L 204.020508 68.984375 L 205.014160 68.984375 L 205.014160 69.752441 Q 205.261230 69.306641 205.672119 69.072998 Q 206.083008 68.839355 206.620117 68.839355 Q 207.710449 68.839355 208.330811 69.682617 Q 208.951172 70.525879 208.951172 72.019043 Q 208.951172 73.485352 208.328125 74.320557 Q 207.705078 75.155762 206.620117 75.155762 Q 206.072266 75.155762 205.661377 74.922119 Q 205.250488 74.688477 205.014160 74.242676 Z M 207.914551 71.997559 Q 207.914551 70.848145 207.552002 70.262695 Q 207.189453 69.677246 206.475098 69.677246 Q 205.755371 69.677246 205.384766 70.265381 Q 205.014160 70.853516 205.014160 71.997559 Q 205.014160 73.136230 205.384766 73.727051 Q 205.755371 74.317871 206.475098 74.317871 Q 207.189453 74.317871 207.552002 73.732422 Q 207.914551 73.146973 207.914551 71.997559 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 216.015625 71.498047 L 216.015625 71.981445 L 211.734863 71.981445 L 211.734863 72.013672 Q 211.691895 73.243652 212.204834 73.780762 Q 212.717773 74.317871 213.652344 74.317871 Q 214.125000 74.317871 214.640625 74.167480 Q 215.156250 74.017090 215.741699 73.710938 L 215.741699 74.693848 Q 215.177734 74.924805 214.654053 75.040283 Q 214.130371 75.155762 213.641602 75.155762 Q 212.239746 75.155762 211.450195 74.315186 Q 210.660645 73.474609 210.660645 71.997559 Q 210.660645 70.558105 211.434082 69.698730 Q 212.207520 68.839355 213.496582 68.839355 Q 214.645996 68.839355 215.309326 69.618164 Q 215.972656 70.396973 216.015625 71.498047 Z M 215.027344 71.208008 Q 214.962891 70.584961 214.573486 70.131104 Q 214.184082 69.677246 213.453613 69.677246 Q 212.739258 69.677246 212.277344 70.149902 Q 211.815430 70.622559 211.772461 71.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 222.645020 71.272461 L 222.645020 75.000000 L 221.651367 75.000000 L 221.651367 71.272461 Q 221.651367 70.461426 221.366699 70.080078 Q 221.082031 69.698730 220.475098 69.698730 Q 219.782227 69.698730 219.408936 70.190186 Q 219.035645 70.681641 219.035645 71.600098 L 219.035645 75.000000 L 218.047363 75.000000 L 218.047363 68.984375 L 219.035645 68.984375 L 219.035645 69.886719 Q 219.298828 69.371094 219.750000 69.105225 Q 220.201172 68.839355 220.818848 68.839355 Q 221.737305 68.839355 222.191162 69.443604 Q 222.645020 70.047852 222.645020 71.272461 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 228.608398 69.752441 L 228.608398 66.642578 L 229.596680 66.642578 L 229.596680 75.000000 L 228.608398 75.000000 L 228.608398 74.242676 Q 228.361328 74.688477 227.950439 74.922119 Q 227.539551 75.155762 227.002441 75.155762 Q 225.912109 75.155762 225.286377 74.309814 Q 224.660645 73.463867 224.660645 71.976074 Q 224.660645 70.509766 225.289062 69.674561 Q 225.917480 68.839355 227.002441 68.839355 Q 227.544922 68.839355 227.958496 69.072998 Q 228.372070 69.306641 228.608398 69.752441 Z M 225.702637 71.997559 Q 225.702637 73.146973 226.067871 73.732422 Q 226.433105 74.317871 227.147461 74.317871 Q 227.861816 74.317871 228.235107 73.727051 Q 228.608398 73.136230 228.608398 71.997559 Q 228.608398 70.853516 228.235107 70.265381 Q 227.861816 69.677246 227.147461 69.677246 Q 226.433105 69.677246 226.067871 70.262695 Q 225.702637 70.848145 225.702637 71.997559 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 237.015625 71.498047 L 237.015625 71.981445 L 232.734863 71.981445 L 232.734863 72.013672 Q 232.691895 73.243652 233.204834 73.780762 Q 233.717773 74.317871 234.652344 74.317871 Q 235.125000 74.317871 235.640625 74.167480 Q 236.156250 74.017090 236.741699 73.710938 L 236.741699 74.693848 Q 236.177734 74.924805 235.654053 75.040283 Q 235.130371 75.155762 234.641602 75.155762 Q 233.239746 75.155762 232.450195 74.315186 Q 231.660645 73.474609 231.660645 71.997559 Q 231.660645 70.558105 232.434082 69.698730 Q 233.207520 68.839355 234.496582 68.839355 Q 235.645996 68.839355 236.309326 69.618164 Q 236.972656 70.396973 237.015625 71.498047 Z M 236.027344 71.208008 Q 235.962891 70.584961 235.573486 70.131104 Q 235.184082 69.677246 234.453613 69.677246 Q 233.739258 69.677246 233.277344 70.149902 Q 232.815430 70.622559 232.772461 71.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 243.645020 71.272461 L 243.645020 75.000000 L 242.651367 75.000000 L 242.651367 71.272461 Q 242.651367 70.461426 242.366699 70.080078 Q 242.082031 69.698730 241.475098 69.698730 Q 240.782227 69.698730 240.408936 70.190186 Q 240.035645 70.681641 240.035645 71.600098 L 240.035645 75.000000 L 239.047363 75.000000 L 239.047363 68.984375 L 240.035645 68.984375 L 240.035645 69.886719 Q 240.298828 69.371094 240.750000 69.105225 Q 241.201172 68.839355 241.818848 68.839355 Q 242.737305 68.839355 243.191162 69.443604 Q 243.645020 70.047852 243.645020 71.272461 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 248.297852 67.276367 L 248.297852 68.984375 L 250.542969 68.984375 L 250.542969 69.752441 L 248.297852 69.752441 L 248.297852 73.018066 Q 248.297852 73.684082 248.550293 73.947266 Q 248.802734 74.210449 249.431152 74.210449 L 250.542969 74.210449 L 250.542969 75.000000 L 249.334473 75.000000 Q 248.222656 75.000000 247.766113 74.554199 Q 247.309570 74.108398 247.309570 73.018066 L 247.309570 69.752441 L 245.703613 69.752441 L 245.703613 68.984375 L 247.309570 68.984375 L 247.309570 67.276367 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 260.981934 70.955566 L 260.981934 74.108398 L 262.265625 74.108398 Q 263.210938 74.108398 263.613770 73.778076 Q 264.016602 73.447754 264.016602 72.690430 Q 264.016602 71.691406 263.592285 71.323486 Q 263.167969 70.955566 262.265625 70.955566 Z M 260.981934 67.872559 L 260.981934 70.074707 L 262.244141 70.074707 Q 263.028320 70.074707 263.380127 69.773926 Q 263.731934 69.473145 263.731934 69.016602 Q 263.731934 68.409668 263.385498 68.141113 Q 263.039062 67.872559 262.244141 67.872559 Z M 259.891602 66.980957 L 262.265625 66.980957 Q 263.495605 66.980957 264.161621 67.512695 Q 264.827637 68.044434 264.827637 69.016602 Q 264.827637 69.537598 264.475830 69.961914 Q 264.124023 70.386230 263.420410 70.493652 Q 264.209961 70.611816 264.658447 71.167725 Q 265.106934 71.723633 265.106934 72.797852 Q 265.106934 73.888184 264.392578 74.444092 Q 263.678223 75.000000 262.265625 75.000000 L 259.891602 75.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 269.861816 72.824707 Q 269.861816 73.490723 270.106201 73.829102 Q 270.350586 74.167480 270.828613 74.167480 L 271.983398 74.167480 L 271.983398 75.000000 L 270.731934 75.000000 Q 269.845703 75.000000 269.359619 74.433350 Q 268.873535 73.866699 268.873535 72.824707 L 268.873535 67.383789 L 267.289062 67.383789 L 267.289062 66.610352 L 269.861816 66.610352 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 276.308594 69.677246 Q 275.556641 69.677246 275.169922 70.262695 Q 274.783203 70.848145 274.783203 71.997559 Q 274.783203 73.141602 275.169922 73.729736 Q 275.556641 74.317871 276.308594 74.317871 Q 277.065918 74.317871 277.452637 73.729736 Q 277.839355 73.141602 277.839355 71.997559 Q 277.839355 70.848145 277.452637 70.262695 Q 277.065918 69.677246 276.308594 69.677246 Z M 276.308594 68.839355 Q 277.560059 68.839355 278.223389 69.650391 Q 278.886719 70.461426 278.886719 71.997559 Q 278.886719 73.539062 278.226074 74.347412 Q 277.565430 75.155762 276.308594 75.155762 Q 275.057129 75.155762 274.396484 74.347412 Q 273.735840 73.539062 273.735840 71.997559 Q 273.735840 70.461426 274.396484 69.650391 Q 275.057129 68.839355 276.308594 68.839355 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 285.698730 74.693848 Q 285.301270 74.924805 284.879639 75.040283 Q 284.458008 75.155762 284.017578 75.155762 Q 282.621094 75.155762 281.834229 74.317871 Q 281.047363 73.479980 281.047363 71.997559 Q 281.047363 70.515137 281.834229 69.677246 Q 282.621094 68.839355 284.017578 68.839355 Q 284.452637 68.839355 284.866211 68.952148 Q 285.279785 69.064941 285.698730 69.301270 L 285.698730 70.337891 Q 285.306641 69.988770 284.911865 69.833008 Q 284.517090 69.677246 284.017578 69.677246 Q 283.088379 69.677246 282.588867 70.278809 Q 282.089355 70.880371 282.089355 71.997559 Q 282.089355 73.109375 282.591553 73.713623 Q 283.093750 74.317871 284.017578 74.317871 Q 284.533203 74.317871 284.941406 74.159424 Q 285.349609 74.000977 285.698730 73.667969 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 288.267578 66.642578 L 289.288086 66.642578 L 289.288086 71.481934 L 291.882324 68.984375 L 293.085449 68.984375 L 290.716797 71.250977 L 293.456055 75.000000 L 292.247559 75.000000 L 290.023926 71.895508 L 289.288086 72.588379 L 289.288086 75.000000 L 288.267578 75.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 450.878906 78.319336 L 450.878906 64.300781 L 451.738281 64.300781 L 451.738281 78.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 6.892578 59.335938 L 6.892578 58.412109 L 13.729980 58.412109 L 13.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 13.892578 59.335938 L 13.892578 58.412109 L 20.729980 58.412109 L 20.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 20.892578 59.335938 L 20.892578 58.412109 L 27.729980 58.412109 L 27.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 27.892578 59.335938 L 27.892578 58.412109 L 34.729980 58.412109 L 34.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 34.892578 59.335938 L 34.892578 58.412109 L 41.729980 58.412109 L 41.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 41.892578 59.335938 L 41.892578 58.412109 L 48.729980 58.412109 L 48.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 48.892578 59.335938 L 48.892578 58.412109 L 55.729980 58.412109 L 55.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 55.892578 59.335938 L 55.892578 58.412109 L 62.729980 58.412109 L 62.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 62.892578 59.335938 L 62.892578 58.412109 L 69.729980 58.412109 L 69.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 69.892578 59.335938 L 69.892578 58.412109 L 76.729980 58.412109 L 76.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 76.892578 59.335938 L 76.892578 58.412109 L 83.729980 58.412109 L 83.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 83.892578 59.335938 L 83.892578 58.412109 L 90.729980 58.412109 L 90.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 90.892578 59.335938 L 90.892578 58.412109 L 97.729980 58.412109 L 97.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 97.892578 59.335938 L 97.892578 58.412109 L 104.729980 58.412109 L 104.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 104.892578 59.335938 L 104.892578 58.412109 L 111.729980 58.412109 L 111.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 111.892578 59.335938 L 111.892578 58.412109 L 114.878906 58.412109 L 114.878906 51.300781 L 115.738281 51.300781 L 115.738281 58.412109 L 118.729980 58.412109 L 118.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 118.892578 59.335938 L 118.892578 58.412109 L 125.729980 58.412109 L 125.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 125.892578 59.335938 L 125.892578 58.412109 L 132.729980 58.412109 L 132.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 132.892578 59.335938 L 132.892578 58.412109 L 139.729980 58.412109 L 139.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 139.892578 59.335938 L 139.892578 58.412109 L 146.729980 58.412109 L 146.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 146.892578 59.335938 L 146.892578 58.412109 L 153.729980 58.412109 L 153.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 153.892578 59.335938 L 153.892578 58.412109 L 160.729980 58.412109 L 160.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 160.892578 59.335938 L 160.892578 58.412109 L 167.729980 58.412109 L 167.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 167.892578 59.335938 L 167.892578 58.412109 L 174.729980 58.412109 L 174.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 174.892578 59.335938 L 174.892578 58.412109 L 181.729980 58.412109 L 181.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 181.892578 59.335938 L 181.892578 58.412109 L 188.729980 58.412109 L 188.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 188.892578 59.335938 L 188.892578 58.412109 L 195.729980 58.412109 L 195.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 195.892578 59.335938 L 195.892578 58.412109 L 202.729980 58.412109 L 202.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 202.892578 59.335938 L 202.892578 58.412109 L 209.729980 58.412109 L 209.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 209.892578 59.335938 L 209.892578 58.412109 L 216.729980 58.412109 L 216.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 216.892578 59.335938 L 216.892578 58.412109 L 223.729980 58.412109 L 223.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 223.892578 59.335938 L 223.892578 58.412109 L 226.878906 58.412109 L 226.878906 51.300781 L 227.738281 51.300781 L 227.738281 58.412109 L 230.729980 58.412109 L 230.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 230.892578 59.335938 L 230.892578 58.412109 L 237.729980 58.412109 L 237.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 237.892578 59.335938 L 237.892578 58.412109 L 244.729980 58.412109 L 244.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 244.892578 59.335938 L 244.892578 58.412109 L 251.729980 58.412109 L 251.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 251.892578 59.335938 L 251.892578 58.412109 L 258.729980 58.412109 L 258.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 258.892578 59.335938 L 258.892578 58.412109 L 265.729980 58.412109 L 265.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 265.892578 59.335938 L 265.892578 58.412109 L 272.729980 58.412109 L 272.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 272.892578 59.335938 L 272.892578 58.412109 L 279.729980 58.412109 L 279.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 279.892578 59.335938 L 279.892578 58.412109 L 286.729980 58.412109 L 286.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 286.892578 59.335938 L 286.892578 58.412109 L 293.729980 58.412109 L 293.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 293.892578 59.335938 L 293.892578 58.412109 L 300.729980 58.412109 L 300.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 300.892578 59.335938 L 300.892578 58.412109 L 307.729980 58.412109 L 307.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 307.892578 59.335938 L 307.892578 58.412109 L 314.729980 58.412109 L 314.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 314.892578 59.335938 L 314.892578 58.412109 L 321.729980 58.412109 L 321.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 321.892578 59.335938 L 321.892578 58.412109 L 328.729980 58.412109 L 328.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 328.892578 59.335938 L 328.892578 58.412109 L 335.729980 58.412109 L 335.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 335.892578 59.335938 L 335.892578 58.412109 L 342.729980 58.412109 L 342.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 342.892578 59.335938 L 342.892578 58.412109 L 349.729980 58.412109 L 349.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 349.892578 59.335938 L 349.892578 58.412109 L 356.729980 58.412109 L 356.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 356.892578 59.335938 L 356.892578 58.412109 L 363.729980 58.412109 L 363.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 363.892578 59.335938 L 363.892578 58.412109 L 370.729980 58.412109 L 370.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 370.892578 59.335938 L 370.892578 58.412109 L 377.729980 58.412109 L 377.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 377.892578 59.335938 L 377.892578 58.412109 L 384.729980 58.412109 L 384.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 384.892578 59.335938 L 384.892578 58.412109 L 391.729980 58.412109 L 391.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 391.892578 59.335938 L 391.892578 58.412109 L 398.729980 58.412109 L 398.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 398.892578 59.335938 L 398.892578 58.412109 L 405.729980 58.412109 L 405.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 405.892578 59.335938 L 405.892578 58.412109 L 412.729980 58.412109 L 412.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 412.892578 59.335938 L 412.892578 58.412109 L 419.729980 58.412109 L 419.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 419.892578 59.335938 L 419.892578 58.412109 L 426.729980 58.412109 L 426.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 426.892578 59.335938 L 426.892578 58.412109 L 433.729980 58.412109 L 433.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 433.892578 59.335938 L 433.892578 58.412109 L 440.729980 58.412109 L 440.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 440.892578 59.335938 L 440.892578 58.412109 L 447.729980 58.412109 L 447.729980 59.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 450.878906 65.319336 L 450.878906 59.335938 L 447.892578 59.335938 L 447.892578 58.412109 L 450.878906 58.412109 L 450.878906 51.300781 L 451.738281 51.300781 L 451.738281 65.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 42.252441 40.980957 L 48.370117 40.980957 L 48.370117 41.894043 L 45.861816 41.894043 L 45.861816 49.000000 L 44.771484 49.000000 L 44.771484 41.894043 L 42.252441 41.894043 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 53.608398 47.066406 Q 53.361328 47.694824 52.979980 48.720703 Q 52.448242 50.138672 52.265625 50.450195 Q 52.018555 50.869141 51.647949 51.078613 Q 51.277344 51.288086 50.783203 51.288086 L 49.988281 51.288086 L 49.988281 50.460938 L 50.573730 50.460938 Q 51.008789 50.460938 51.255859 50.208496 Q 51.502930 49.956055 51.884277 48.903320 L 49.558594 42.984375 L 50.605957 42.984375 L 52.389160 47.689453 L 54.145508 42.984375 L 55.192871 42.984375 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 58.014160 48.242676 L 58.014160 51.288086 L 57.020508 51.288086 L 57.020508 42.984375 L 58.014160 42.984375 L 58.014160 43.752441 Q 58.261230 43.306641 58.672119 43.072998 Q 59.083008 42.839355 59.620117 42.839355 Q 60.710449 42.839355 61.330811 43.682617 Q 61.951172 44.525879 61.951172 46.019043 Q 61.951172 47.485352 61.328125 48.320557 Q 60.705078 49.155762 59.620117 49.155762 Q 59.072266 49.155762 58.661377 48.922119 Q 58.250488 48.688477 58.014160 48.242676 Z M 60.914551 45.997559 Q 60.914551 44.848145 60.552002 44.262695 Q 60.189453 43.677246 59.475098 43.677246 Q 58.755371 43.677246 58.384766 44.265381 Q 58.014160 44.853516 58.014160 45.997559 Q 58.014160 47.136230 58.384766 47.727051 Q 58.755371 48.317871 59.475098 48.317871 Q 60.189453 48.317871 60.552002 47.732422 Q 60.914551 47.146973 60.914551 45.997559 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 69.015625 45.498047 L 69.015625 45.981445 L 64.734863 45.981445 L 64.734863 46.013672 Q 64.691895 47.243652 65.204834 47.780762 Q 65.717773 48.317871 66.652344 48.317871 Q 67.125000 48.317871 67.640625 48.167480 Q 68.156250 48.017090 68.741699 47.710938 L 68.741699 48.693848 Q 68.177734 48.924805 67.654053 49.040283 Q 67.130371 49.155762 66.641602 49.155762 Q 65.239746 49.155762 64.450195 48.315186 Q 63.660645 47.474609 63.660645 45.997559 Q 63.660645 44.558105 64.434082 43.698730 Q 65.207520 42.839355 66.496582 42.839355 Q 67.645996 42.839355 68.309326 43.618164 Q 68.972656 44.396973 69.015625 45.498047 Z M 68.027344 45.208008 Q 67.962891 44.584961 67.573486 44.131104 Q 67.184082 43.677246 66.453613 43.677246 Q 65.739258 43.677246 65.277344 44.149902 Q 64.815430 44.622559 64.772461 45.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 114.878906 52.319336 L 114.878906 38.300781 L 115.738281 38.300781 L 115.738281 52.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 159.763184 48.715332 Q 159.349609 48.935547 158.914551 49.045654 Q 158.479492 49.155762 157.990723 49.155762 Q 156.449219 49.155762 155.597900 48.065430 Q 154.746582 46.975098 154.746582 44.998535 Q 154.746582 43.032715 155.603271 41.934326 Q 156.459961 40.835938 157.990723 40.835938 Q 158.479492 40.835938 158.914551 40.946045 Q 159.349609 41.056152 159.763184 41.276367 L 159.763184 42.388184 Q 159.365723 42.060547 158.909180 41.888672 Q 158.452637 41.716797 157.990723 41.716797 Q 156.932617 41.716797 156.406250 42.533203 Q 155.879883 43.349609 155.879883 44.998535 Q 155.879883 46.642090 156.406250 47.458496 Q 156.932617 48.274902 157.990723 48.274902 Q 158.463379 48.274902 158.917236 48.103027 Q 159.371094 47.931152 159.763184 47.603516 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 164.308594 43.677246 Q 163.556641 43.677246 163.169922 44.262695 Q 162.783203 44.848145 162.783203 45.997559 Q 162.783203 47.141602 163.169922 47.729736 Q 163.556641 48.317871 164.308594 48.317871 Q 165.065918 48.317871 165.452637 47.729736 Q 165.839355 47.141602 165.839355 45.997559 Q 165.839355 44.848145 165.452637 44.262695 Q 165.065918 43.677246 164.308594 43.677246 Z M 164.308594 42.839355 Q 165.560059 42.839355 166.223389 43.650391 Q 166.886719 44.461426 166.886719 45.997559 Q 166.886719 47.539062 166.226074 48.347412 Q 165.565430 49.155762 164.308594 49.155762 Q 163.057129 49.155762 162.396484 48.347412 Q 161.735840 47.539062 161.735840 45.997559 Q 161.735840 44.461426 162.396484 43.650391 Q 163.057129 42.839355 164.308594 42.839355 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 172.608398 43.752441 L 172.608398 40.642578 L 173.596680 40.642578 L 173.596680 49.000000 L 172.608398 49.000000 L 172.608398 48.242676 Q 172.361328 48.688477 171.950439 48.922119 Q 171.539551 49.155762 171.002441 49.155762 Q 169.912109 49.155762 169.286377 48.309814 Q 168.660645 47.463867 168.660645 45.976074 Q 168.660645 44.509766 169.289062 43.674561 Q 169.917480 42.839355 171.002441 42.839355 Q 171.544922 42.839355 171.958496 43.072998 Q 172.372070 43.306641 172.608398 43.752441 Z M 169.702637 45.997559 Q 169.702637 47.146973 170.067871 47.732422 Q 170.433105 48.317871 171.147461 48.317871 Q 171.861816 48.317871 172.235107 47.727051 Q 172.608398 47.136230 172.608398 45.997559 Q 172.608398 44.853516 172.235107 44.265381 Q 171.861816 43.677246 171.147461 43.677246 Q 170.433105 43.677246 170.067871 44.262695 Q 169.702637 44.848145 169.702637 45.997559 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 181.015625 45.498047 L 181.015625 45.981445 L 176.734863 45.981445 L 176.734863 46.013672 Q 176.691895 47.243652 177.204834 47.780762 Q 177.717773 48.317871 178.652344 48.317871 Q 179.125000 48.317871 179.640625 48.167480 Q 180.156250 48.017090 180.741699 47.710938 L 180.741699 48.693848 Q 180.177734 48.924805 179.654053 49.040283 Q 179.130371 49.155762 178.641602 49.155762 Q 177.239746 49.155762 176.450195 48.315186 Q 175.660645 47.474609 175.660645 45.997559 Q 175.660645 44.558105 176.434082 43.698730 Q 177.207520 42.839355 178.496582 42.839355 Q 179.645996 42.839355 180.309326 43.618164 Q 180.972656 44.396973 181.015625 45.498047 Z M 180.027344 45.208008 Q 179.962891 44.584961 179.573486 44.131104 Q 179.184082 43.677246 178.453613 43.677246 Q 177.739258 43.677246 177.277344 44.149902 Q 176.815430 44.622559 176.772461 45.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 226.878906 52.319336 L 226.878906 38.300781 L 227.738281 38.300781 L 227.738281 52.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 313.763184 48.715332 Q 313.349609 48.935547 312.914551 49.045654 Q 312.479492 49.155762 311.990723 49.155762 Q 310.449219 49.155762 309.597900 48.065430 Q 308.746582 46.975098 308.746582 44.998535 Q 308.746582 43.032715 309.603271 41.934326 Q 310.459961 40.835938 311.990723 40.835938 Q 312.479492 40.835938 312.914551 40.946045 Q 313.349609 41.056152 313.763184 41.276367 L 313.763184 42.388184 Q 313.365723 42.060547 312.909180 41.888672 Q 312.452637 41.716797 311.990723 41.716797 Q 310.932617 41.716797 310.406250 42.533203 Q 309.879883 43.349609 309.879883 44.998535 Q 309.879883 46.642090 310.406250 47.458496 Q 310.932617 48.274902 311.990723 48.274902 Q 312.463379 48.274902 312.917236 48.103027 Q 313.371094 47.931152 313.763184 47.603516 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 320.645020 45.272461 L 320.645020 49.000000 L 319.651367 49.000000 L 319.651367 45.272461 Q 319.651367 44.461426 319.366699 44.080078 Q 319.082031 43.698730 318.475098 43.698730 Q 317.782227 43.698730 317.408936 44.190186 Q 317.035645 44.681641 317.035645 45.600098 L 317.035645 49.000000 L 316.047363 49.000000 L 316.047363 40.642578 L 317.035645 40.642578 L 317.035645 43.886719 Q 317.298828 43.371094 317.750000 43.105225 Q 318.201172 42.839355 318.818848 42.839355 Q 319.737305 42.839355 320.191162 43.443604 Q 320.645020 44.047852 320.645020 45.272461 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 328.015625 45.498047 L 328.015625 45.981445 L 323.734863 45.981445 L 323.734863 46.013672 Q 323.691895 47.243652 324.204834 47.780762 Q 324.717773 48.317871 325.652344 48.317871 Q 326.125000 48.317871 326.640625 48.167480 Q 327.156250 48.017090 327.741699 47.710938 L 327.741699 48.693848 Q 327.177734 48.924805 326.654053 49.040283 Q 326.130371 49.155762 325.641602 49.155762 Q 324.239746 49.155762 323.450195 48.315186 Q 322.660645 47.474609 322.660645 45.997559 Q 322.660645 44.558105 323.434082 43.698730 Q 324.207520 42.839355 325.496582 42.839355 Q 326.645996 42.839355 327.309326 43.618164 Q 327.972656 44.396973 328.015625 45.498047 Z M 327.027344 45.208008 Q 326.962891 44.584961 326.573486 44.131104 Q 326.184082 43.677246 325.453613 43.677246 Q 324.739258 43.677246 324.277344 44.149902 Q 323.815430 44.622559 323.772461 45.213379 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 334.698730 48.693848 Q 334.301270 48.924805 333.879639 49.040283 Q 333.458008 49.155762 333.017578 49.155762 Q 331.621094 49.155762 330.834229 48.317871 Q 330.047363 47.479980 330.047363 45.997559 Q 330.047363 44.515137 330.834229 43.677246 Q 331.621094 42.839355 333.017578 42.839355 Q 333.452637 42.839355 333.866211 42.952148 Q 334.279785 43.064941 334.698730 43.301270 L 334.698730 44.337891 Q 334.306641 43.988770 333.911865 43.833008 Q 333.517090 43.677246 333.017578 43.677246 Q 332.088379 43.677246 331.588867 44.278809 Q 331.089355 44.880371 331.089355 45.997559 Q 331.089355 47.109375 331.591553 47.713623 Q 332.093750 48.317871 333.017578 48.317871 Q 333.533203 48.317871 333.941406 48.159424 Q 334.349609 48.000977 334.698730 47.667969 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 337.267578 40.642578 L 338.288086 40.642578 L 338.288086 45.481934 L 340.882324 42.984375 L 342.085449 42.984375 L 339.716797 45.250977 L 342.456055 49.000000 L 341.247559 49.000000 L 339.023926 45.895508 L 338.288086 46.588379 L 338.288086 49.000000 L 337.267578 49.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 348.226074 43.193848 L 348.226074 44.160645 Q 347.801758 43.913574 347.372070 43.790039 Q 346.942383 43.666504 346.496582 43.666504 Q 345.825195 43.666504 345.494873 43.884033 Q 345.164551 44.101562 345.164551 44.547363 Q 345.164551 44.950195 345.411621 45.148926 Q 345.658691 45.347656 346.641602 45.535645 L 347.039062 45.610840 Q 347.774902 45.750488 348.153564 46.169434 Q 348.532227 46.588379 348.532227 47.259766 Q 348.532227 48.151367 347.898438 48.653564 Q 347.264648 49.155762 346.136719 49.155762 Q 345.690918 49.155762 345.202148 49.061768 Q 344.713379 48.967773 344.144043 48.779785 L 344.144043 47.759277 Q 344.697266 48.043945 345.202148 48.186279 Q 345.707031 48.328613 346.158203 48.328613 Q 346.813477 48.328613 347.173340 48.062744 Q 347.533203 47.796875 347.533203 47.318848 Q 347.533203 46.631348 346.217285 46.368164 L 346.174316 46.357422 L 345.803711 46.282227 Q 344.949707 46.115723 344.557617 45.720947 Q 344.165527 45.326172 344.165527 44.644043 Q 344.165527 43.779297 344.750977 43.309326 Q 345.336426 42.839355 346.421387 42.839355 Q 346.904785 42.839355 347.350586 42.927979 Q 347.796387 43.016602 348.226074 43.193848 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 351.047363 46.722656 L 351.047363 42.995117 L 352.035645 42.995117 L 352.035645 46.722656 Q 352.035645 47.533691 352.322998 47.915039 Q 352.610352 48.296387 353.211914 48.296387 Q 353.910156 48.296387 354.280762 47.804932 Q 354.651367 47.313477 354.651367 46.395020 L 354.651367 42.995117 L 355.645020 42.995117 L 355.645020 49.000000 L 354.651367 49.000000 L 354.651367 48.097656 Q 354.388184 48.618652 353.934326 48.887207 Q 353.480469 49.155762 352.873535 49.155762 Q 351.949707 49.155762 351.498535 48.551514 Q 351.047363 47.947266 351.047363 46.722656 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 360.630859 43.596680 Q 360.813477 43.209961 361.095459 43.024658 Q 361.377441 42.839355 361.774902 42.839355 Q 362.500000 42.839355 362.798096 43.400635 Q 363.096191 43.961914 363.096191 45.514160 L 363.096191 49.000000 L 362.193848 49.000000 L 362.193848 45.557129 Q 362.193848 44.284180 362.051514 43.975342 Q 361.909180 43.666504 361.533203 43.666504 Q 361.103516 43.666504 360.945068 43.996826 Q 360.786621 44.327148 360.786621 45.557129 L 360.786621 49.000000 L 359.884277 49.000000 L 359.884277 45.557129 Q 359.884277 44.268066 359.731201 43.967285 Q 359.578125 43.666504 359.180664 43.666504 Q 358.788574 43.666504 358.635498 43.996826 Q 358.482422 44.327148 358.482422 45.557129 L 358.482422 49.000000 L 357.585449 49.000000 L 357.585449 42.984375 L 358.482422 42.984375 L 358.482422 43.500000 Q 358.659668 43.177734 358.925537 43.008545 Q 359.191406 42.839355 359.529785 42.839355 Q 359.937988 42.839355 360.209229 43.027344 Q 360.480469 43.215332 360.630859 43.596680 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 450.878906 52.319336 L 450.878906 38.300781 L 451.738281 38.300781 L 451.738281 52.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 6.892578 33.335938 L 6.892578 32.412109 L 13.729980 32.412109 L 13.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 13.892578 33.335938 L 13.892578 32.412109 L 16.878906 32.412109 L 16.878906 25.300781 L 17.738281 25.300781 L 17.738281 32.412109 L 20.729980 32.412109 L 20.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 20.892578 33.335938 L 20.892578 32.412109 L 27.729980 32.412109 L 27.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 27.892578 33.335938 L 27.892578 32.412109 L 30.878906 32.412109 L 30.878906 25.300781 L 31.738281 25.300781 L 31.738281 32.412109 L 34.729980 32.412109 L 34.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 34.892578 33.335938 L 34.892578 32.412109 L 41.729980 32.412109 L 41.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 41.892578 33.335938 L 41.892578 32.412109 L 44.878906 32.412109 L 44.878906 25.300781 L 45.738281 25.300781 L 45.738281 32.412109 L 48.729980 32.412109 L 48.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 48.892578 33.335938 L 48.892578 32.412109 L 55.729980 32.412109 L 55.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 55.892578 33.335938 L 55.892578 32.412109 L 58.878906 32.412109 L 58.878906 25.300781 L 59.738281 25.300781 L 59.738281 32.412109 L 62.729980 32.412109 L 62.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 62.892578 33.335938 L 62.892578 32.412109 L 69.729980 32.412109 L 69.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 69.892578 33.335938 L 69.892578 32.412109 L 72.878906 32.412109 L 72.878906 25.300781 L 73.738281 25.300781 L 73.738281 32.412109 L 76.729980 32.412109 L 76.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 76.892578 33.335938 L 76.892578 32.412109 L 83.729980 32.412109 L 83.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 83.892578 33.335938 L 83.892578 32.412109 L 86.878906 32.412109 L 86.878906 25.300781 L 87.738281 25.300781 L 87.738281 32.412109 L 90.729980 32.412109 L 90.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 90.892578 33.335938 L 90.892578 32.412109 L 97.729980 32.412109 L 97.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 97.892578 33.335938 L 97.892578 32.412109 L 100.878906 32.412109 L 100.878906 25.300781 L 101.738281 25.300781 L 101.738281 32.412109 L 104.729980 32.412109 L 104.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 104.892578 33.335938 L 104.892578 32.412109 L 111.729980 32.412109 L 111.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 115.738281 33.335938 L 115.738281 39.319336 L 114.878906 39.319336 L 114.878906 33.335938 L 111.892578 33.335938 L 111.892578 32.412109 L 114.878906 32.412109 L 114.878906 25.300781 L 115.738281 25.300781 L 115.738281 32.412109 L 118.729980 32.412109 L 118.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 118.892578 33.335938 L 118.892578 32.412109 L 125.729980 32.412109 L 125.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 125.892578 33.335938 L 125.892578 32.412109 L 128.878906 32.412109 L 128.878906 25.300781 L 129.738281 25.300781 L 129.738281 32.412109 L 132.729980 32.412109 L 132.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 132.892578 33.335938 L 132.892578 32.412109 L 139.729980 32.412109 L 139.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 139.892578 33.335938 L 139.892578 32.412109 L 142.878906 32.412109 L 142.878906 25.300781 L 143.738281 25.300781 L 143.738281 32.412109 L 146.729980 32.412109 L 146.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 146.892578 33.335938 L 146.892578 32.412109 L 153.729980 32.412109 L 153.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 153.892578 33.335938 L 153.892578 32.412109 L 156.878906 32.412109 L 156.878906 25.300781 L 157.738281 25.300781 L 157.738281 32.412109 L 160.729980 32.412109 L 160.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 160.892578 33.335938 L 160.892578 32.412109 L 167.729980 32.412109 L 167.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 167.892578 33.335938 L 167.892578 32.412109 L 170.878906 32.412109 L 170.878906 25.300781 L 171.738281 25.300781 L 171.738281 32.412109 L 174.729980 32.412109 L 174.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 174.892578 33.335938 L 174.892578 32.412109 L 181.729980 32.412109 L 181.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 181.892578 33.335938 L 181.892578 32.412109 L 184.878906 32.412109 L 184.878906 25.300781 L 185.738281 25.300781 L 185.738281 32.412109 L 188.729980 32.412109 L 188.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 188.892578 33.335938 L 188.892578 32.412109 L 195.729980 32.412109 L 195.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 195.892578 33.335938 L 195.892578 32.412109 L 198.878906 32.412109 L 198.878906 25.300781 L 199.738281 25.300781 L 199.738281 32.412109 L 202.729980 32.412109 L 202.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 202.892578 33.335938 L 202.892578 32.412109 L 209.729980 32.412109 L 209.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 209.892578 33.335938 L 209.892578 32.412109 L 212.878906 32.412109 L 212.878906 25.300781 L 213.738281 25.300781 L 213.738281 32.412109 L 216.729980 32.412109 L 216.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 216.892578 33.335938 L 216.892578 32.412109 L 223.729980 32.412109 L 223.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 227.738281 33.335938 L 227.738281 39.319336 L 226.878906 39.319336 L 226.878906 33.335938 L 223.892578 33.335938 L 223.892578 32.412109 L 226.878906 32.412109 L 226.878906 25.300781 L 227.738281 25.300781 L 227.738281 32.412109 L 230.729980 32.412109 L 230.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 230.892578 33.335938 L 230.892578 32.412109 L 237.729980 32.412109 L 237.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 237.892578 33.335938 L 237.892578 32.412109 L 240.878906 32.412109 L 240.878906 25.300781 L 241.738281 25.300781 L 241.738281 32.412109 L 244.729980 32.412109 L 244.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 244.892578 33.335938 L 244.892578 32.412109 L 251.729980 32.412109 L 251.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 251.892578 33.335938 L 251.892578 32.412109 L 254.878906 32.412109 L 254.878906 25.300781 L 255.738281 25.300781 L 255.738281 32.412109 L 258.729980 32.412109 L 258.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 258.892578 33.335938 L 258.892578 32.412109 L 265.729980 32.412109 L 265.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 265.892578 33.335938 L 265.892578 32.412109 L 268.878906 32.412109 L 268.878906 25.300781 L 269.738281 25.300781 L 269.738281 32.412109 L 272.729980 32.412109 L 272.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 272.892578 33.335938 L 272.892578 32.412109 L 279.729980 32.412109 L 279.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 279.892578 33.335938 L 279.892578 32.412109 L 282.878906 32.412109 L 282.878906 25.300781 L 283.738281 25.300781 L 283.738281 32.412109 L 286.729980 32.412109 L 286.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 286.892578 33.335938 L 286.892578 32.412109 L 293.729980 32.412109 L 293.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 293.892578 33.335938 L 293.892578 32.412109 L 296.878906 32.412109 L 296.878906 25.300781 L 297.738281 25.300781 L 297.738281 32.412109 L 300.729980 32.412109 L 300.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 300.892578 33.335938 L 300.892578 32.412109 L 307.729980 32.412109 L 307.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 307.892578 33.335938 L 307.892578 32.412109 L 310.878906 32.412109 L 310.878906 25.300781 L 311.738281 25.300781 L 311.738281 32.412109 L 314.729980 32.412109 L 314.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 314.892578 33.335938 L 314.892578 32.412109 L 321.729980 32.412109 L 321.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 321.892578 33.335938 L 321.892578 32.412109 L 324.878906 32.412109 L 324.878906 25.300781 L 325.738281 25.300781 L 325.738281 32.412109 L 328.729980 32.412109 L 328.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 328.892578 33.335938 L 328.892578 32.412109 L 335.729980 32.412109 L 335.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 335.892578 33.335938 L 335.892578 32.412109 L 338.878906 32.412109 L 338.878906 25.300781 L 339.738281 25.300781 L 339.738281 32.412109 L 342.729980 32.412109 L 342.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 342.892578 33.335938 L 342.892578 32.412109 L 349.729980 32.412109 L 349.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 349.892578 33.335938 L 349.892578 32.412109 L 352.878906 32.412109 L 352.878906 25.300781 L 353.738281 25.300781 L 353.738281 32.412109 L 356.729980 32.412109 L 356.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 356.892578 33.335938 L 356.892578 32.412109 L 363.729980 32.412109 L 363.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 363.892578 33.335938 L 363.892578 32.412109 L 366.878906 32.412109 L 366.878906 25.300781 L 367.738281 25.300781 L 367.738281 32.412109 L 370.729980 32.412109 L 370.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 370.892578 33.335938 L 370.892578 32.412109 L 377.729980 32.412109 L 377.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 377.892578 33.335938 L 377.892578 32.412109 L 380.878906 32.412109 L 380.878906 25.300781 L 381.738281 25.300781 L 381.738281 32.412109 L 384.729980 32.412109 L 384.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 384.892578 33.335938 L 384.892578 32.412109 L 391.729980 32.412109 L 391.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 391.892578 33.335938 L 391.892578 32.412109 L 394.878906 32.412109 L 394.878906 25.300781 L 395.738281 25.300781 L 395.738281 32.412109 L 398.729980 32.412109 L 398.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 398.892578 33.335938 L 398.892578 32.412109 L 405.729980 32.412109 L 405.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 405.892578 33.335938 L 405.892578 32.412109 L 408.878906 32.412109 L 408.878906 25.300781 L 409.738281 25.300781 L 409.738281 32.412109 L 412.729980 32.412109 L 412.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 412.892578 33.335938 L 412.892578 32.412109 L 419.729980 32.412109 L 419.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 419.892578 33.335938 L 419.892578 32.412109 L 422.878906 32.412109 L 422.878906 25.300781 L 423.738281 25.300781 L 423.738281 32.412109 L 426.729980 32.412109 L 426.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 426.892578 33.335938 L 426.892578 32.412109 L 433.729980 32.412109 L 433.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 433.892578 33.335938 L 433.892578 32.412109 L 436.878906 32.412109 L 436.878906 25.300781 L 437.738281 25.300781 L 437.738281 32.412109 L 440.729980 32.412109 L 440.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 440.892578 33.335938 L 440.892578 32.412109 L 447.729980 32.412109 L 447.729980 33.335938 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 450.878906 39.319336 L 450.878906 33.335938 L 447.892578 33.335938 L 447.892578 32.412109 L 450.878906 32.412109 L 450.878906 25.300781 L 451.738281 25.300781 L 451.738281 39.319336 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 10.308594 1.862793 Q 11.592285 1.862793 12.250244 2.910156 Q 12.908203 3.957520 12.908203 6.009277 Q 12.908203 8.061035 12.250244 9.108398 Q 11.592285 10.155762 10.308594 10.155762 Q 9.024902 10.155762 8.369629 9.108398 Q 7.714355 8.061035 7.714355 6.009277 Q 7.714355 3.957520 8.369629 2.910156 Q 9.024902 1.862793 10.308594 1.862793 Z M 10.308594 9.296387 Q 11.071289 9.296387 11.444580 8.485352 Q 11.817871 7.674316 11.817871 6.009277 Q 11.817871 5.123047 11.710449 4.408691 L 9.153809 8.410156 Q 9.556641 9.296387 10.308594 9.296387 Z M 10.308594 2.722168 Q 9.551270 2.722168 9.177979 3.533203 Q 8.804688 4.344238 8.804688 6.009277 Q 8.804688 6.766602 8.906738 7.427246 L 11.409668 3.436523 Q 11.001465 2.722168 10.308594 2.722168 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 10.308594 14.862793 Q 11.592285 14.862793 12.250244 15.910156 Q 12.908203 16.957520 12.908203 19.009277 Q 12.908203 21.061035 12.250244 22.108398 Q 11.592285 23.155762 10.308594 23.155762 Q 9.024902 23.155762 8.369629 22.108398 Q 7.714355 21.061035 7.714355 19.009277 Q 7.714355 16.957520 8.369629 15.910156 Q 9.024902 14.862793 10.308594 14.862793 Z M 10.308594 22.296387 Q 11.071289 22.296387 11.444580 21.485352 Q 11.817871 20.674316 11.817871 19.009277 Q 11.817871 18.123047 11.710449 17.408691 L 9.153809 21.410156 Q 9.556641 22.296387 10.308594 22.296387 Z M 10.308594 15.722168 Q 9.551270 15.722168 9.177979 16.533203 Q 8.804688 17.344238 8.804688 19.009277 Q 8.804688 19.766602 8.906738 20.427246 L 11.409668 16.436523 Q 11.001465 15.722168 10.308594 15.722168 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 22.450195 22.092285 L 24.136719 22.092285 L 24.136719 16.033691 L 22.117188 17.005859 L 22.117188 15.963867 L 24.125977 15.007812 L 25.210938 15.007812 L 25.210938 22.092285 L 26.875977 22.092285 L 26.875977 23.000000 L 22.450195 23.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 37.003418 22.086914 L 40.687988 22.086914 L 40.687988 23.000000 L 35.816406 23.000000 L 35.816406 22.086914 Q 36.820801 21.028809 37.572754 20.217773 Q 38.324707 19.406738 38.609375 19.073730 Q 39.146484 18.418457 39.334473 18.012939 Q 39.522461 17.607422 39.522461 17.183105 Q 39.522461 16.511719 39.127686 16.130371 Q 38.732910 15.749023 38.045410 15.749023 Q 37.556641 15.749023 37.019531 15.926270 Q 36.482422 16.103516 35.880859 16.463379 L 35.880859 15.367676 Q 36.434082 15.104492 36.968506 14.970215 Q 37.502930 14.835938 38.023926 14.835938 Q 39.200195 14.835938 39.917236 15.461670 Q 40.634277 16.087402 40.634277 17.102539 Q 40.634277 17.618164 40.395264 18.133789 Q 40.156250 18.649414 39.619141 19.272461 Q 39.318359 19.621582 38.746338 20.239258 Q 38.174316 20.856934 37.003418 22.086914 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 53.167969 18.708496 Q 53.957520 18.917969 54.376465 19.452393 Q 54.795410 19.986816 54.795410 20.787109 Q 54.795410 21.893555 54.051514 22.524658 Q 53.307617 23.155762 51.991699 23.155762 Q 51.438477 23.155762 50.863770 23.053711 Q 50.289062 22.951660 49.735840 22.758301 L 49.735840 21.678711 Q 50.283691 21.963379 50.815430 22.103027 Q 51.347168 22.242676 51.873535 22.242676 Q 52.765137 22.242676 53.243164 21.839844 Q 53.721191 21.437012 53.721191 20.679688 Q 53.721191 19.981445 53.243164 19.570557 Q 52.765137 19.159668 51.948730 19.159668 L 51.121582 19.159668 L 51.121582 18.268066 L 51.948730 18.268066 Q 52.695312 18.268066 53.114258 17.940430 Q 53.533203 17.612793 53.533203 17.027344 Q 53.533203 16.409668 53.143799 16.079346 Q 52.754395 15.749023 52.034668 15.749023 Q 51.556641 15.749023 51.046387 15.856445 Q 50.536133 15.963867 49.977539 16.178711 L 49.977539 15.179688 Q 50.627441 15.007812 51.135010 14.921875 Q 51.642578 14.835938 52.034668 14.835938 Q 53.205566 14.835938 53.906494 15.424072 Q 54.607422 16.012207 54.607422 16.984375 Q 54.607422 17.645020 54.239502 18.085449 Q 53.871582 18.525879 53.167969 18.708496 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 66.947754 15.969238 L 64.417969 20.207031 L 66.947754 20.207031 Z M 66.770508 14.980957 L 68.027344 14.980957 L 68.027344 20.207031 L 69.096191 20.207031 L 69.096191 21.087891 L 68.027344 21.087891 L 68.027344 23.000000 L 66.947754 23.000000 L 66.947754 21.087891 L 63.547852 21.087891 L 63.547852 20.062012 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 78.111816 14.980957 L 82.172363 14.980957 L 82.172363 15.894043 L 79.100098 15.894043 L 79.100098 17.865234 Q 79.331055 17.779297 79.564697 17.739014 Q 79.798340 17.698730 80.034668 17.698730 Q 81.280762 17.698730 82.011230 18.434570 Q 82.741699 19.170410 82.741699 20.427246 Q 82.741699 21.694824 81.976318 22.425293 Q 81.210938 23.155762 79.884277 23.155762 Q 79.245117 23.155762 78.716064 23.069824 Q 78.187012 22.983887 77.768066 22.812012 L 77.768066 21.710938 Q 78.262207 21.979492 78.761719 22.111084 Q 79.261230 22.242676 79.782227 22.242676 Q 80.679199 22.242676 81.165283 21.770020 Q 81.651367 21.297363 81.651367 20.427246 Q 81.651367 19.567871 81.149170 19.089844 Q 80.646973 18.611816 79.750000 18.611816 Q 79.314941 18.611816 78.901367 18.711182 Q 78.487793 18.810547 78.111816 19.009277 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 96.322754 15.158203 L 96.322754 16.157227 Q 95.984375 15.958496 95.603027 15.853760 Q 95.221680 15.749023 94.808105 15.749023 Q 93.776855 15.749023 93.245117 16.525146 Q 92.713379 17.301270 92.713379 18.810547 Q 92.971191 18.273438 93.427734 17.986084 Q 93.884277 17.698730 94.475098 17.698730 Q 95.635254 17.698730 96.271729 18.410400 Q 96.908203 19.122070 96.908203 20.427246 Q 96.908203 21.727051 96.252930 22.441406 Q 95.597656 23.155762 94.410645 23.155762 Q 93.014160 23.155762 92.364258 22.154053 Q 91.714355 21.152344 91.714355 18.998535 Q 91.714355 16.968262 92.495850 15.902100 Q 93.277344 14.835938 94.759766 14.835938 Q 95.157227 14.835938 95.554688 14.919189 Q 95.952148 15.002441 96.322754 15.158203 Z M 94.389160 18.547363 Q 93.696289 18.547363 93.298828 19.046875 Q 92.901367 19.546387 92.901367 20.427246 Q 92.901367 21.308105 93.298828 21.807617 Q 93.696289 22.307129 94.389160 22.307129 Q 95.108887 22.307129 95.474121 21.831787 Q 95.839355 21.356445 95.839355 20.427246 Q 95.839355 19.492676 95.474121 19.020020 Q 95.108887 18.547363 94.389160 18.547363 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 105.746582 14.980957 L 110.795410 14.980957 L 110.795410 15.442871 L 107.927246 23.000000 L 106.793945 23.000000 L 109.586914 15.894043 L 105.746582 15.894043 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 122.308594 19.191895 Q 121.583496 19.191895 121.188721 19.597412 Q 120.793945 20.002930 120.793945 20.744141 Q 120.793945 21.485352 121.194092 21.896240 Q 121.594238 22.307129 122.308594 22.307129 Q 123.039062 22.307129 123.433838 21.901611 Q 123.828613 21.496094 123.828613 20.744141 Q 123.828613 20.008301 123.428467 19.600098 Q 123.028320 19.191895 122.308594 19.191895 Z M 121.363281 18.740723 Q 120.670410 18.563477 120.281006 18.080078 Q 119.891602 17.596680 119.891602 16.914551 Q 119.891602 15.958496 120.541504 15.397217 Q 121.191406 14.835938 122.308594 14.835938 Q 123.431152 14.835938 124.081055 15.397217 Q 124.730957 15.958496 124.730957 16.914551 Q 124.730957 17.596680 124.341553 18.080078 Q 123.952148 18.563477 123.259277 18.740723 Q 124.064941 18.917969 124.491943 19.455078 Q 124.918945 19.992188 124.918945 20.846191 Q 124.918945 21.931152 124.226074 22.543457 Q 123.533203 23.155762 122.308594 23.155762 Q 121.083984 23.155762 120.393799 22.546143 Q 119.703613 21.936523 119.703613 20.856934 Q 119.703613 19.997559 120.130615 19.457764 Q 120.557617 18.917969 121.363281 18.740723 Z M 120.971191 17.016602 Q 120.971191 17.661133 121.314941 17.999512 Q 121.658691 18.337891 122.308594 18.337891 Q 122.963867 18.337891 123.307617 17.999512 Q 123.651367 17.661133 123.651367 17.016602 Q 123.651367 16.361328 123.310303 16.017578 Q 122.969238 15.673828 122.308594 15.673828 Q 121.658691 15.673828 121.314941 16.020264 Q 120.971191 16.366699 120.971191 17.016602 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 136.201172 19.444336 Q 136.894043 19.444336 137.288818 18.944824 Q 137.683594 18.445312 137.683594 17.564453 Q 137.683594 16.683594 137.288818 16.184082 Q 136.894043 15.684570 136.201172 15.684570 Q 135.481445 15.684570 135.116211 16.159912 Q 134.750977 16.635254 134.750977 17.564453 Q 134.750977 18.499023 135.113525 18.971680 Q 135.476074 19.444336 136.201172 19.444336 Z M 134.267578 22.833496 L 134.267578 21.834473 Q 134.605957 22.033203 134.987305 22.137939 Q 135.368652 22.242676 135.782227 22.242676 Q 136.813477 22.242676 137.342529 21.466553 Q 137.871582 20.690430 137.871582 19.181152 Q 137.619141 19.718262 137.162598 20.005615 Q 136.706055 20.292969 136.115234 20.292969 Q 134.955078 20.292969 134.318604 19.578613 Q 133.682129 18.864258 133.682129 17.553711 Q 133.682129 16.259277 134.334717 15.547607 Q 134.987305 14.835938 136.179688 14.835938 Q 137.576172 14.835938 138.226074 15.840332 Q 138.875977 16.844727 138.875977 18.998535 Q 138.875977 21.023438 138.094482 22.089600 Q 137.312988 23.155762 135.825195 23.155762 Q 135.433105 23.155762 135.035645 23.072510 Q 134.638184 22.989258 134.267578 22.833496 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 150.308594 14.862793 Q 151.592285 14.862793 152.250244 15.910156 Q 152.908203 16.957520 152.908203 19.009277 Q 152.908203 21.061035 152.250244 22.108398 Q 151.592285 23.155762 150.308594 23.155762 Q 149.024902 23.155762 148.369629 22.108398 Q 147.714355 21.061035 147.714355 19.009277 Q 147.714355 16.957520 148.369629 15.910156 Q 149.024902 14.862793 150.308594 14.862793 Z M 150.308594 22.296387 Q 151.071289 22.296387 151.444580 21.485352 Q 151.817871 20.674316 151.817871 19.009277 Q 151.817871 18.123047 151.710449 17.408691 L 149.153809 21.410156 Q 149.556641 22.296387 150.308594 22.296387 Z M 150.308594 15.722168 Q 149.551270 15.722168 149.177979 16.533203 Q 148.804688 17.344238 148.804688 19.009277 Q 148.804688 19.766602 148.906738 20.427246 L 151.409668 16.436523 Q 151.001465 15.722168 150.308594 15.722168 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 162.450195 22.092285 L 164.136719 22.092285 L 164.136719 16.033691 L 162.117188 17.005859 L 162.117188 15.963867 L 164.125977 15.007812 L 165.210938 15.007812 L 165.210938 22.092285 L 166.875977 22.092285 L 166.875977 23.000000 L 162.450195 23.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 177.003418 22.086914 L 180.687988 22.086914 L 180.687988 23.000000 L 175.816406 23.000000 L 175.816406 22.086914 Q 176.820801 21.028809 177.572754 20.217773 Q 178.324707 19.406738 178.609375 19.073730 Q 179.146484 18.418457 179.334473 18.012939 Q 179.522461 17.607422 179.522461 17.183105 Q 179.522461 16.511719 179.127686 16.130371 Q 178.732910 15.749023 178.045410 15.749023 Q 177.556641 15.749023 177.019531 15.926270 Q 176.482422 16.103516 175.880859 16.463379 L 175.880859 15.367676 Q 176.434082 15.104492 176.968506 14.970215 Q 177.502930 14.835938 178.023926 14.835938 Q 179.200195 14.835938 179.917236 15.461670 Q 180.634277 16.087402 180.634277 17.102539 Q 180.634277 17.618164 180.395264 18.133789 Q 180.156250 18.649414 179.619141 19.272461 Q 179.318359 19.621582 178.746338 20.239258 Q 178.174316 20.856934 177.003418 22.086914 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 193.167969 18.708496 Q 193.957520 18.917969 194.376465 19.452393 Q 194.795410 19.986816 194.795410 20.787109 Q 194.795410 21.893555 194.051514 22.524658 Q 193.307617 23.155762 191.991699 23.155762 Q 191.438477 23.155762 190.863770 23.053711 Q 190.289062 22.951660 189.735840 22.758301 L 189.735840 21.678711 Q 190.283691 21.963379 190.815430 22.103027 Q 191.347168 22.242676 191.873535 22.242676 Q 192.765137 22.242676 193.243164 21.839844 Q 193.721191 21.437012 193.721191 20.679688 Q 193.721191 19.981445 193.243164 19.570557 Q 192.765137 19.159668 191.948730 19.159668 L 191.121582 19.159668 L 191.121582 18.268066 L 191.948730 18.268066 Q 192.695312 18.268066 193.114258 17.940430 Q 193.533203 17.612793 193.533203 17.027344 Q 193.533203 16.409668 193.143799 16.079346 Q 192.754395 15.749023 192.034668 15.749023 Q 191.556641 15.749023 191.046387 15.856445 Q 190.536133 15.963867 189.977539 16.178711 L 189.977539 15.179688 Q 190.627441 15.007812 191.135010 14.921875 Q 191.642578 14.835938 192.034668 14.835938 Q 193.205566 14.835938 193.906494 15.424072 Q 194.607422 16.012207 194.607422 16.984375 Q 194.607422 17.645020 194.239502 18.085449 Q 193.871582 18.525879 193.167969 18.708496 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 206.947754 15.969238 L 204.417969 20.207031 L 206.947754 20.207031 Z M 206.770508 14.980957 L 208.027344 14.980957 L 208.027344 20.207031 L 209.096191 20.207031 L 209.096191 21.087891 L 208.027344 21.087891 L 208.027344 23.000000 L 206.947754 23.000000 L 206.947754 21.087891 L 203.547852 21.087891 L 203.547852 20.062012 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 218.111816 14.980957 L 222.172363 14.980957 L 222.172363 15.894043 L 219.100098 15.894043 L 219.100098 17.865234 Q 219.331055 17.779297 219.564697 17.739014 Q 219.798340 17.698730 220.034668 17.698730 Q 221.280762 17.698730 222.011230 18.434570 Q 222.741699 19.170410 222.741699 20.427246 Q 222.741699 21.694824 221.976318 22.425293 Q 221.210938 23.155762 219.884277 23.155762 Q 219.245117 23.155762 218.716064 23.069824 Q 218.187012 22.983887 217.768066 22.812012 L 217.768066 21.710938 Q 218.262207 21.979492 218.761719 22.111084 Q 219.261230 22.242676 219.782227 22.242676 Q 220.679199 22.242676 221.165283 21.770020 Q 221.651367 21.297363 221.651367 20.427246 Q 221.651367 19.567871 221.149170 19.089844 Q 220.646973 18.611816 219.750000 18.611816 Q 219.314941 18.611816 218.901367 18.711182 Q 218.487793 18.810547 218.111816 19.009277 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 236.322754 15.158203 L 236.322754 16.157227 Q 235.984375 15.958496 235.603027 15.853760 Q 235.221680 15.749023 234.808105 15.749023 Q 233.776855 15.749023 233.245117 16.525146 Q 232.713379 17.301270 232.713379 18.810547 Q 232.971191 18.273438 233.427734 17.986084 Q 233.884277 17.698730 234.475098 17.698730 Q 235.635254 17.698730 236.271729 18.410400 Q 236.908203 19.122070 236.908203 20.427246 Q 236.908203 21.727051 236.252930 22.441406 Q 235.597656 23.155762 234.410645 23.155762 Q 233.014160 23.155762 232.364258 22.154053 Q 231.714355 21.152344 231.714355 18.998535 Q 231.714355 16.968262 232.495850 15.902100 Q 233.277344 14.835938 234.759766 14.835938 Q 235.157227 14.835938 235.554688 14.919189 Q 235.952148 15.002441 236.322754 15.158203 Z M 234.389160 18.547363 Q 233.696289 18.547363 233.298828 19.046875 Q 232.901367 19.546387 232.901367 20.427246 Q 232.901367 21.308105 233.298828 21.807617 Q 233.696289 22.307129 234.389160 22.307129 Q 235.108887 22.307129 235.474121 21.831787 Q 235.839355 21.356445 235.839355 20.427246 Q 235.839355 19.492676 235.474121 19.020020 Q 235.108887 18.547363 234.389160 18.547363 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 245.746582 14.980957 L 250.795410 14.980957 L 250.795410 15.442871 L 247.927246 23.000000 L 246.793945 23.000000 L 249.586914 15.894043 L 245.746582 15.894043 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 262.308594 19.191895 Q 261.583496 19.191895 261.188721 19.597412 Q 260.793945 20.002930 260.793945 20.744141 Q 260.793945 21.485352 261.194092 21.896240 Q 261.594238 22.307129 262.308594 22.307129 Q 263.039062 22.307129 263.433838 21.901611 Q 263.828613 21.496094 263.828613 20.744141 Q 263.828613 20.008301 263.428467 19.600098 Q 263.028320 19.191895 262.308594 19.191895 Z M 261.363281 18.740723 Q 260.670410 18.563477 260.281006 18.080078 Q 259.891602 17.596680 259.891602 16.914551 Q 259.891602 15.958496 260.541504 15.397217 Q 261.191406 14.835938 262.308594 14.835938 Q 263.431152 14.835938 264.081055 15.397217 Q 264.730957 15.958496 264.730957 16.914551 Q 264.730957 17.596680 264.341553 18.080078 Q 263.952148 18.563477 263.259277 18.740723 Q 264.064941 18.917969 264.491943 19.455078 Q 264.918945 19.992188 264.918945 20.846191 Q 264.918945 21.931152 264.226074 22.543457 Q 263.533203 23.155762 262.308594 23.155762 Q 261.083984 23.155762 260.393799 22.546143 Q 259.703613 21.936523 259.703613 20.856934 Q 259.703613 19.997559 260.130615 19.457764 Q 260.557617 18.917969 261.363281 18.740723 Z M 260.971191 17.016602 Q 260.971191 17.661133 261.314941 17.999512 Q 261.658691 18.337891 262.308594 18.337891 Q 262.963867 18.337891 263.307617 17.999512 Q 263.651367 17.661133 263.651367 17.016602 Q 263.651367 16.361328 263.310303 16.017578 Q 262.969238 15.673828 262.308594 15.673828 Q 261.658691 15.673828 261.314941 16.020264 Q 260.971191 16.366699 260.971191 17.016602 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 276.201172 19.444336 Q 276.894043 19.444336 277.288818 18.944824 Q 277.683594 18.445312 277.683594 17.564453 Q 277.683594 16.683594 277.288818 16.184082 Q 276.894043 15.684570 276.201172 15.684570 Q 275.481445 15.684570 275.116211 16.159912 Q 274.750977 16.635254 274.750977 17.564453 Q 274.750977 18.499023 275.113525 18.971680 Q 275.476074 19.444336 276.201172 19.444336 Z M 274.267578 22.833496 L 274.267578 21.834473 Q 274.605957 22.033203 274.987305 22.137939 Q 275.368652 22.242676 275.782227 22.242676 Q 276.813477 22.242676 277.342529 21.466553 Q 277.871582 20.690430 277.871582 19.181152 Q 277.619141 19.718262 277.162598 20.005615 Q 276.706055 20.292969 276.115234 20.292969 Q 274.955078 20.292969 274.318604 19.578613 Q 273.682129 18.864258 273.682129 17.553711 Q 273.682129 16.259277 274.334717 15.547607 Q 274.987305 14.835938 276.179688 14.835938 Q 277.576172 14.835938 278.226074 15.840332 Q 278.875977 16.844727 278.875977 18.998535 Q 278.875977 21.023438 278.094482 22.089600 Q 277.312988 23.155762 275.825195 23.155762 Q 275.433105 23.155762 275.035645 23.072510 Q 274.638184 22.989258 274.267578 22.833496 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 290.308594 14.862793 Q 291.592285 14.862793 292.250244 15.910156 Q 292.908203 16.957520 292.908203 19.009277 Q 292.908203 21.061035 292.250244 22.108398 Q 291.592285 23.155762 290.308594 23.155762 Q 289.024902 23.155762 288.369629 22.108398 Q 287.714355 21.061035 287.714355 19.009277 Q 287.714355 16.957520 288.369629 15.910156 Q 289.024902 14.862793 290.308594 14.862793 Z M 290.308594 22.296387 Q 291.071289 22.296387 291.444580 21.485352 Q 291.817871 20.674316 291.817871 19.009277 Q 291.817871 18.123047 291.710449 17.408691 L 289.153809 21.410156 Q 289.556641 22.296387 290.308594 22.296387 Z M 290.308594 15.722168 Q 289.551270 15.722168 289.177979 16.533203 Q 288.804688 17.344238 288.804688 19.009277 Q 288.804688 19.766602 288.906738 20.427246 L 291.409668 16.436523 Q 291.001465 15.722168 290.308594 15.722168 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 302.450195 22.092285 L 304.136719 22.092285 L 304.136719 16.033691 L 302.117188 17.005859 L 302.117188 15.963867 L 304.125977 15.007812 L 305.210938 15.007812 L 305.210938 22.092285 L 306.875977 22.092285 L 306.875977 23.000000 L 302.450195 23.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 317.003418 22.086914 L 320.687988 22.086914 L 320.687988 23.000000 L 315.816406 23.000000 L 315.816406 22.086914 Q 316.820801 21.028809 317.572754 20.217773 Q 318.324707 19.406738 318.609375 19.073730 Q 319.146484 18.418457 319.334473 18.012939 Q 319.522461 17.607422 319.522461 17.183105 Q 319.522461 16.511719 319.127686 16.130371 Q 318.732910 15.749023 318.045410 15.749023 Q 317.556641 15.749023 317.019531 15.926270 Q 316.482422 16.103516 315.880859 16.463379 L 315.880859 15.367676 Q 316.434082 15.104492 316.968506 14.970215 Q 317.502930 14.835938 318.023926 14.835938 Q 319.200195 14.835938 319.917236 15.461670 Q 320.634277 16.087402 320.634277 17.102539 Q 320.634277 17.618164 320.395264 18.133789 Q 320.156250 18.649414 319.619141 19.272461 Q 319.318359 19.621582 318.746338 20.239258 Q 318.174316 20.856934 317.003418 22.086914 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 333.167969 18.708496 Q 333.957520 18.917969 334.376465 19.452393 Q 334.795410 19.986816 334.795410 20.787109 Q 334.795410 21.893555 334.051514 22.524658 Q 333.307617 23.155762 331.991699 23.155762 Q 331.438477 23.155762 330.863770 23.053711 Q 330.289062 22.951660 329.735840 22.758301 L 329.735840 21.678711 Q 330.283691 21.963379 330.815430 22.103027 Q 331.347168 22.242676 331.873535 22.242676 Q 332.765137 22.242676 333.243164 21.839844 Q 333.721191 21.437012 333.721191 20.679688 Q 333.721191 19.981445 333.243164 19.570557 Q 332.765137 19.159668 331.948730 19.159668 L 331.121582 19.159668 L 331.121582 18.268066 L 331.948730 18.268066 Q 332.695312 18.268066 333.114258 17.940430 Q 333.533203 17.612793 333.533203 17.027344 Q 333.533203 16.409668 333.143799 16.079346 Q 332.754395 15.749023 332.034668 15.749023 Q 331.556641 15.749023 331.046387 15.856445 Q 330.536133 15.963867 329.977539 16.178711 L 329.977539 15.179688 Q 330.627441 15.007812 331.135010 14.921875 Q 331.642578 14.835938 332.034668 14.835938 Q 333.205566 14.835938 333.906494 15.424072 Q 334.607422 16.012207 334.607422 16.984375 Q 334.607422 17.645020 334.239502 18.085449 Q 333.871582 18.525879 333.167969 18.708496 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 346.947754 15.969238 L 344.417969 20.207031 L 346.947754 20.207031 Z M 346.770508 14.980957 L 348.027344 14.980957 L 348.027344 20.207031 L 349.096191 20.207031 L 349.096191 21.087891 L 348.027344 21.087891 L 348.027344 23.000000 L 346.947754 23.000000 L 346.947754 21.087891 L 343.547852 21.087891 L 343.547852 20.062012 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 358.111816 14.980957 L 362.172363 14.980957 L 362.172363 15.894043 L 359.100098 15.894043 L 359.100098 17.865234 Q 359.331055 17.779297 359.564697 17.739014 Q 359.798340 17.698730 360.034668 17.698730 Q 361.280762 17.698730 362.011230 18.434570 Q 362.741699 19.170410 362.741699 20.427246 Q 362.741699 21.694824 361.976318 22.425293 Q 361.210938 23.155762 359.884277 23.155762 Q 359.245117 23.155762 358.716064 23.069824 Q 358.187012 22.983887 357.768066 22.812012 L 357.768066 21.710938 Q 358.262207 21.979492 358.761719 22.111084 Q 359.261230 22.242676 359.782227 22.242676 Q 360.679199 22.242676 361.165283 21.770020 Q 361.651367 21.297363 361.651367 20.427246 Q 361.651367 19.567871 361.149170 19.089844 Q 360.646973 18.611816 359.750000 18.611816 Q 359.314941 18.611816 358.901367 18.711182 Q 358.487793 18.810547 358.111816 19.009277 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 376.322754 15.158203 L 376.322754 16.157227 Q 375.984375 15.958496 375.603027 15.853760 Q 375.221680 15.749023 374.808105 15.749023 Q 373.776855 15.749023 373.245117 16.525146 Q 372.713379 17.301270 372.713379 18.810547 Q 372.971191 18.273438 373.427734 17.986084 Q 373.884277 17.698730 374.475098 17.698730 Q 375.635254 17.698730 376.271729 18.410400 Q 376.908203 19.122070 376.908203 20.427246 Q 376.908203 21.727051 376.252930 22.441406 Q 375.597656 23.155762 374.410645 23.155762 Q 373.014160 23.155762 372.364258 22.154053 Q 371.714355 21.152344 371.714355 18.998535 Q 371.714355 16.968262 372.495850 15.902100 Q 373.277344 14.835938 374.759766 14.835938 Q 375.157227 14.835938 375.554688 14.919189 Q 375.952148 15.002441 376.322754 15.158203 Z M 374.389160 18.547363 Q 373.696289 18.547363 373.298828 19.046875 Q 372.901367 19.546387 372.901367 20.427246 Q 372.901367 21.308105 373.298828 21.807617 Q 373.696289 22.307129 374.389160 22.307129 Q 375.108887 22.307129 375.474121 21.831787 Q 375.839355 21.356445 375.839355 20.427246 Q 375.839355 19.492676 375.474121 19.020020 Q 375.108887 18.547363 374.389160 18.547363 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 385.746582 14.980957 L 390.795410 14.980957 L 390.795410 15.442871 L 387.927246 23.000000 L 386.793945 23.000000 L 389.586914 15.894043 L 385.746582 15.894043 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 402.308594 19.191895 Q 401.583496 19.191895 401.188721 19.597412 Q 400.793945 20.002930 400.793945 20.744141 Q 400.793945 21.485352 401.194092 21.896240 Q 401.594238 22.307129 402.308594 22.307129 Q 403.039062 22.307129 403.433838 21.901611 Q 403.828613 21.496094 403.828613 20.744141 Q 403.828613 20.008301 403.428467 19.600098 Q 403.028320 19.191895 402.308594 19.191895 Z M 401.363281 18.740723 Q 400.670410 18.563477 400.281006 18.080078 Q 399.891602 17.596680 399.891602 16.914551 Q 399.891602 15.958496 400.541504 15.397217 Q 401.191406 14.835938 402.308594 14.835938 Q 403.431152 14.835938 404.081055 15.397217 Q 404.730957 15.958496 404.730957 16.914551 Q 404.730957 17.596680 404.341553 18.080078 Q 403.952148 18.563477 403.259277 18.740723 Q 404.064941 18.917969 404.491943 19.455078 Q 404.918945 19.992188 404.918945 20.846191 Q 404.918945 21.931152 404.226074 22.543457 Q 403.533203 23.155762 402.308594 23.155762 Q 401.083984 23.155762 400.393799 22.546143 Q 399.703613 21.936523 399.703613 20.856934 Q 399.703613 19.997559 400.130615 19.457764 Q 400.557617 18.917969 401.363281 18.740723 Z M 400.971191 17.016602 Q 400.971191 17.661133 401.314941 17.999512 Q 401.658691 18.337891 402.308594 18.337891 Q 402.963867 18.337891 403.307617 17.999512 Q 403.651367 17.661133 403.651367 17.016602 Q 403.651367 16.361328 403.310303 16.017578 Q 402.969238 15.673828 402.308594 15.673828 Q 401.658691 15.673828 401.314941 16.020264 Q 400.971191 16.366699 400.971191 17.016602 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 416.201172 19.444336 Q 416.894043 19.444336 417.288818 18.944824 Q 417.683594 18.445312 417.683594 17.564453 Q 417.683594 16.683594 417.288818 16.184082 Q 416.894043 15.684570 416.201172 15.684570 Q 415.481445 15.684570 415.116211 16.159912 Q 414.750977 16.635254 414.750977 17.564453 Q 414.750977 18.499023 415.113525 18.971680 Q 415.476074 19.444336 416.201172 19.444336 Z M 414.267578 22.833496 L 414.267578 21.834473 Q 414.605957 22.033203 414.987305 22.137939 Q 415.368652 22.242676 415.782227 22.242676 Q 416.813477 22.242676 417.342529 21.466553 Q 417.871582 20.690430 417.871582 19.181152 Q 417.619141 19.718262 417.162598 20.005615 Q 416.706055 20.292969 416.115234 20.292969 Q 414.955078 20.292969 414.318604 19.578613 Q 413.682129 18.864258 413.682129 17.553711 Q 413.682129 16.259277 414.334717 15.547607 Q 414.987305 14.835938 416.179688 14.835938 Q 417.576172 14.835938 418.226074 15.840332 Q 418.875977 16.844727 418.875977 18.998535 Q 418.875977 21.023438 418.094482 22.089600 Q 417.312988 23.155762 415.825195 23.155762 Q 415.433105 23.155762 415.035645 23.072510 Q 414.638184 22.989258 414.267578 22.833496 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 430.308594 14.862793 Q 431.592285 14.862793 432.250244 15.910156 Q 432.908203 16.957520 432.908203 19.009277 Q 432.908203 21.061035 432.250244 22.108398 Q 431.592285 23.155762 430.308594 23.155762 Q 429.024902 23.155762 428.369629 22.108398 Q 427.714355 21.061035 427.714355 19.009277 Q 427.714355 16.957520 428.369629 15.910156 Q 429.024902 14.862793 430.308594 14.862793 Z M 430.308594 22.296387 Q 431.071289 22.296387 431.444580 21.485352 Q 431.817871 20.674316 431.817871 19.009277 Q 431.817871 18.123047 431.710449 17.408691 L 429.153809 21.410156 Q 429.556641 22.296387 430.308594 22.296387 Z M 430.308594 15.722168 Q 429.551270 15.722168 429.177979 16.533203 Q 428.804688 17.344238 428.804688 19.009277 Q 428.804688 19.766602 428.906738 20.427246 L 431.409668 16.436523 Q 431.001465 15.722168 430.308594 15.722168 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 442.450195 22.092285 L 444.136719 22.092285 L 444.136719 16.033691 L 442.117188 17.005859 L 442.117188 15.963867 L 444.125977 15.007812 L 445.210938 15.007812 L 445.210938 22.092285 L 446.875977 22.092285 L 446.875977 23.000000 L 442.450195 23.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 148.450195 9.092285 L 150.136719 9.092285 L 150.136719 3.033691 L 148.117188 4.005859 L 148.117188 2.963867 L 150.125977 2.007812 L 151.210938 2.007812 L 151.210938 9.092285 L 152.875977 9.092285 L 152.875977 10.000000 L 148.450195 10.000000 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 289.003418 9.086914 L 292.687988 9.086914 L 292.687988 10.000000 L 287.816406 10.000000 L 287.816406 9.086914 Q 288.820801 8.028809 289.572754 7.217773 Q 290.324707 6.406738 290.609375 6.073730 Q 291.146484 5.418457 291.334473 5.012939 Q 291.522461 4.607422 291.522461 4.183105 Q 291.522461 3.511719 291.127686 3.130371 Q 290.732910 2.749023 290.045410 2.749023 Q 289.556641 2.749023 289.019531 2.926270 Q 288.482422 3.103516 287.880859 3.463379 L 287.880859 2.367676 Q 288.434082 2.104492 288.968506 1.970215 Q 289.502930 1.835938 290.023926 1.835938 Q 291.200195 1.835938 291.917236 2.461670 Q 292.634277 3.087402 292.634277 4.102539 Q 292.634277 4.618164 292.395264 5.133789 Q 292.156250 5.649414 291.619141 6.272461 Q 291.318359 6.621582 290.746338 7.239258 Q 290.174316 7.856934 289.003418 9.086914 Z " fill="black" fill-opacity="1.000000"></path>
                <path d="M 431.167969 5.708496 Q 431.957520 5.917969 432.376465 6.452393 Q 432.795410 6.986816 432.795410 7.787109 Q 432.795410 8.893555 432.051514 9.524658 Q 431.307617 10.155762 429.991699 10.155762 Q 429.438477 10.155762 428.863770 10.053711 Q 428.289062 9.951660 427.735840 9.758301 L 427.735840 8.678711 Q 428.283691 8.963379 428.815430 9.103027 Q 429.347168 9.242676 429.873535 9.242676 Q 430.765137 9.242676 431.243164 8.839844 Q 431.721191 8.437012 431.721191 7.679688 Q 431.721191 6.981445 431.243164 6.570557 Q 430.765137 6.159668 429.948730 6.159668 L 429.121582 6.159668 L 429.121582 5.268066 L 429.948730 5.268066 Q 430.695312 5.268066 431.114258 4.940430 Q 431.533203 4.612793 431.533203 4.027344 Q 431.533203 3.409668 431.143799 3.079346 Q 430.754395 2.749023 430.034668 2.749023 Q 429.556641 2.749023 429.046387 2.856445 Q 428.536133 2.963867 427.977539 3.178711 L 427.977539 2.179688 Q 428.627441 2.007812 429.135010 1.921875 Q 429.642578 1.835938 430.034668 1.835938 Q 431.205566 1.835938 431.906494 2.424072 Q 432.607422 3.012207 432.607422 3.984375 Q 432.607422 4.645020 432.239502 5.085449 Q 431.871582 5.525879 431.167969 5.708496 Z " fill="black" fill-opacity="1.000000"></path>
              </svg><a href="#section-6.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-scmp-message-format" class="selfRef">SCMP message format</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1"><code>Type</code>: it indicates the type of SCMP message. Its value determines the format of the type-dependent block.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1"><code>Code</code>: it provides additional granularity to the SCMP type.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.3">
            <p id="section-6.1-4.3.1"><code>Checksum</code>: it is used to detect data corruption.<a href="#section-6.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.4">
            <p id="section-6.1-4.4.1"><code>Type-dependent Block</code>: optional field of variable length which format is dependent on the message type.<a href="#section-6.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-types">
<section id="section-6.2">
        <h3 id="name-message-types">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-message-types" class="section-name selfRef">Message Types</a>
        </h3>
<p id="section-6.2-1">SCMP messages are grouped into two classes: error messages and informational messages. Error messages are identified by a zero in the high-order bit of the type value. I.e., error messages have a type value in the range of 0-127. Informational messages have type values in the range of 128-255.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">This specification defines the message formats for the following SCMP messages:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span id="name-error-messages-types"></span><table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-error-messages-types" class="selfRef">error messages types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for future use</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#packet-too-big" class="internal xref">Packet Too Big</a> (<a href="#packet-too-big" class="auto internal xref">Section 6.5.1</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for future use</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for future use</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#external-interface-down" class="internal xref">External Interface Down</a> (<a href="#external-interface-down" class="auto internal xref">Section 6.5.2</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#internal-connectivity-down" class="internal xref">Internal Connectivity Down</a> (<a href="#internal-connectivity-down" class="auto internal xref">Section 6.5.3</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">100</td>
              <td class="text-left" rowspan="1" colspan="1">Private Experimentation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">101</td>
              <td class="text-left" rowspan="1" colspan="1">Private Experimentation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">127</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for expansion of SCMP error messages</td>
            </tr>
          </tbody>
        </table>
<span id="name-informational-messages-type"></span><table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-informational-messages-type" class="selfRef">informational messages types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#echo-request" class="internal xref">Echo Request</a> (<a href="#echo-request" class="auto internal xref">Section 6.6.1</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">129</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#echo-reply" class="internal xref">Echo Reply</a> (<a href="#echo-reply" class="auto internal xref">Section 6.6.2</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">130</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#traceroute-request" class="internal xref">Traceroute Request</a> (<a href="#traceroute-request" class="auto internal xref">Section 6.6.3</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">131</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#traceroute-reply" class="internal xref">Traceroute Reply</a> (<a href="#traceroute-reply" class="auto internal xref">Section 6.6.4</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">200</td>
              <td class="text-left" rowspan="1" colspan="1">Private Experimentation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">201</td>
              <td class="text-left" rowspan="1" colspan="1">Private Experimentation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">255</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for expansion of SCMP informational messages</td>
            </tr>
          </tbody>
        </table>
<p id="section-6.2-5">Type values 100, 101, 200, and 201 are reserved for private experimentation.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">All other values are reserved for future use.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="checksum-calculation">
<section id="section-6.3">
        <h3 id="name-checksum-calculation">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-checksum-calculation" class="section-name selfRef">Checksum Calculation</a>
        </h3>
<p id="section-6.3-1">The checksum is the 16-bit one's complement of the one's complement sum of the
entire SCMP message, starting with the SCMP message type field, and prepended
with a "pseudo-header" consisting of the SCION address header and the Layer 4
protocol type as defined in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "SCION Header Specification/Pseudo Header for Upper-Layer Checksum".<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-rules">
<section id="section-6.4">
        <h3 id="name-processing-rules">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-processing-rules" class="section-name selfRef">Processing Rules</a>
        </h3>
<p id="section-6.4-1">Implementations <span class="bcp14">MUST</span> respect the following rules when processing SCMP messages:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
            <p id="section-6.4-2.1.1">If an SCMP error message of unknown type is received at its destination, it <span class="bcp14">MUST</span> be passed to the upper-layer process that originated the packet that caused the error, if it can be identified.<a href="#section-6.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.2">
            <p id="section-6.4-2.2.1">If an SCMP informational message of unknown type is received, it <span class="bcp14">MUST</span> be silently dropped.<a href="#section-6.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.3">
            <p id="section-6.4-2.3.1">Every SCMP error message <span class="bcp14">MUST</span> include as much of the offending SCION packet as possible. The error message packet - including the SCION header and all extension headers - <span class="bcp14">MUST NOT</span> exceed <strong>1232 bytes</strong> in order to fit into the minimum MTU (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "Deployment Considerations/MTU").<a href="#section-6.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.4">
            <p id="section-6.4-2.4.1">In case the implementation is required to pass an SCMP error message to the upper-layer process, the upper-layer protocol type is extracted from the original packet in the body of the SCMP error message and used to select the appropriate process to handle the error. In case the upper-layer protocol type cannot be extracted from the SCMP error message body, the SCMP message <span class="bcp14">MUST</span> be silently dropped.<a href="#section-6.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.5">
            <p id="section-6.4-2.5.1">An SCMP error message <span class="bcp14">MUST NOT</span> be originated in response to any of the following:<a href="#section-6.4-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.5.2.1">
                <p id="section-6.4-2.5.2.1.1">An SCMP error message.<a href="#section-6.4-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.4-2.5.2.2">
                <p id="section-6.4-2.5.2.2.1">A packet which source address does not uniquely identify a single node. E.g., an IPv4 or IPv6 multicast address.<a href="#section-6.4-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.4-3">The maximum size 1232 bytes is chosen so that the entire datagram, if encapsulated in UDP and IPv6, does not exceed 1280 bytes (L2 Header excluded). 1280 bytes is the minimum MTU required by IPv6 and it is assumed that, nowadays, this MTU can also be safely expected when using IPv4.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scmp-notification">
<section id="section-6.5">
        <h3 id="name-error-messages">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-error-messages" class="section-name selfRef">Error Messages</a>
        </h3>
<div id="packet-too-big">
<section id="section-6.5.1">
          <h4 id="name-packet-too-big">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-packet-too-big" class="section-name selfRef">Packet Too Big</a>
          </h4>
<span id="name-packet-too-big-format"></span><figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-6.5.1-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│           Reserved            │             MTU               │
├───────────────────────────────┴───────────────────────────────┤
│                As much of the offending packet                │
├              as possible without the SCMP packet              ┤
│                    exceeding 1232 bytes                       │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-packet-too-big-format" class="selfRef">Packet-too-big format</a>
            </figcaption></figure>
<span id="name-field-values"></span><table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-field-values" class="selfRef">field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">MTU</td>
                <td class="text-left" rowspan="1" colspan="1">The Maximum Transmission Unit of the next-hop link.</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.5.1-3">A <strong>Packet Too Big</strong> message <span class="bcp14">SHOULD</span> be originated by a router in response to a
packet that cannot be forwarded because the packet is larger than the MTU of the
outgoing link. The MTU value is set to the maximum size a SCION packet can have
to still fit on the next-hop link, as the sender has no knowledge of the
underlay.<a href="#section-6.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="external-interface-down">
<section id="section-6.5.2">
          <h4 id="name-external-interface-down">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-external-interface-down" class="section-name selfRef">External Interface Down</a>
          </h4>
<span id="name-external-interface-down-for"></span><div id="_figure-22">
<figure id="figure-19">
            <div class="alignLeft art-text artwork" id="section-6.5.2-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│              ISD              │                               │
├───────────────────────────────┘              AS               ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                                                               │
├                          Interface ID                         ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                As much of the offending packet                │
├              as possible without the SCMP packet              ┤
│                    exceeding 1232 bytes                       │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-external-interface-down-for" class="selfRef">External-interface-down format</a>
            </figcaption></figure>
</div>
<span id="name-field-values-2"></span><table class="center" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-field-values-2" class="selfRef">field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">The 16-bit ISD identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">The 48-bit AS identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Interface ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the external link with connectivity issue.</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.5.2-3">A <strong>External Interface Down</strong> message <span class="bcp14">SHOULD</span> be originated by a router in response
to a packet that cannot be forwarded because the link to an external AS is broken.
The ISD and AS identifier are set to the ISD-AS of the originating router.
The interface ID identifies the link of the originating AS that is down.<a href="#section-6.5.2-3" class="pilcrow">¶</a></p>
<p id="section-6.5.2-4">Recipients can use this information to route around broken data-plane links.<a href="#section-6.5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internal-connectivity-down">
<section id="section-6.5.3">
          <h4 id="name-internal-connectivity-down">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-internal-connectivity-down" class="section-name selfRef">Internal Connectivity Down</a>
          </h4>
<span id="name-internal-connectivity-down-"></span><div id="_figure-23">
<figure id="figure-20">
            <div class="alignLeft art-text artwork" id="section-6.5.3-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│              ISD              │                               │
├───────────────────────────────┘              AS               ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                                                               │
├                     Ingress Interface ID                      ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                                                               │
├                      Egress Interface ID                      ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                As much of the offending packet                │
├              as possible without the SCMP packet              ┤
│                    exceeding 1232 bytes                       │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-internal-connectivity-down-" class="selfRef">Internal-connectivity-down format</a>
            </figcaption></figure>
</div>
<span id="name-field-values-3"></span><table class="center" id="table-9">
            <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-field-values-3" class="selfRef">field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">The 16-bit ISD identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">The 48-bit AS identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ingress ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the ingress link.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Egress ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the egress link.</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.5.3-3">A <strong>Internal Connectivity Down</strong> message <span class="bcp14">SHOULD</span> be originated by a router in
response to a packet that cannot be forwarded inside the AS because because the
connectivity between the ingress and egress routers is broken. The ISD and AS
identifier are set to the ISD-AS of the originating router. The ingress
interface ID identifies the interface on which the packet enters the AS. The
egress interface ID identifies the interface on which the packet is destined to
leave the AS, but the connection is broken to.<a href="#section-6.5.3-3" class="pilcrow">¶</a></p>
<p id="section-6.5.3-4">Recipients can use this information to route around a broken data plane inside an
AS.<a href="#section-6.5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="scmp-information">
<section id="section-6.6">
        <h3 id="name-informational-messages">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-informational-messages" class="section-name selfRef">Informational Messages</a>
        </h3>
<div id="echo-request">
<section id="section-6.6.1">
          <h4 id="name-echo-request">
<a href="#section-6.6.1" class="section-number selfRef">6.6.1. </a><a href="#name-echo-request" class="section-name selfRef">Echo Request</a>
          </h4>
<span id="name-echo-request-format"></span><div id="_figure-24">
<figure id="figure-21">
            <div class="alignLeft art-text artwork" id="section-6.6.1-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│           Identifer           │        Sequence Number        │
├───────────────────────────────┴───────────────────────────────┤
│                     Data (variable length)                    │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-echo-request-format" class="selfRef">Echo-request format</a>
            </figcaption></figure>
</div>
<span id="name-field-values-4"></span><table class="center" id="table-10">
            <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-field-values-4" class="selfRef">field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">128</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit identifier to aid matching replies with requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit sequence number to aid matching replies with requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">Variable length of arbitrary data</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.1-3">Every node <span class="bcp14">SHOULD</span> implement a SCMP Echo responder function that receives Echo Requests and originates corresponding Echo replies.<a href="#section-6.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="echo-reply">
<section id="section-6.6.2">
          <h4 id="name-echo-reply">
<a href="#section-6.6.2" class="section-number selfRef">6.6.2. </a><a href="#name-echo-reply" class="section-name selfRef">Echo Reply</a>
          </h4>
<span id="name-echo-reply-format"></span><div id="_figure-25">
<figure id="figure-22">
            <div class="alignLeft art-text artwork" id="section-6.6.2-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│           Identifer           │        Sequence Number        │
├───────────────────────────────┴───────────────────────────────┤
│                     Data (variable length)                    │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-echo-reply-format" class="selfRef">Echo-reply format</a>
            </figcaption></figure>
</div>
<table class="center" id="table-11">
            <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">129</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier of the Echo Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">The sequence number of the Echo Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">The data of the Echo Request</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.2-3">Every node <span class="bcp14">SHOULD</span> implement a SCMP Echo responder function that receives Echo Requests and originates corresponding Echo replies.<a href="#section-6.6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.6.2-4">The data received in the SCMP Echo Request message <span class="bcp14">MUST</span> be returned entirely and unmodified in the SCMP Echo Reply message.<a href="#section-6.6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="traceroute-request">
<section id="section-6.6.3">
          <h4 id="name-traceroute-request">
<a href="#section-6.6.3" class="section-number selfRef">6.6.3. </a><a href="#name-traceroute-request" class="section-name selfRef">Traceroute Request</a>
          </h4>
<span id="name-traceroute-request-format"></span><div id="_figure-26">
<figure id="figure-23">
            <div class="alignLeft art-text artwork" id="section-6.6.3-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│           Identifer           │        Sequence Number        │
├───────────────────────────────┼───────────────────────────────┤
│              ISD              │                               │
├───────────────────────────────┘              AS               ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                                                               │
├                          Interface ID                         ┤
│                                                               │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-traceroute-request-format" class="selfRef">Traceroute-request format</a>
            </figcaption></figure>
</div>
<p id="section-6.6.3-2">Given a SCION path constituted of hop fields, traceroute allows to identify the corresponding on-path ISD-ASes.<a href="#section-6.6.3-2" class="pilcrow">¶</a></p>
<span id="name-field-values-5"></span><table class="center" id="table-12">
            <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-field-values-5" class="selfRef">field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">130</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit identifier to aid matching replies with requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit sequence number to aid matching replies with request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">Place holder set to zero by SCMP sender</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">Place holder set to zero by SCMP sender</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Interface ID</td>
                <td class="text-left" rowspan="1" colspan="1">Place holder set to zero by SCMP sender</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.3-4">A border router is alerted of a Traceroute Request message through the Ingress or Egress Router Alert flag set to 1 in the hop field that describes the traversal of that router in a packet's path (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "SCION Header Specification/Path Header/SCION Path Type/Hop Field"). When such a packet is received, the border router <span class="bcp14">SHOULD</span> reply with a <span><a href="#traceroute-reply" class="internal xref">Traceroute Reply message</a> (<a href="#traceroute-reply" class="auto internal xref">Section 6.6.4</a>)</span>.<a href="#section-6.6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="traceroute-reply">
<section id="section-6.6.4">
          <h4 id="name-traceroute-reply">
<a href="#section-6.6.4" class="section-number selfRef">6.6.4. </a><a href="#name-traceroute-reply" class="section-name selfRef">Traceroute Reply</a>
          </h4>
<span id="name-traceroute-reply-format"></span><div id="_figure-27">
<figure id="figure-24">
            <div class="alignLeft art-text artwork" id="section-6.6.4-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤
│     Type      │     Code      │           Checksum            │
├───────────────┴───────────────┼───────────────────────────────┤
│           Identifer           │        Sequence Number        │
├───────────────────────────────┼───────────────────────────────┤
│              ISD              │                               │
├───────────────────────────────┘              AS               ┤
│                                                               │
├───────────────────────────────────────────────────────────────┤
│                                                               │
├                          Interface ID                         ┤
│                                                               │
└───────────────────────────────────────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-traceroute-reply-format" class="selfRef">Traceroute-reply format</a>
            </figcaption></figure>
</div>
<span id="name-field-values-6"></span><table class="center" id="table-13">
            <caption>
<a href="#table-13" class="selfRef">Table 13</a>:
<a href="#name-field-values-6" class="selfRef">field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">131</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier set in the Traceroute Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">The sequence number of the Tracroute Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">The 16-bit ISD identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">The 48-bit AS identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Interface ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the SCMP originating router</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.4-3">The identifier is set to the identifier value from the <span><a href="#traceroute-request" class="internal xref">Traceroute Request message</a> (<a href="#traceroute-request" class="auto internal xref">Section 6.6.3</a>)</span>. The ISD and AS identifiers are set to the ISD-AS of the originating border router.<a href="#section-6.6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="scmp-authentication">
<section id="section-6.7">
        <h3 id="name-scmp-authentication">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-scmp-authentication" class="section-name selfRef">SCMP Authentication</a>
        </h3>
<p id="section-6.7-1">Authentication of SCMP packets is not specified here. In current deployments it is still experimental so endpoints should validate link down messages (<span><a href="#external-interface-down" class="internal xref">External Interface Down</a> (<a href="#external-interface-down" class="auto internal xref">Section 6.5.2</a>)</span> and <span><a href="#internal-connectivity-down" class="internal xref">Internal Connectivity Down</a> (<a href="#internal-connectivity-down" class="auto internal xref">Section 6.5.3</a>)</span>) with additional signals for reliable operations.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">As described previously, the goal of SCION’s beaconing process in the control plane is to securely discover and disseminate paths between any two ASes. This section describes security considerations for SCION's Control Plane that focuses on <em>inter</em>-domain routing. SCION does not provide intra-domain routing, nor does it provide end-to-end payload encryption so these topics lie outside the scope of this section.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This section discusses three kinds of threats to the control plane:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-3">
<li id="section-7-3.1">
          <p id="section-7-3.1.1">When an adversary controls one or all core ASes of an ISD and tries to manipulate the beaconing process from the top down (see <a href="#topdown-manipulate" class="auto internal xref">Section 7.2</a>).<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-3.2">
          <p id="section-7-3.2.1">When "ordinary" (non-core) adversaries try to manipulate the beaconing process (see <a href="#manipulate-beaconing" class="auto internal xref">Section 7.3</a>).<a href="#section-7-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-3.3">
          <p id="section-7-3.3.1">Denial of Services (DoS) attacks where attackers overload different parts of the infrastructure (see <a href="#dos-cp" class="auto internal xref">Section 7.4</a>).<a href="#section-7-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="security-properties">
<section id="section-7.1">
        <h3 id="name-security-properties">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-security-properties" class="section-name selfRef">Security Properties</a>
        </h3>
<p id="section-7.1-1">The SCION control plane provides various security properties, as discussed below.
Here, an AS is described as 'honest' if its private keys are unknown to the attacker and if it uses a unique interface identifier for each link. An honest path is one that only traverses honest ASes. A honest segment is the one created by an honest AS.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Security properties are:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">
            <p id="section-7.1-3.1.1">Connectivity - For every pair of honest ASes X and Y, X will eventually register enough segments to build at least one path (of any length) leading to Y.<a href="#section-7.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">Forwarding Path Consistency - For every honest path segment registered in any AS<a href="#section-7.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.2.2.1">
                <p id="section-7.1-3.2.2.1.1">its sequence of AS entries corresponds to a continuous SCION forwarding path in the network of inter-domain links<a href="#section-7.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-3.2.2.2">
                <p id="section-7.1-3.2.2.2.1">the inter-domain network topology remains unchanged since the segment was first generated.<a href="#section-7.1-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.1-3.3">
            <p id="section-7.1-3.3.1">Loop Freedom - For every honest path segment registered in any AS, its sequence of AS entries contains no duplicates, including current and next ISD-AS and interface IDs.<a href="#section-7.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.4">
            <p id="section-7.1-3.4.1">Path Authorization - For every honest path segment registered in any AS and any AS X appearing on that segment (except for the previous one), AS X propagated a PCB corresponding to the segment portion ending in its own entry to its successor AS on the segment.<a href="#section-7.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-4">To ensure that the properties hold across the overall SCION network, all core ASes should be able to reach each other with some sequence of core links, and all non-core ASes should have at least one path up to a core AS. Furthermore, to ensure that the properties hold within a single ISD, all cores ASes of the ISD should be able to reach each other without leaving the ISD, i.e., for every pair of cores in an ISD there is a sequence of SCION links that only traverses ISD members.
A core AS may reach other core ASes in the same ISD via other ISDs. This may be permitted, depending on the ISD's policies.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="topdown-manipulate">
<section id="section-7.2">
        <h3 id="name-manipulation-of-the-beaconi">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-manipulation-of-the-beaconi" class="section-name selfRef">Manipulation of the Beaconing Process by a Core Adversary</a>
        </h3>
<p id="section-7.2-1">The first risk to the beaconing process comes from an adversary controlling one or more core ASes in an ISD. If the adversary stops all core AS(es) within an ISD from propagating PCBs, the discovery of new paths will halt. In this case, downstream ASes will notice that PCBs are no longer being propagated, but all previously discovered and still valid paths remain usable for data plane forwarding until they expire. This is an unlikely scenario, as it would require compromise of all core ASes within an ISD.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manipulate-beaconing">
<section id="section-7.3">
        <h3 id="name-manipulation-of-the-beaconin">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-manipulation-of-the-beaconin" class="section-name selfRef">Manipulation of the Beaconing Process by a Non-Core Adversary</a>
        </h3>
<p id="section-7.3-1">This section examines several possible approaches that could be taken by an "ordinary" non-core adversary to manipulate the beaconing process in the SCION Control Plane. For each case it shows to what extent SCION's design can prevent the corresponding attack or help mitigate it.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="path-hijack">
<section id="section-7.3.1">
          <h4 id="name-path-hijacking-through-inte">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-path-hijacking-through-inte" class="section-name selfRef">Path Hijacking through Interposition</a>
          </h4>
<p id="section-7.3.1-1">A malicious AS M might try to manipulate the beaconing process between two neighbor ASes A and B, with the goal to hijack traffic to flow via M. If M can interpose itself on the path between A and B, then it could attempt several potential attacks:<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-2.1">
              <p id="section-7.3.1-2.1.1">The adversary M could intercept and disseminate a PCB on its way from A to the neighboring AS B, and inject its own AS entry into the PCB toward downstream ASes.<a href="#section-7.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-2.2">
              <p id="section-7.3.1-2.2.1">The adversary could modify the Hop Fields of an already existing path in order to insert its own AS in the path.<a href="#section-7.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-2.3">
              <p id="section-7.3.1-2.3.1">The adversary could fully block traffic between AS A and AS B in order to force traffic redirection through an alternate path that includes its own AS.<a href="#section-7.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.3.1-3">The first type of attack is detectable and blocked by downstream ASes (e.g. B) because a PCB disseminated by AS A towards AS B contains the "Next ISD AS" field in the entry of AS A, pointing to AS B, and protected by A's signature. If M manipulates the PCB while in flight from A to B, then verification of the manipulated inbound PCBs will fail at AS B, as the adversary's PCBs cannot contain A's correct signature.<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
<p id="section-7.3.1-4">The second type of attack is made impossible by the Hop Field's MAC which protects the Hop Field's integrity and chains it with the previous Hop Fields on the path.<a href="#section-7.3.1-4" class="pilcrow">¶</a></p>
<p id="section-7.3.1-5">The third type of attack generally cannot be prevented. However the alternate path would be immediately visible to endpoints as traffic <span class="bcp14">MUST</span> include Hop Fields from AS M.<a href="#section-7.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fake-ases">
<section id="section-7.3.2">
          <h4 id="name-creation-of-spurious-ases-a">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-creation-of-spurious-ases-a" class="section-name selfRef">Creation of Spurious ASes and ISDs</a>
          </h4>
<p id="section-7.3.2-1">An alternative scenario is when an adversary tries to introduce and spoof a non-existent AS. This would enable the adversary to send traffic with the spoofed AS as a source, allowing the adversary to complicate the detection of its attack and to plausibly deny the misbehavior.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">However, spoofing a new AS requires a registration of that AS with the ISD core to obtain a valid AS certificate, otherwise the adversary cannot construct valid PCBs. As this registration should include a thorough check and authentication by a CA, this cannot be done stealthily which defeats the original purpose.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">Similarly to creating a fake AS, an adversary could try to introduce a new malicious ISD. This involves the generation of its own TRC, finding core ASes to peer with, and convincing other ISDs of its legitimacy to accept the new TRC. Although this setup is not entirely impossible, it requires substantial time and effort and may need the involvement of more than one malicious entity. Here the "costs" of setting up the fake ISD may outweigh the benefits.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="peer-link-misuse">
<section id="section-7.3.3">
          <h4 id="name-peering-link-misuse">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-peering-link-misuse" class="section-name selfRef">Peering Link Misuse</a>
          </h4>
<p id="section-7.3.3-1">The misuse of a peering link by an adversary represents another type of attack. Consider the case where AS A wants to share its peering link only with one of its downstream neighbors AS B, and therefore selectively includes the peering link only in PCBs sent to B. An adversary may now try to gain access to this peering link by prepending the relevant PCBs to its own path. For this, the adversary needs to be able to (1) eavesdrop on the link from A to B, and (2) obtain the necessary Hop Fields by querying a Control Service and extracting the Hop Fields from registered paths.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3.3-2">Even if an adversary succeeds in misusing a peering link as described above, SCION is able to mitigate this kind of attack. Each AS includes an egress interface as well as specific “next hop” information to the PCB before disseminating it further downstream. If a malicious entity tries to misuse a stolen PCB by adding it to its own segments, verification will fail upstream as the egress interface mismatches. Therefore, the peering link can only be used by the intended AS.<a href="#section-7.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manipulate-selection">
<section id="section-7.3.4">
          <h4 id="name-manipulation-of-the-path-se">
<a href="#section-7.3.4" class="section-number selfRef">7.3.4. </a><a href="#name-manipulation-of-the-path-se" class="section-name selfRef">Manipulation of the Path-Selection Process</a>
          </h4>
<p id="section-7.3.4-1">Endpoint path control is one of the main benefits of SCION compared to the current Internet as SCION endpoints can select inter-domain forwarding paths for each packet. However, with the benefits of path selection comes the risk of endpoints selecting non-optimal paths. This section discusses some mechanisms with which an adversary can attempt to trick endpoints downstream (in the direction of beaconing) into choosing non-optimal paths. The goal of such attacks is to make paths that are controlled by the adversary more attractive than other available paths.<a href="#section-7.3.4-1" class="pilcrow">¶</a></p>
<p id="section-7.3.4-2">In SCION, overall path selection is the result of three steps. Firstly, each AS selects which PCBs are further forwarded to its neighbors. Secondly, each AS chooses the paths it wants to register at the local Control Service (as up segments) and at the core Control Service (as down segments). Thirdly, the endpoint performs path selection among all available paths resulting from a path lookup process.<a href="#section-7.3.4-2" class="pilcrow">¶</a></p>
<p id="section-7.3.4-3">These attacks are only successful if the adversary is located within the same ISD and upstream relative to the victim AS. It is not possible to attract traffic away from the core as traffic travels upstream towards the core. Furthermore, the attack may either be discovered downstream (e.g., by seeing large numbers of paths becoming available), or during path registrations. After detection, non-core ASes will be able to identify paths traversing the adversary AS and avoid these paths.<a href="#section-7.3.4-3" class="pilcrow">¶</a></p>
<p id="section-7.3.4-4"><strong>Announcing Large Numbers of Path Segments</strong> <br>
This attack is possible if the adversary controls at least two ASes. The adversary can create a large number of links between the ASes under its control which do not necessarily correspond to physical links. This allows the adversary to multiply the number of PCBs forwarded to its downstream neighbor ASes and in turn increases the chance that one or several of these forwarded PCBs are selected by the downstream ASes.<a href="#section-7.3.4-4" class="pilcrow">¶</a></p>
<p id="section-7.3.4-5">In general, the number of PCBs that an adversary can announce this way scales exponentially with the number of consecutive ASes the adversary controls. However, this also decreases their chance of being chosen by a downstream AS for PCB dissemination or by an endpoint for path construction as these relatively long paths have to compete with other shorter paths. Furthermore, both endpoints and downstream ASes can detect poorer quality paths in the data plane and switch to better paths.<a href="#section-7.3.4-5" class="pilcrow">¶</a></p>
<p id="section-7.3.4-6"><strong>Wormhole Attack</strong> <br>
A malicious AS M1 can send a PCB not only to their downstream neighbor ASes, but also out-of-band to another non-neighbor colluding malicious AS M2. This creates new segments to M2 and M2's downstream neighbor ASes, simulating a link between M1 and M2 which may not correspond to an actual link in the network topology.<a href="#section-7.3.4-6" class="pilcrow">¶</a></p>
<p id="section-7.3.4-7">Similarly, a fake path can be announced through a fake peering link between two colluding ASes even if in different ISDs. An adversary can advertise fake peering links between the two colluding ASes, thus offering short paths to many destination ASes. Downstream ASes might have a policy of preferring paths with many peering links and thus are more likely to disseminate PCBs from the adversary. Endpoints are also more likely to choose short paths that make use of peering links.
In the data plane, whenever the adversary receives a packet containing a fake peering link, it can transparently exchange the fake peering Hop Fields with valid Hop Fields to the colluding AS. To avoid detection of the path alteration by the receiver, the colluding AS can replace the added Hop Fields with the fake peering link Hop Fields the sender inserted.<a href="#section-7.3.4-7" class="pilcrow">¶</a></p>
<p id="section-7.3.4-8">To defend against this attack, methods to detect the wormhole attack are needed. Per link or path latency measurements can help reveal the wormhole and render the fake peering link suspicious or unattractive. Without specific detection mechanisms these so-called wormhole attacks are unavoidable in routing.<a href="#section-7.3.4-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dos-cp">
<section id="section-7.4">
        <h3 id="name-denial-of-service-attacks">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-denial-of-service-attacks" class="section-name selfRef">Denial of Service Attacks</a>
        </h3>
<p id="section-7.4-1">The beaconing process in the SCION Control Plane relies on control plane communication. ASes exchange control plane messages within each other when propagating PCBs to downstream neighbors, when registering PCBs as path segments, or during core path lookup. Volumetric DoS attacks, where attackers overload a link may make it difficult to exchange these messages.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">SCION limits the impact of such attacks which aim to exhaust network bandwidth on links as ASes can switch to alternative paths that do not contain the congested links. Reflection-based attacks are also prevented as response packets are returned on the same path to the actual sender.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">Other mechanisms are required to avoid transport protocol attacks where the attacker tries to exhaust the resources on a target server, such as for the Control Services, by opening many connections to this. The means to mitigate these kind of DoS attacks are basically the same as for the current Internet, e.g. filtering, geo-blocking or using cookies.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">Thanks to its path awareness, SCION enables more fine-grained filtering mechanisms based on certain path properties. For example, control plane RPC methods that are available to endpoints within an AS are strictly separate from methods available to endpoints from other ASes. Specifically, expensive recursive path segment and trust material lookups are thus shielded from abuse by unauthorized entities.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">For RPC methods exposed to other ASes, the Control Service implementation minimizes its attack surface by rejecting illegitimate callers based on ISD/AS, path type and length and any other available data points as soon as possible, i.e. immediately after determining the request type. For example:<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-6.1">
            <p id="section-7.4-6.1.1"><code>SegmentCreationService.Beacon</code> can only be called by direct neighbors and thus calls from peers with a path length greater than one can immediately be discarded.<a href="#section-7.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-6.2">
            <p id="section-7.4-6.2.1"><code>SegmentRegistrationService.SegmentsRegistration</code> can only be called from within the same ISD, thus the source address <span class="bcp14">MUST</span> match the local ISD and the number of path segments <span class="bcp14">MUST</span> be 1.<a href="#section-7.4-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-7">A combination of the mechanism above is used to prevent flooding attacks on the Control Service. In addition, the Control Service <span class="bcp14">SHOULD</span> be deployed in a distributed and replicated manner so that requests can be balanced and a single instance failure does not result in a complete failure of the control plane of a SCION AS.<a href="#section-7.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The ISD and SCION AS number are SCION-specific numbers. They are currently allocated by Anapaya Systems, a provider of SCION-based networking software and solutions (see <span>[<a href="#ISD-AS-assignments" class="cite xref">ISD-AS-assignments</a>]</span>). This task is currently being transitioned from Anapaya to the SCION Association.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="Connect">[Connect]</dt>
        <dd>
<span class="refTitle">"Connect Protocol Reference"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://connectrpc.com/docs/protocol/">https://connectrpc.com/docs/protocol/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="gRPC">[gRPC]</dt>
        <dd>
<span class="refTitle">"gRPC, an open-source universal RPC framework"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://grpc.io/">https://grpc.io/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-scion-dataplane">[I-D.dekater-scion-dataplane]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, <span class="refAuthor">Hugly, J.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Data Plane"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-scion-dataplane-05</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-scion-dataplane-05">https://datatracker.ietf.org/doc/html/draft-dekater-scion-dataplane-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-scion-pki">[I-D.dekater-scion-pki]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Control Plane PKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-scion-pki-09</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-scion-pki-09">https://datatracker.ietf.org/doc/html/draft-dekater-scion-pki-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="proto3">[proto3]</dt>
        <dd>
<span class="refTitle">"Protocol Buffers Language Guide version 3"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://protobuf.dev/programming-guides/proto3/">https://protobuf.dev/programming-guides/proto3/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4632">[RFC4632]</dt>
        <dd>
<span class="refAuthor">Fuller, V.</span> and <span class="refAuthor">T. Li</span>, <span class="refTitle">"Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan"</span>, <span class="seriesInfo">BCP 122</span>, <span class="seriesInfo">RFC 4632</span>, <span class="seriesInfo">DOI 10.17487/RFC4632</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4632">https://www.rfc-editor.org/rfc/rfc4632</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5952">[RFC5952]</dt>
        <dd>
<span class="refAuthor">Kawamura, S.</span> and <span class="refAuthor">M. Kawashima</span>, <span class="refTitle">"A Recommendation for IPv6 Address Text Representation"</span>, <span class="seriesInfo">RFC 5952</span>, <span class="seriesInfo">DOI 10.17487/RFC5952</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5952">https://www.rfc-editor.org/rfc/rfc5952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9114">[RFC9114]</dt>
      <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9114">https://www.rfc-editor.org/rfc/rfc9114</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BollRio-2000">[BollRio-2000]</dt>
        <dd>
<span class="refAuthor">Bollobás, B.</span> and <span class="refAuthor">O. Riordan</span>, <span class="refTitle">"The diameter of a scale-free random graph"</span>, <span>n.d.</span>, <span>&lt;<a href="https://kam.mff.cuni.cz/~ksemweb/clanky/BollobasR-scale_free_random.pdf">https://kam.mff.cuni.cz/~ksemweb/clanky/BollobasR-scale_free_random.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHUAT22">[CHUAT22]</dt>
        <dd>
<span class="refAuthor">Chuat, L.</span>, <span class="refAuthor">Legner, M.</span>, <span class="refAuthor">Basin, D.</span>, <span class="refAuthor">Hausheer, D.</span>, <span class="refAuthor">Hitz, S.</span>, <span class="refAuthor">Mueller, P.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"The Complete Guide to SCION"</span>, <span class="seriesInfo">ISBN 978-3-031-05287-3</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-031-05288-0">https://doi.org/10.1007/978-3-031-05288-0</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-panrg-scion-overview">[I-D.dekater-panrg-scion-overview]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"SCION Overview"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-panrg-scion-overview-06</span>, <time datetime="2024-05-07" class="refDate">7 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-panrg-scion-overview-06">https://datatracker.ietf.org/doc/html/draft-dekater-panrg-scion-overview-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISD-AS-assignments">[ISD-AS-assignments]</dt>
        <dd>
<span class="refTitle">"SCION ISD and AS Assignments"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://docs.anapaya.net/en/latest/resources/isd-as-assignments/">https://docs.anapaya.net/en/latest/resources/isd-as-assignments/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1122">https://www.rfc-editor.org/rfc/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4893">[RFC4893]</dt>
        <dd>
<span class="refAuthor">Vohra, Q.</span> and <span class="refAuthor">E. Chen</span>, <span class="refTitle">"BGP Support for Four-octet AS Number Space"</span>, <span class="seriesInfo">RFC 4893</span>, <span class="seriesInfo">DOI 10.17487/RFC4893</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4893">https://www.rfc-editor.org/rfc/rfc4893</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5398">[RFC5398]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Autonomous System (AS) Number Reservation for Documentation Use"</span>, <span class="seriesInfo">RFC 5398</span>, <span class="seriesInfo">DOI 10.17487/RFC5398</span>, <time datetime="2008-12" class="refDate">December 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5398">https://www.rfc-editor.org/rfc/rfc5398</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6996">[RFC6996]</dt>
        <dd>
<span class="refAuthor">Mitchell, J.</span>, <span class="refTitle">"Autonomous System (AS) Reservation for Private Use"</span>, <span class="seriesInfo">BCP 6</span>, <span class="seriesInfo">RFC 6996</span>, <span class="seriesInfo">DOI 10.17487/RFC6996</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6996">https://www.rfc-editor.org/rfc/rfc6996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9217">[RFC9217]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refTitle">"Current Open Questions in Path-Aware Networking"</span>, <span class="seriesInfo">RFC 9217</span>, <span class="seriesInfo">DOI 10.17487/RFC9217</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9217">https://www.rfc-editor.org/rfc/rfc9217</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9473">[RFC9473]</dt>
        <dd>
<span class="refAuthor">Enghardt, R.</span> and <span class="refAuthor">C. Krähenbühl</span>, <span class="refTitle">"A Vocabulary of Path Properties"</span>, <span class="seriesInfo">RFC 9473</span>, <span class="seriesInfo">DOI 10.17487/RFC9473</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9473">https://www.rfc-editor.org/rfc/rfc9473</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCIONLAB">[SCIONLAB]</dt>
        <dd>
<span class="refAuthor">Kown, J.</span>, <span class="refAuthor">García-Pardo, J.</span>, <span class="refAuthor">Legner, M.</span>, <span class="refAuthor">Wirz, F.</span>, <span class="refAuthor">Frei, M.</span>, <span class="refAuthor">Hausheer, D.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"SCIONLAB - A Next-Generation Internet Testbed"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/abstract/document/9259355">https://ieeexplore.ieee.org/abstract/document/9259355</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCMP">[SCMP]</dt>
      <dd>
<span class="refAuthor">Anapaya</span>, <span class="refAuthor">ETH</span>, and <span class="refAuthor">SCION</span>, <span class="refTitle">"SCMP Documentation"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://docs.scion.org/en/latest/protocols/scmp.html">https://docs.scion.org/en/latest/protocols/scmp.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Many thanks go to William Boye (Swiss National Bank), Matthias Frei (SCION Association), Kevin Meynell (SCION Association), Juan A. Garcia Prado (ETH Zurich), and Roger Lapuh (Extreme Networks) for reviewing this document. We also thank Daniel Galán Pascual and Christoph Sprenger from the Information Security Group at ETH Zurich for their inputs based on their formal verification work on SCION. We are also very grateful to Adrian Perrig (ETH Zurich), for providing guidance and feedback about every aspect of SCION. Finally, we are indebted to the SCION development teams of Anapaya, ETH Zurich, and the SCION Association for their practical knowledge and for the documentation about the SCION Control Plane, as well as to the authors of <span>[<a href="#CHUAT22" class="cite xref">CHUAT22</a>]</span> - the book is an important source of input and inspiration for this draft.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deployment-testing-scionlab">
<section id="appendix-B">
      <h2 id="name-deployment-testing-scionlab">
<a href="#name-deployment-testing-scionlab" class="section-name selfRef">Deployment Testing: SCIONLab</a>
      </h2>
<p id="appendix-B-1">SCIONLab is a global research network that is available to test the SCION architecture. You can create and use your ASes using your own computation resources which allows you to gain real-world experience of deploying and managing a SCION network.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">More information can be found on the SCIONLab website and in the <span>[<a href="#SCIONLAB" class="cite xref">SCIONLAB</a>]</span> paper.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app-a">
<section id="appendix-C">
      <h2 id="name-full-control-service-grpc-a">
<a href="#name-full-control-service-grpc-a" class="section-name selfRef">Full Control Service gRPC API</a>
      </h2>
<p id="appendix-C-1">The following code blocks provide, in protobuf format, the entire API by which control services interact.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<span id="name-control-service-grpc-api-se"></span><div id="_figure-31">
<figure id="figure-25">
        <div class="alignLeft art-text artwork" id="appendix-C-2.1">
<pre>
service SegmentLookupService {
    // Segments returns all segments that match the request.
    rpc Segments(SegmentsRequest) returns (SegmentsResponse) {}
}

message SegmentsRequest {
    // The source ISD-AS of the segment.
    uint64 src_isd_as = 1;
    // The destination ISD-AS of the segment.
    uint64 dst_isd_as = 2;
}

enum SegmentType {
    // Unknown segment type.
    SEGMENT_TYPE_UNSPECIFIED = 0;
    // Up segment.
    SEGMENT_TYPE_UP = 1;
    // Down segment.
    SEGMENT_TYPE_DOWN = 2;
    // Core segment.
    SEGMENT_TYPE_CORE = 3;
}

message SegmentsResponse {
    message Segments {
        // List of path segments.
        repeated PathSegment segments = 1;
    }

    // Mapping from path segment type to path segments.
    // The key is the integer representation of the SegmentType enum.
    map&lt;int32, Segments&gt; segments = 1;
}
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-control-service-grpc-api-se" class="selfRef">Control Service gRPC API - Segment lookup.    This API is exposed on the SCION dataplane by the control    services of core ASes and exposed on the intra-domain protocol    network.</a>
        </figcaption></figure>
</div>
<p id="appendix-C-3"><br></p>
<span id="name-control-service-grpc-api-seg"></span><div id="_figure-32">
<figure id="figure-26">
        <div class="alignLeft art-text artwork" id="appendix-C-4.1">
<pre>
service SegmentRegistrationService {
    // SegmentsRegistration registers segments at the remote.
    rpc SegmentsRegistration(SegmentsRegistrationRequest) returns (
        SegmentsRegistrationResponse) {}
}

message SegmentsRegistrationRequest {
    message Segments {
        // List of path segments.
        repeated PathSegment segments = 1;
    }

    // Mapping from path segment type to path segments.
    // The key is the integer representation of the SegmentType enum.
    map&lt;int32, Segments&gt; segments = 1;
}

message SegmentsRegistrationResponse {}
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-control-service-grpc-api-seg" class="selfRef">Control Service gRPC API - Segment registration.    This API is only exposed by core ASes and only on the SCION    dataplane.</a>
        </figcaption></figure>
</div>
<p id="appendix-C-5"><br></p>
<span id="name-control-service-grpc-api-segm"></span><div id="_figure-33">
<figure id="figure-27">
        <div class="alignLeft art-text artwork" id="appendix-C-6.1">
<pre>
service SegmentCreationService {
    // Beacon sends a beacon to the remote control service.
    rpc Beacon(BeaconRequest) returns (BeaconResponse) {}
}

message BeaconRequest {
    // Beacon in form of a partial path segment.
    PathSegment segment = 1;
}

message BeaconResponse {}
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-control-service-grpc-api-segm" class="selfRef">Control Service gRPC API - Segment creation</a>
        </figcaption></figure>
</div>
<p id="appendix-C-7"><br></p>
<span id="name-control-service-grpc-api-segme"></span><div id="_figure-34">
<figure id="figure-28">
        <div class="alignLeft art-text artwork" id="appendix-C-8.1">
<pre>
message PathSegment {
    // The encoded SegmentInformation. It is used for signature input.
    bytes segment_info = 1;
    // Entries of ASes on the path.
    repeated ASEntry as_entries = 2;
}

message SegmentInformation {
    // Segment creation time set by the originating AS. Segment
    // expiration time is computed relative to this timestamp.
    // The timestamp is encoded as the number of seconds elapsed
    // since January 1, 1970 UTC.
    int64 timestamp = 1;
    // The 16-bit segment ID integer used for MAC computation.
    uint32 segment_id = 2;
}

message ASEntry {
    // The signed part of the AS entry. The body of the SignedMessage
    // is the serialized ASEntrySignedBody. The signature input is
    // defined as follows:
    //
    //  input(ps, i) = signed.header_and_body || associated_data(ps, i)
    //
    //  associated_data(ps, i) =
    //          ps.segment_info ||
    //          ps.as_entries[1].signed.header_and_body ||
    //          ps.as_entries[1].signed.signature ||
    //          ...
    //          ps.as_entries[i-1].signed.header_and_body ||
    //          ps.as_entries[i-1].signed.signature
    //
    proto.crypto.v1.SignedMessage signed = 1;
    // The unsigned part of the AS entry.
    proto.control_plane.v1.PathSegmentUnsignedExtensions unsigned = 2;
}

message SignedMessage {
    // Encoded header and body.
    bytes header_and_body = 1;
    // Raw signature. The signature is computed over the concatenation
    // of the header and body, and the optional associated data.
    bytes signature = 2;
}

message HopEntry {
    // Material to create the data-plane Hop Field.
    HopField hop_field = 1;
    // MTU on the ingress link.
    uint32 ingress_mtu = 2;
}

message PeerEntry {
    // ISD-AS of peer AS. This is used to match peering segments
    // during path construction.
    uint64 peer_isd_as = 1;
    // Remote peer interface identifier. This is used to match
    // peering segments
    // during path construction.
    uint64 peer_interface = 2;
    // MTU on the peering link.
    uint32 peer_mtu = 3;
    // Material to create the data-plane Hop Field
    HopField hop_field = 4;
}

message HopField {
    // Ingress interface identifier.
    uint64 ingress = 1;
    // Egress interface identifier.
    uint64 egress = 2;
    // 8-bit encoded expiration offset relative to the segment
    // creation timestamp.
    uint32 exp_time = 3;
    // MAC used in the dataplane to verify the Hop Field.
    bytes mac = 4;
}
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-control-service-grpc-api-segme" class="selfRef">Control Service gRPC API - Segment representation</a>
        </figcaption></figure>
</div>
<p id="appendix-C-9"><br></p>
<span id="name-control-service-grpc-api-si"></span><div id="_figure-35">
<figure id="figure-29">
        <div class="alignLeft art-text artwork" id="appendix-C-10.1">
<pre>
enum SignatureAlgorithm {
    // Unspecified signature algorithm. This value is never valid.
    SIGNATURE_ALGORITHM_UNSPECIFIED = 0;
    // ECDS with SHA256.
    SIGNATURE_ALGORITHM_ECDSA_WITH_SHA256 = 1;
    // ECDS with SHA384.
    SIGNATURE_ALGORITHM_ECDSA_WITH_SHA384 = 2;
    // ECDS with SHA512.
    SIGNATURE_ALGORITHM_ECDSA_WITH_SHA512 = 3;
}

// Low-level representation of HeaderAndBody used for signature
// computation input. This should not be used by external code.
message HeaderAndBodyInternal {
    // Encoded header suitable for signature computation.
    bytes header = 1;
    // Raw payload suitable for signature computation.
    bytes body = 2;
}

message Header {
    // Algorithm used to compute the signature.
    SignatureAlgorithm signature_algorithm = 1;
    // Optional arbitrary per-protocol key identifier.
    bytes verification_key_id = 2;
    // Optional signature creation timestamp.
    google.protobuf.Timestamp timestamp = 3;
    // Optional arbitrary per-protocol metadata.
    bytes metadata = 4;
    // Length of associated data that is covered by the signature, but
    // is not included in the header and body. This is zero, if no
    // associated data is covered by the signature.
    int32 associated_data_length = 5;
}

message ASEntrySignedBody {
    // ISD-AS of the AS that created this AS entry.
    uint64 isd_as = 1;
    // ISD-AS of the downstream AS.
    uint64 next_isd_as = 2;
    // The required regular hop entry.
    HopEntry hop_entry = 3;
    // Optional peer entries.
    repeated PeerEntry peer_entries = 4;
    // Intra AS MTU.
    uint32 mtu = 5;
    // Optional extensions.
    proto.control_plane.v1.PathSegmentExtensions extensions = 6;
}

message VerificationKeyID {
    uint64 isd_as = 1;
    bytes subject_key_id = 2;
    uint64 trc_base = 3;
    uint64 trc_serial = 4;
}
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-control-service-grpc-api-si" class="selfRef">Control Service gRPC API - Signed ASEntry representation</a>
        </figcaption></figure>
</div>
<p id="appendix-C-11"><br></p>
<span id="name-control-service-grpc-api-tr"></span><div id="_figure-36">
<figure id="figure-30">
        <div class="alignLeft art-text artwork" id="appendix-C-12.1">
<pre>
service TrustMaterialService {
    // Return the certificate chains that match the request.
    rpc Chains(ChainsRequest) returns (ChainsResponse) {}
    // Return a specific TRC that matches the request.
    rpc TRC(TRCRequest) returns (TRCResponse) {}
}

message ChainsRequest {
    // ISD-AS of Subject in the AS certificate.
    uint64 isd_as = 1;
    // SubjectKeyID in the AS certificate.
    bytes subject_key_id = 2;
    // Point in time at which the AS certificate must still be valid. In seconds
    // since UNIX epoch.
    google.protobuf.Timestamp at_least_valid_until = 3;
    // Point in time at which the AS certificate must be or must have been
    // valid. In seconds since UNIX epoch.
    google.protobuf.Timestamp at_least_valid_since = 4;
}

message ChainsResponse {
    // List of chains that match the request.
    repeated Chain chains = 1;
}

message Chain {
    // AS certificate in the chain.
    bytes as_cert = 1;
    // CA certificate in the chain.
    bytes ca_cert = 2;
}

message TRCRequest {
    // ISD of the TRC.
    uint32 isd = 1;
    // BaseNumber of the TRC.
    uint64 base = 2;
    // SerialNumber of the TRC.
    uint64 serial = 3;
}

message TRCResponse {
    // Raw TRC.
    bytes trc = 1;
}

// VerificationKeyID is used to identify certificates that authenticate the
// verification key used to verify signatures.
message VerificationKeyID {
    // ISD-AS of the subject.
    uint64 isd_as = 1;
    // SubjectKeyID referenced in the certificate.
    bytes subject_key_id = 2;
    // Base number of the latest TRC available to the signer at the time of
    // signature creation.
    uint64 trc_base = 3;
    // Serial number of the latest TRC available to the signer at the time of
    // signature creation.
    uint64 trc_serial = 4;
}
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-control-service-grpc-api-tr" class="selfRef">Control Service gRPC API - Trust Material representation</a>
        </figcaption></figure>
</div>
<p id="appendix-C-13"><br></p>
<p id="appendix-C-14">In case of failure, gRPC calls return an error as specified by the gRPC framework. That is, a non-zero status code and an explanatory string.<a href="#appendix-C-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app-b">
<section id="appendix-D">
      <h2 id="name-scion-data-plane-use-by-the">
<a href="#name-scion-data-plane-use-by-the" class="section-name selfRef">SCION Data Plane use by the SCION Control Plane</a>
      </h2>
<p id="appendix-D-1">The SCION Control Plane RPC APIs rely on QUIC connections carried by the SCION dataplane. The main difference between QUIC over native UDP and QUIC over UDP/SCION is the need for a UDP/SCION connection initiator to identify the relevant peer (service resolution) and to select a path to it. Since the Control Service is itself the source of path segment information, the following bootstrapping strategies apply:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1">
          <p id="appendix-D-2.1.1">Neighboring ASes craft one-hop-paths directly. This allows multihop paths to be constructed and propagated incrementally.<a href="#appendix-D-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-2.2">
          <p id="appendix-D-2.2.1">Constructed multihop paths are registered with the Control Service at the origin core AS. The path to that AS is the very path being registered.<a href="#appendix-D-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-2.3">
          <p id="appendix-D-2.3.1">Paths to far ASes are available from neighboring ASes. Clients obtain paths to remote ASes from their local Control Service.<a href="#appendix-D-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-2.4">
          <p id="appendix-D-2.4.1">Control services respond to requests from remote ASes by reversing the path via which the request came.<a href="#appendix-D-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-2.5">
          <p id="appendix-D-2.5.1">Clients find the relevant Control Service endpoint by resolving a "service address" (that is an address where the <code>DT/DL</code> field of the common header is set to 1/0 (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>).<a href="#appendix-D-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-3">The mechanics of service address resolution are the following:<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-4.1">
          <p id="appendix-D-4.1.1">To resolve the address of the control service at a given AS, a client sends a ServiceResolutionRequest RPC (which has no parameters) to an endpoint address constructed as follows:<a href="#appendix-D-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-4.1.2.1">
              <p id="appendix-D-4.1.2.1.1">Common Header:<a href="#appendix-D-4.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-4.1.2.1.2.1">
                  <p id="appendix-D-4.1.2.1.2.1.1">Path type: SCION (0x01)<a href="#appendix-D-4.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-D-4.1.2.1.2.2">
                  <p id="appendix-D-4.1.2.1.2.2.1">DT/DL: "Service" (0b0100)<a href="#appendix-D-4.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-4.1.2.2">
              <p id="appendix-D-4.1.2.2.1">Address Header:<a href="#appendix-D-4.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-4.1.2.2.2.1">
                  <p id="appendix-D-4.1.2.2.2.1.1">DstHostAddr: "SVC_CS" (0x0002)<a href="#appendix-D-4.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-D-4.1.2.3">
              <p id="appendix-D-4.1.2.3.1">UDP Header:<a href="#appendix-D-4.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-4.1.2.3.2.1">
                  <p id="appendix-D-4.1.2.3.2.1.1">DstPort: 0<a href="#appendix-D-4.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-D-4.2">
          <p id="appendix-D-4.2.1">The ingress border router at the destination AS resolves the service destination to an actual endpoint address. This document does not mandate any specific method for this resolution.<a href="#appendix-D-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-4.3">
          <p id="appendix-D-4.3.1">The ingress border router forwards the message to the resolved address.<a href="#appendix-D-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-4.4">
          <p id="appendix-D-4.4.1">The destination service responds to the client with a ServiceResolutionResponse. That response contain one or more transport options.<a href="#appendix-D-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-4.5">
          <p id="appendix-D-4.5.1">The client uses the address and port from the "QUIC" option to establish a QUIC connection, which can then be used for regular RPCs.<a href="#appendix-D-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-5">The following code block provides the full service resolution API in the Protobuf message format.<a href="#appendix-D-5" class="pilcrow">¶</a></p>
<span id="name-service-resolution-grpc-api"></span><div id="_figure-40">
<figure id="figure-31">
        <div class="alignLeft art-text artwork" id="appendix-D-6.1">
<pre>
package proto.control_plane.v1;

// A ServiceResolutionRequest must always fit within a UDP datagram. If
// the request does not fit, there is no mechanism for clients and
// servers to establish control-plane reachability.
message ServiceResolutionRequest {}

// A ServiceResolutionResponse must always fit within a UDP datagram. If
// the response does not fit, there is no mechanism for clients and
// servers to establish control-plane reachability.
message ServiceResolutionResponse {
    // Supported transports to reach the service,
    //
    // List of known transports:
    // - QUIC
    //
    // Unknown values should be ignored by clients.
    map&lt;string, Transport&gt; transports = 1;
}

message Transport {
    // Protocol specific server address descriptor.
    //
    // Supported address format for QUIC:
    //  192.168.0.1:80
    //  [2001:db8::1]:80
    //
    //  Missing ports / zero port / invalid port values should be
    // treated by clients as errors.
    string address = 1;
}

</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-service-resolution-grpc-api" class="selfRef">Service Resolution gRPC API definition</a>
        </figcaption></figure>
</div>
<p id="appendix-D-7"><br></p>
</section>
</div>
<div id="app-c">
<section id="appendix-E">
      <h2 id="name-path-lookup-examples">
<a href="#name-path-lookup-examples" class="section-name selfRef">Path-Lookup Examples</a>
      </h2>
<p id="appendix-E-1">To illustrate how the path lookup works, we show two path-lookup examples in sequence diagrams. The network topology of the examples is represented in <a href="#_figure-41" class="auto internal xref">Figure 32</a> below. In both examples, the source endpoint is in AS A. <a href="#_figure-42" class="auto internal xref">Figure 33</a> shows the sequence diagram for the path lookup process in case the destination is in AS D, whereas <a href="#_figure-43" class="auto internal xref">Figure 34</a> shows the path lookup sequence diagram if the destination is in AS G. ASes B and C are core ASes in the source ISD, while E and F are core ASes in a remote ISD. Core AS B is a provider of the local AS, but AS C is not, i.e. there is no up-segment from A to C. "CS" stands for Control Service.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<span id="name-topology-used-in-the-path-l"></span><div id="_figure-41">
<figure id="figure-32">
        <div class="alignLeft art-text artwork" id="appendix-E-2.1">
<pre>
┌────────────────────────────┐     ┌────────────────────────────┐
│                            │     │                            │
│                            │     │                            │
│    ┌┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┐    │     │    ┌┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┐    │
│    ┆       Core       ┆    │     │    ┆       Core       ┆    │
│    ┆                  ┆    │     │    ┆                  ┆    │
│    ┆ ┌─────┐  ┌─────┐ ┆    │     │    ┆          ┌─────┐ ┆    │
│    ┆ │AS C ├──┤AS B ├────────────────────────────┤AS F │ ┆    │
│    ┆ └─┬───┘  └┬─┬─┬┘ ┆    │     │    ┆ ┌─────┐  └─┬─┬─┘ ┆    │
│    ┆   │       │ │ └────────────────────┤AS E ├────┘ │   ┆    │
│    ┆   │       │ │    ┆    │     │    ┆ └──┬──┘      │   ┆    │
│    └┄┄┄│┄┄┄┄┄┄┄│┄│┄┄┄┄┘    │     │    └┄┄┄┄│┄┄┄┄┄┄┄┄┄│┄┄┄┘    │
│        │       │ │         │     │         │         │        │
│        │       │ │         │     │         │         │        │
│        │ ┌─────┘ │         │     │         │         │        │
│        │ │       │         │     │         │         │        │
│        │ │       │         │     │         │         │        │
│      ┌─┴─┴─┐  ┌──┴──┐      │     │      ┌──┴──┐      │        │
│      │AS D │  │AS A │      │     │      │AS G ├──────┘        │
│      └─────┘  └─────┘      │     │      └─────┘               │
│                            │     │                            │
│            ISD 1           │     │            ISD 2           │
└────────────────────────────┘     └────────────────────────────┘
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-topology-used-in-the-path-l" class="selfRef">Topology used in the path lookup examples.</a>
        </figcaption></figure>
</div>
<span id="name-sequence-diagram-illustrati"></span><div id="_figure-42">
<figure id="figure-33">
        <div class="alignLeft art-text artwork" id="appendix-E-3.1">
<pre>
┌─────────┐          ┌─────────┐          ┌─────────┐         ┌─────────┐
│Endpoint │          │Source AS│          │ Core AS │         │ Core AS │
│         │          │ CS (A)  │          │ CS (B)  │         │ CS (C)  │
└──┬─┬─┬──┘          └────┬────┘          └────┬────┘         └────┬────┘
   │ │ │                  │                    │                   │
   │ │ │                  │                    │                   │
┌──┴─┴─┴──────┐           │                    │                   │
│Send Requests│           │                    │                   │
│ in parallel │           │                    │                   │
└──┬─┬─┬──────┘           │                    │                   │
   │ │ │                  │                    │                   │
   │ │ │request (up)      │                    │                   │
   ├─────────────────────▶│                    │                   │
   │◀─ ── ── ── ── ── ── ─┤                    │                   │
   │ │ │ reply (up,[A-&gt;B])│                    │                   │
   │ │ │                  │                    │                   │
   │ │ │                  │                    │                   │
   │ │ │request (core,*,*)│                    │                   │
   │ ├───────────────────▶│                    │                   │
   │ │ │                  │request (core,B,*)  │                   │
   │ │ │                  ├───────────────────▶│                   │
   │ │ │                  │◀── ── ── ── ── ── ─┤                   │
   │ │ │                  │  reply(core,[B-&gt;C])│                   │
   │ │◀── ── ── ── ── ── ─┤                    │                   │
   │ │ │ reply (core,[B-&gt;C])                   │                   │
   │ │ │                  │                    │                   │
   │ │ │                  │                    │                   │
   │ │ │request (down,*,D)│                    │                   │
   │ │ │           ┌──────┴──────┐             │                   │
   │ │ ├──────────▶│send requests│             │                   │
   │ │ │           │ in parallel │             │                   │
   │ │ │           └─────┬─┬─────┘             │                   │
   │ │ │                 │ │                   │                   │
   │ │ │                 │ │request (down,B,D) │                   │
   │ │ │                 ├────────────────────▶│                   │
   │ │ │                 │◀─ ── ── ── ── ── ── ┤                   │
   │ │ │                 │ │ reply(down,[B-&gt;D])│                   │
   │ │ │                 │ │                   │                   │
   │ │ │                 │ │                   │request (down,C,D) │
   │ │ │                 │ ├──────────────────────────────────────▶│
   │ │ │                 │ │◀─ ── ── ── ── ── ── ── ── ── ── ── ── ┤
   │ │ │                 │ │                   │ reply(down,[C-&gt;D])│
   │ │ │                 │ │                   │                   │
   │ │ │◀─ ── ── ── ── ──└┬┘                   │                   │
   │ │ │ reply (down,[B-&gt;D, C-&gt;D])             │                   │
   │ │ │                  │                    │                   │
┌──┴─┴─┴─────────┐        │                    │                   │
│Combine Segments│        │                    │                   │
└────┬───────────┘        │                    │                   │
     │                    │                    │                   │
     ┆                    ┆                    ┆                   ┆
     ┆                    ┆                    ┆                   ┆
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-sequence-diagram-illustrati" class="selfRef">Sequence diagram illustrating a path lookup for a destination D in the source ISD. The request (core, x, x) is for all pairs of core ASes in the source ISD. Similarly, (down, x, D) is for down segments between any core AS in the source ISD and destination D.</a>
        </figcaption></figure>
</div>
<span id="name-sequence-diagram-illustratin"></span><div id="_figure-43">
<figure id="figure-34">
        <div class="alignLeft art-text artwork" id="appendix-E-4.1">
<pre>
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│Endpoint │     │Source AS│     │ Core AS │     │ Core AS │     │ Core AS │
│         │     │ CS (A)  │     │ CS (B)  │     │ CS (E)  │     │ CS (F)  │
└──┬─┬─┬──┘     └────┬────┘     └────┬────┘     └────┬────┘     └────┬────┘
   │ │ │             │               │               │               │
   │ │ │             │               │               │               │
┌──┴─┴─┴──────┐      │               │               │               │
│Send Requests│      │               │               │               │
│ in parallel │      │               │               │               │
└──┬─┬─┬──────┘      │               │               │               │
   │ │ │             │               │               │               │
   │ │ │request (up) │               │               │               │
   ├────────────────▶│               │               │               │
   │ │ │             │               │               │               │
   │◀── ── ── ── ── ─┤               │               │               │
   │ │ │ reply (up,[A-&gt;B])           │               │               │
   │ │ │             │               │               │               │
   │ │ │             │               │               │               │
   │ │ │request (core,*,(2,*))       │               │               │
   │ ├──────────────▶│               │               │               │
   │ │ │             │request (core,*,(2,*))         │               │
   │ │ │             │──────────────▶                │               │
   │ │ │             │◀─ ── ── ── ── ┤               │               │
   │ │ │             │ reply (core,[B-&gt;E,B-&gt;F])      │               │
   │ │◀─ ── ── ── ── ┤               │               │               │
   │ │ │ reply (core,[B-&gt;E,B-&gt;F])    │               │               │
   │ │ │             │               │               │               │
   │ │ │             │               │               │               │
   │ │ │request (down,(2,*),G)       │               │               │
   │ │ │      ┌──────┴──────┐        │               │               │
   │ │ ├─────▶│send requests│        │               │               │
   │ │ │      │ in parallel │        │               │               │
   │ │ │      └─────┬─┬─────┘        │               │               │
   │ │ │            │ │              │request (down,E,G)             │
   │ │ │            ├───────────────────────────────▶│               │
   │ │ │            │◀── ── ── ── ── ── ── ── ── ── ─┤               │
   │ │ │            │ │              │ reply (down,[E-&gt;G])           │
   │ │ │            │ │              │               │               │
   │ │ │            │ │              │               │               │
   │ │ │            │ │              │               │request (down,F,G)
   │ │ │            │ ├─────────────────────────────────────────────▶│
   │ │ │            │ │◀── ── ── ── ── ── ── ── ── ── ── ── ── ── ── ┤
   │ │ │            │ │              │               │ reply (down,[F-&gt;G])
   │ │ │◀─ ── ── ── └┬┘              │               │               │
   │ │ │ reply (down,[E-&gt;G,F-&gt;G])    │               │               │
   │ │ │             │               │               │               │
┌──┴─┴─┴─────────┐   │               │               │               │
│Combine Segments│   │               │               │               │
└────┬───────────┘   │               │               │               │
     │               │               │               │               │
     ┆               ┆               ┆               ┆               ┆
     ┆               ┆               ┆               ┆               ┆
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-sequence-diagram-illustratin" class="selfRef">Sequence diagram illustrating a path lookup for a destination G in a remote ISD. The request (core, x, (2, x)) is for all path segments between a core AS in the source ISD and a core AS in ISD 2. Similarly, (down, (2, x), G) is for down segments between any core AS in ISD 2 and destination G.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-F">
      <h2 id="name-change-log">
<a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-F-1">Changes made to drafts since ISE submission. This section is to be removed before publication.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<div id="draft-dekater-scion-controlplane-08">
<section id="appendix-F.1">
        <h3 id="name-draft-dekater-scion-control">
<a href="#name-draft-dekater-scion-control" class="section-name selfRef">draft-dekater-scion-controlplane-08</a>
        </h3>
<p id="appendix-F.1-1">Major changes:<a href="#appendix-F.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.1-2.1">
            <p id="appendix-F.1-2.1.1">Abstract: reword, mention goal and that document is not an Internet Standard<a href="#appendix-F.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.1-2.2">
            <p id="appendix-F.1-2.2.1">"Propagation of PCBs" section:<a href="#appendix-F.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.1-2.2.2.1">
                <p id="appendix-F.1-2.2.2.1.1">clarify checks at reception<a href="#appendix-F.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-F.1-2.2.2.2">
                <p id="appendix-F.1-2.2.2.2.1">introduce criteria for PCB selection policies<a href="#appendix-F.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-F.1-2.2.2.3">
                <p id="appendix-F.1-2.2.2.3.1">remove superfluous policy example figure<a href="#appendix-F.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-F.1-2.2.2.4">
                <p id="appendix-F.1-2.2.2.4.1">Propagation Interval and Best PCBs Set Size: mention tradeoff between scalability and amount of paths discovered.<a href="#appendix-F.1-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-F.1-2.2.2.5">
                <p id="appendix-F.1-2.2.2.5.1">reorganize order of paragraphs<a href="#appendix-F.1-2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-F.1-2.3">
            <p id="appendix-F.1-2.3.1">New section "Security Properties" in Security considerations, based on formal model of SCION<a href="#appendix-F.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.1-2.4">
            <p id="appendix-F.1-2.4.1">New figure: Control Service gRPC API - Trust Material definitions<a href="#appendix-F.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-F.1-3">Minor changes:<a href="#appendix-F.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.1-4.1">
            <p id="appendix-F.1-4.1.1">Moved "Special-Purpose SCION AS Numbers" table later in text<a href="#appendix-F.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.1-4.2">
            <p id="appendix-F.1-4.2.1">Split "Circular dependencies and partitioning" into two sections: "Bootstrapping ability" and "Resistance to partitioning".<a href="#appendix-F.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.1-4.3">
            <p id="appendix-F.1-4.3.1">Explain why PCBs have a next_isd_as field<a href="#appendix-F.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.1-4.4">
            <p id="appendix-F.1-4.4.1">Qualified better the choice of time allowance in the definition of segment from the future in section "PCB Validity".<a href="#appendix-F.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-07">
<section id="appendix-F.2">
        <h3 id="name-draft-dekater-scion-controlp">
<a href="#name-draft-dekater-scion-controlp" class="section-name selfRef">draft-dekater-scion-controlplane-07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-F.2-1.1">
            <p id="appendix-F.2-1.1.1">Moved SCMP specification from draft-dekater-scion-dataplane-03 to this document<a href="#appendix-F.2-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-06">
<section id="appendix-F.3">
        <h3 id="name-draft-dekater-scion-controlpl">
<a href="#name-draft-dekater-scion-controlpl" class="section-name selfRef">draft-dekater-scion-controlplane-06</a>
        </h3>
<p id="appendix-F.3-1">Major changes:<a href="#appendix-F.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.3-2.1">
            <p id="appendix-F.3-2.1.1">New section: Path MTU<a href="#appendix-F.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-2.2">
            <p id="appendix-F.3-2.2.1">New section: Monitoring Considerations<a href="#appendix-F.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-2.3">
            <p id="appendix-F.3-2.3.1">Completed description of Control Services gRPC API in appendix<a href="#appendix-F.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-F.3-3">Minor changes:<a href="#appendix-F.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.3-4.1">
            <p id="appendix-F.3-4.1.1">Introduction: clarify goal of the document<a href="#appendix-F.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-4.2">
            <p id="appendix-F.3-4.2.1">Clarify typical vs recommended-limits values for best PCB set size and for certificate validity duration.<a href="#appendix-F.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-4.3">
            <p id="appendix-F.3-4.3.1">Clarify text representation of ISD-AS<a href="#appendix-F.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-4.4">
            <p id="appendix-F.3-4.4.1">General rewording<a href="#appendix-F.3-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-4.5">
            <p id="appendix-F.3-4.5.1">Added reference to SCIONLab as a testbed for implementors<a href="#appendix-F.3-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.3-4.6">
            <p id="appendix-F.3-4.6.1">Introduced this change log<a href="#appendix-F.3-4.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-05">
<section id="appendix-F.4">
        <h3 id="name-draft-dekater-scion-controlpla">
<a href="#name-draft-dekater-scion-controlpla" class="section-name selfRef">draft-dekater-scion-controlplane-05</a>
        </h3>
<p id="appendix-F.4-1">Minor changes:<a href="#appendix-F.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.4-2.1">
            <p id="appendix-F.4-2.1.1">Clarify beaconing fast retry at bootstrapping<a href="#appendix-F.4-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-04">
<section id="appendix-F.5">
        <h3 id="name-draft-dekater-scion-controlplan">
<a href="#name-draft-dekater-scion-controlplan" class="section-name selfRef">draft-dekater-scion-controlplane-04</a>
        </h3>
<p id="appendix-F.5-1">Major changes:<a href="#appendix-F.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.5-2.1">
            <p id="appendix-F.5-2.1.1">Clarified selection of MAC including a default algorithm<a href="#appendix-F.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-2.2">
            <p id="appendix-F.5-2.2.1">New section: PCB validity<a href="#appendix-F.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-2.3">
            <p id="appendix-F.5-2.3.1">New section: configuration<a href="#appendix-F.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-2.4">
            <p id="appendix-F.5-2.4.1">New section: Path Discovery Time and Scalability<a href="#appendix-F.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-2.5">
            <p id="appendix-F.5-2.5.1">New section: Effects of Clock Inaccuracy<a href="#appendix-F.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-2.6">
            <p id="appendix-F.5-2.6.1">New appendix: Control Service gRPC API<a href="#appendix-F.5-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-F.5-3">Minor changes:<a href="#appendix-F.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F.5-4.1">
            <p id="appendix-F.5-4.1.1">Introduction: Added overview of SCION components<a href="#appendix-F.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.2">
            <p id="appendix-F.5-4.2.1">Clarified path reversibility, link types, interface IDs<a href="#appendix-F.5-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.3">
            <p id="appendix-F.5-4.3.1">Fixed private AS range typo<a href="#appendix-F.5-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.4">
            <p id="appendix-F.5-4.4.1">Clarified PCB selection policies and endpoint requirements<a href="#appendix-F.5-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.5">
            <p id="appendix-F.5-4.5.1">Clarified PCB propagation<a href="#appendix-F.5-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.6">
            <p id="appendix-F.5-4.6.1">General edits to make terminology consistent, remove duplication and rationalize text<a href="#appendix-F.5-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.7">
            <p id="appendix-F.5-4.7.1">Removed forward references<a href="#appendix-F.5-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-F.5-4.8">
            <p id="appendix-F.5-4.8.1">Added RFC2119 compliant terminology<a href="#appendix-F.5-4.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Corine de Kater</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:c_de_kater@gmx.ch" class="email">c_de_kater@gmx.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nicola Rustignoli</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nic@scion.org" class="email">nic@scion.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Hitz</span></div>
<div dir="auto" class="left"><span class="org">Anapaya Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hitz@anapaya.net" class="email">hitz@anapaya.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
