<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SCION Control Plane</title>
<meta content="Corine de Kater" name="author">
<meta content="Nicola Rustignoli" name="author">
<meta content="Samuel Hitz" name="author">
<meta content="
       This document describes the Control Plane of the path-aware, inter-domain network architecture SCION (Scalability, Control, and Isolation On Next-generation networks). A fundamental characteristic of SCION is that it gives path control to SCION-capable endpoints that can choose between multiple path options, thereby enabling the optimization of network paths. The SCION Control Plane is responsible for discovering these paths and making them available to the endpoints. 
       The SCION Control Plane creates and securely disseminates path segments between SCION Autonomous Systems (AS) which can then be combined into forwarding paths to transmit packets in the data plane. This document describes mechanisms of path exploration through beaconing and path registration. In addition, it describes how Endpoints construct end-to-end paths by combining path segments obtained through a path lookup process. 
       This document contains new approaches to secure path aware networking. It is not an Internet Standard, has not received any formal review of the IETF, nor was the work developed through the rough consensus process. The approaches in this work are offered to the community for its consideration in the further evolution of the Internet. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-dekater-scion-controlplane-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-dekater-scion-controlplane.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SCION CP</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">de Kater, et al.</td>
<td class="center">Expires 24 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dekater-scion-controlplane-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-20" class="published">20 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-24">24 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. de Kater</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">N. Rustignoli</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">S. Hitz</div>
<div class="org">Anapaya Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SCION Control Plane</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Control Plane of the path-aware, inter-domain network architecture SCION (Scalability, Control, and Isolation On Next-generation networks). A fundamental characteristic of SCION is that it gives path control to SCION-capable endpoints that can choose between multiple path options, thereby enabling the optimization of network paths. The SCION Control Plane is responsible for discovering these paths and making them available to the endpoints.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The SCION Control Plane creates and securely disseminates path segments between SCION Autonomous Systems (AS) which can then be combined into forwarding paths to transmit packets in the data plane. This document describes mechanisms of path exploration through beaconing and path registration. In addition, it describes how Endpoints construct end-to-end paths by combining path segments obtained through a path lookup process.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document contains new approaches to secure path aware networking. It is not an Internet Standard, has not received any formal review of the IETF, nor was the work developed through the rough consensus process. The approaches in this work are offered to the community for its consideration in the further evolution of the Internet.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://scionassociation.github.io/scion-cp_I-D/draft-dekater-scion-controlplane.html">https://scionassociation.github.io/scion-cp_I-D/draft-dekater-scion-controlplane.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-dekater-scion-controlplane/">https://datatracker.ietf.org/doc/draft-dekater-scion-controlplane/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/scionassociation/scion-cp_I-D">https://github.com/scionassociation/scion-cp_I-D</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-paths-and-links" class="internal xref">Paths and Links</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-routing" class="internal xref">Routing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-path-segments" class="internal xref">Path Segments</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-addressing" class="internal xref">Addressing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.1">
                    <p id="section-toc.1-1.1.2.5.2.1.1"><a href="#section-1.5.1" class="auto internal xref">1.5.1</a>.  <a href="#name-isd-numbers" class="internal xref">ISD Numbers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.2">
                    <p id="section-toc.1-1.1.2.5.2.2.1"><a href="#section-1.5.2" class="auto internal xref">1.5.2</a>.  <a href="#name-scion-as-numbers" class="internal xref">SCION AS Numbers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.3">
                    <p id="section-toc.1-1.1.2.5.2.3.1"><a href="#section-1.5.3" class="auto internal xref">1.5.3</a>.  <a href="#name-text-representation" class="internal xref">Text Representation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-bootstrapping-ability" class="internal xref">Bootstrapping ability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="auto internal xref">1.7</a>.  <a href="#name-communication-protocol" class="internal xref">Communication Protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-path-exploration-or-beaconi" class="internal xref">Path Exploration or Beaconing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-introduction-and-overview" class="internal xref">Introduction and Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-peering-links" class="internal xref">Peering Links</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-appending-entries-to-a-pcb" class="internal xref">Appending Entries to a PCB</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="auto internal xref">2.1.3</a>.  <a href="#name-pcb-propagation-illustrated" class="internal xref">PCB Propagation - Illustrated Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-pcb-message-format" class="internal xref">PCB Message Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-segment-information" class="internal xref">Segment Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-as-entry" class="internal xref">AS Entry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-pcb-extensions" class="internal xref">PCB Extensions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="auto internal xref">2.2.4</a>.  <a href="#name-pcb-validity" class="internal xref">PCB Validity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5">
                    <p id="section-toc.1-1.2.2.2.2.5.1"><a href="#section-2.2.5" class="auto internal xref">2.2.5</a>.  <a href="#name-configuration" class="internal xref">Configuration</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-propagation-of-pcbs" class="internal xref">Propagation of PCBs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-reception-of-pcbs" class="internal xref">Reception of PCBs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-storing-candidate-pcbs" class="internal xref">Storing Candidate PCBs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-pcb-selection-policies" class="internal xref">PCB Selection Policies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-propagation-interval-and-be" class="internal xref">Propagation Interval and Best PCBs Set Size</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.5">
                    <p id="section-toc.1-1.2.2.3.2.5.1"><a href="#section-2.3.5" class="auto internal xref">2.3.5</a>.  <a href="#name-propagation-of-selected-pcb" class="internal xref">Propagation of Selected PCBs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-distribution-of-cryptograph" class="internal xref">Distribution of Cryptographic Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-renewal-of-cryptographic-ma" class="internal xref">Renewal of Cryptographic Material</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-registration-of-path-segmen" class="internal xref">Registration of Path Segments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-intra-isd-path-segment-regi" class="internal xref">Intra-ISD Path Segment Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-terminating-a-pcb" class="internal xref">Terminating a PCB</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-transforming-a-pcb-into-an-" class="internal xref">Transforming a PCB into an Up Segment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-transforming-a-pcb-into-a-d" class="internal xref">Transforming a PCB into a Down Segment</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-core-path-segment-registrat" class="internal xref">Core Path Segment Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-path-segment-registration-r" class="internal xref">Path Segment Registration RPC API</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-path-mtu" class="internal xref">Path MTU</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-path-lookup" class="internal xref">Path Lookup</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-lookup-process" class="internal xref">Lookup Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-sequence-of-lookup-requests" class="internal xref">Sequence of Lookup Requests</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-lookup-requests-message-for" class="internal xref">Lookup Requests Message Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-caching" class="internal xref">Caching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-behavior-of-actors-in-the-l" class="internal xref">Behavior of Actors in the Lookup Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-use-of-wildcard-addresses-i" class="internal xref">Use of Wildcard Addresses in the Lookup Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-segment-request-handler-of-" class="internal xref">Segment-Request Handler of a Non-Core Source AS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-segment-request-handler-of-a" class="internal xref">Segment-Request Handler of a Core AS</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-control-service-discovery" class="internal xref">Control Service Discovery</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-scmp" class="internal xref">SCMP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-general-format" class="internal xref">General Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-message-types" class="internal xref">Message Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-checksum-calculation" class="internal xref">Checksum Calculation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-processing-rules" class="internal xref">Processing Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-error-messages" class="internal xref">Error Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-packet-too-big" class="internal xref">Packet Too Big</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-external-interface-down" class="internal xref">External Interface Down</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="auto internal xref">6.5.3</a>.  <a href="#name-internal-connectivity-down" class="internal xref">Internal Connectivity Down</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-informational-messages" class="internal xref">Informational Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.1">
                    <p id="section-toc.1-1.6.2.6.2.1.1"><a href="#section-6.6.1" class="auto internal xref">6.6.1</a>.  <a href="#name-echo-request" class="internal xref">Echo Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.2">
                    <p id="section-toc.1-1.6.2.6.2.2.1"><a href="#section-6.6.2" class="auto internal xref">6.6.2</a>.  <a href="#name-echo-reply" class="internal xref">Echo Reply</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.3">
                    <p id="section-toc.1-1.6.2.6.2.3.1"><a href="#section-6.6.3" class="auto internal xref">6.6.3</a>.  <a href="#name-traceroute-request" class="internal xref">Traceroute Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.4">
                    <p id="section-toc.1-1.6.2.6.2.4.1"><a href="#section-6.6.4" class="auto internal xref">6.6.4</a>.  <a href="#name-traceroute-reply" class="internal xref">Traceroute Reply</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-destination-mapping" class="internal xref">Destination Mapping</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-monitoring-considerations" class="internal xref">Monitoring Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-effects-of-clock-inaccuracy" class="internal xref">Effects of Clock Inaccuracy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-path-discovery-time-and-sca" class="internal xref">Path Discovery Time and Scalability</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-intra-isd-beaconing" class="internal xref">Intra-ISD Beaconing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-core-beaconing" class="internal xref">Core Beaconing</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-security-properties" class="internal xref">Security Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-manipulation-of-the-beaconi" class="internal xref">Manipulation of the Beaconing Process by a Core Adversary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-manipulation-of-the-beaconin" class="internal xref">Manipulation of the Beaconing Process by a Non-Core Adversary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-path-hijacking-through-inte" class="internal xref">Path Hijacking through Interposition</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-creation-of-spurious-ases-a" class="internal xref">Creation of Spurious ASes and ISDs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-peering-link-misuse" class="internal xref">Peering Link Misuse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.4">
                    <p id="section-toc.1-1.8.2.3.2.4.1"><a href="#section-8.3.4" class="auto internal xref">8.3.4</a>.  <a href="#name-manipulation-of-the-path-se" class="internal xref">Manipulation of the Path-Selection Process</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-attacks-on-time-sources" class="internal xref">Attacks on time sources</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-denial-of-service-attacks" class="internal xref">Denial of Service Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-path-lookup-examples" class="internal xref">Path-Lookup Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-B.1" class="auto internal xref"></a><a href="#name-draft-dekater-scion-control" class="internal xref">draft-dekater-scion-controlplane-15</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-B.2" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlp" class="internal xref">draft-dekater-scion-controlplane-15</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-B.3" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlpl" class="internal xref">draft-dekater-scion-controlplane-14</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-B.4" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlpla" class="internal xref">draft-dekater-scion-controlplane-13</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#appendix-B.5" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplan" class="internal xref">draft-dekater-scion-controlplane-12</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#appendix-B.6" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane" class="internal xref">draft-dekater-scion-controlplane-11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#appendix-B.7" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-" class="internal xref">draft-dekater-scion-controlplane-10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a href="#appendix-B.8" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-0" class="internal xref">draft-dekater-scion-controlplane-09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9">
                <p id="section-toc.1-1.12.2.9.1"><a href="#appendix-B.9" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-08" class="internal xref">draft-dekater-scion-controlplane-08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.10">
                <p id="section-toc.1-1.12.2.10.1"><a href="#appendix-B.10" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-07" class="internal xref">draft-dekater-scion-controlplane-07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.11">
                <p id="section-toc.1-1.12.2.11.1"><a href="#appendix-B.11" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-06" class="internal xref">draft-dekater-scion-controlplane-06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.12">
                <p id="section-toc.1-1.12.2.12.1"><a href="#appendix-B.12" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-05" class="internal xref">draft-dekater-scion-controlplane-05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.13">
                <p id="section-toc.1-1.12.2.13.1"><a href="#appendix-B.13" class="auto internal xref"></a><a href="#name-draft-dekater-scion-controlplane-04" class="internal xref">draft-dekater-scion-controlplane-04</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">SCION (Scalability, Control, and Isolation On Next-generation networks) is a path-aware internetworking routing architecture as described in <span>[<a href="#RFC9217" class="cite xref">RFC9217</a>]</span>. It allows endpoints and applications to select paths across the network to use for traffic, based on trustworthy path properties. SCION is an inter-domain network architecture and is therefore not concerned with intra-domain forwarding.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">SCION has been developed with the following goals:<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><em>Availability</em> - to provide highly available communication that can send traffic over paths with optimal or required characteristics, quickly handle inter-domain link or router failures (both on the last hop or anywhere along the path), and provide continuity in the presence of adversaries.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><em>Security</em> - to introduce a new approach to inter-domain path security that leverages path awareness in combination with a unique trust model. The goal is to provide higher levels of trustworthiness in routing information to prevent traffic hijacking, and to enable users to decide where their data travels. This routing information can be unambiguously attributed to a SCION AS, thereby ensuring that packets are only forwarded along authorized path segments (e.g., to enable geofencing). Security properties are further discussed in <a href="#security-properties" class="auto internal xref">Section 8.1</a>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><em>Scalability</em> - to improve the scalability of the inter-domain control plane and data plane, avoiding existing limitations related to convergence and forwarding table size. The advertising of path segments is separated into a beaconing process within each Isolation Domain (ISD), and between ISDs which incurs minimal overhead and resource requirements on routers.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">SCION relies on three main components:<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"><em>PKI</em> - described in <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>. To achieve scalability and trust, SCION organizes its ASes into logical groups of independent routing planes called <em>Isolation Domains (ISDs)</em>. All ASes in an ISD agree on a set of trust roots called the <em>Trust Root Configuration (TRC)</em> which is a collection of signed root certificates in X.509 v3 format <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The ISD is governed by a set of <em>core ASes</em> which typically manage the trust roots and provide connectivity to other ISDs. This is the basis of the public key infrastructure used for the authentication of messages used by the SCION Control Plane.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><em>Control Plane</em> - described in this document. It performs inter-domain routing by discovering and securely disseminating path information between SCION ASes. The core ASes use Path-segment Construction Beacons (PCBs) to explore intra-ISD paths, or to explore paths across different ISDs.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9"><em>Data Plane</em> - described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>. It carries out secure packet forwarding between SCION ASes over paths selected by endpoints. A SCION border router reuses existing intra-domain infrastructure to communicate to other SCION routers or SCION endpoints within its AS.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">This document should be read in conjunction with the other components mentioned above. Readers are encouraged to read the introduction in this document first.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">The SCION architecture was initially developed outside of the IETF by ETH Zurich with significant contributions from Anapaya Systems. It is deployed in the Swiss finance sector to provide resilient connectivity between financial institutions. The aim of this document is to document the existing protocol specification as deployed, to encourage interoperability among implementations, and to introduce new concepts that can potentially be further improved to address particular problems with the current Internet architecture. This document is not an Internet Standards Track specification; it does not have IETF consensus and it is published for informational purposes.<a href="#section-1-11" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1"><strong>SCION Autonomous System (AS)</strong>: A SCION Autonomous System is a network under a common administrative control. For example, the network of a SCION service provider, company, or university can constitute an AS. While functionally similar to a BGP AS, a SCION AS operates within an Isolation Domain (ISD), utilizes a different address scheme, and serves as a locator in the addressing of end hosts. References to ASes throughout this document refer to SCION ASes.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2"><strong>Beaconing</strong>: The Control Plane process where an AS discovers paths to other ASes.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3"><strong>Control Plane</strong>: The SCION Control Plane is responsible for the propagation and discovery of network paths, i.e., for the exchange of routing information between SCION nodes. The Control Plane thus determines where traffic can be sent and deals with questions such as how paths are discovered, which paths exist, and how they are disseminated to endpoints, etc. Within a SCION AS, such functionalities are carried out by the Control Service whereas packet forwarding is a task carried out by the data plane.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4"><strong>Control Service</strong>: The Control Service is the main control plane infrastructure component within a SCION AS. It is responsible for the path exploration and registration processes that take place within the Control Plane.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5"><strong>Core AS</strong>: Each Isolation Domain (ISD) is administered by a set of distinguished SCION autonomous systems (ASes) called core ASes, which are responsible for initiating the path discovery and path construction process (called "beaconing" in SCION). Each ISD <span class="bcp14">MUST</span> have at least one Core AS.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6"><strong>Endpoint</strong>: An endpoint is the start or the end of a SCION path, as defined in <span>[<a href="#RFC9473" class="cite xref">RFC9473</a>]</span>.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7"><strong>Forwarding Path</strong>: A complete end-to-end path between two SCION endpoints which is used to transmit packets in the data plane. Endpoints can create paths with a combination of up to three path segments (an up segment, a core segment, and a down segment).<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8"><strong>Hop Field (HF)</strong>: As they traverse the network, Path-Segment Construction Beacons (PCBs) accumulate cryptographically protected AS-level path information in the form of Hop Fields. In the data plane, Hop Fields are used for packet forwarding: they contain the incoming and outgoing Interface IDs of the ASes on the forwarding path.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9"><strong>Info Field (INF)</strong>: Each Path-Segment Construction Beacon (PCB) contains a single Info field, which provides basic information about the PCB. Together with Hop Fields (HFs), these are used to create forwarding paths.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10"><strong>Isolation Domain (ISD)</strong>: SCION ASes are organized into logical groups called Isolation Domains or ISDs. Each ISD consists of ASes that span an area with a uniform trust environment (e.g., a common jurisdiction).<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11"><strong>Message Authentication Code (MAC)</strong>. In the rest of this document, "MAC" always refers to "Message Authentication Code" and never to "Medium Access Control". When "Medium Access Control address" is implied, the phrase "Link Layer Address" is used.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12"><strong>Path Segment</strong>: These are derived from Path-Segment Construction Beacons (PCBs). A path segment can be (1) an up segment (i.e., a path between a non-core AS and a core AS in the same ISD), (2) a down segment (i.e., the same as an up segment but in the opposite direction), or (3) a core segment (i.e., a path between core ASes). Endpoints use up to three path segments to create a forwarding path.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<p id="section-1.1-13"><strong>Path-Segment Construction Beacon (PCB)</strong>: Core AS control planes generate PCBs to explore paths within their isolation domain (ISD) and between different ISDs. ASes further propagate selected PCBs to their neighboring ASes. These PCBs traverse each AS accumulating information, including Hop Fields (HFs) which can subsequently be used for forwarding.<a href="#section-1.1-13" class="pilcrow">¶</a></p>
<p id="section-1.1-14"><strong>SCION Control Message Protocol (SCMP)</strong>: A signaling protocol analogous to the Internet Control Message Protocol (ICMP). This is described in <a href="#scmp" class="auto internal xref">Section 6</a>.<a href="#section-1.1-14" class="pilcrow">¶</a></p>
<p id="section-1.1-15"><strong>Trust Root Configuration (TRC)</strong>: A Trust Root Configuration or TRC is a signed collection of certificates pertaining to an isolation domain (ISD). TRCs also contain ISD-specific policies.<a href="#section-1.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1.2">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="paths-links">
<section id="section-1.3">
        <h3 id="name-paths-and-links">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-paths-and-links" class="section-name selfRef">Paths and Links</a>
        </h3>
<p id="section-1.3-1">SCION routers and endpoints connect to each other via links. A link refers to a physical or logical connection between two SCION nodes (e.g., router or endpoint). A SCION path between two endpoints traverses one or more links.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">SCION ASes - each being a network under a common administrative control - are organized into logical groups called Isolation Domains (ISDs). Each ISD consists of ASes that are part of a uniform trust environment (i.e., a common jurisdiction) and is administered by a set of distinguished ASes called core ASes.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">SCION distinguishes three types of links between ASes: (1) core links, (2) parent-child links, and (3) peering links.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-4.1">
            <p id="section-1.3-4.1.1"><em>Core</em> links connect two core ASes, which are either within the same or in different ISDs. Core links can exist for various reasons, including provider-customer (where the customer pays the provider for traffic) and peering relationships.<a href="#section-1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.2">
            <p id="section-1.3-4.2.1"><em>Parent-child</em> links create a hierarchy between the parent and the child AS within the same ISD. ASes with a parent-child link typically have a provider-customer relationship.<a href="#section-1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.3">
            <p id="section-1.3-4.3.1"><em>Peering</em> links exist between ASes with a peering relationship (settlement-free or paid). They can be established between any two ASes (core or non-core) and can cross ISD boundaries.<a href="#section-1.3-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.3-5">SCION paths are comprised of at most three path segments: an up segment, traversing links from child to parent, then a core segment consisting of core links, followed by a down segment traversing links from parent to child. Each path segment is established over one or more links.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">SCION paths are always "valley free" whereby a child AS does not carry transit traffic from a parent AS to another parent AS. These paths can contain at most one peering link, which endpoints can use as shortcut between two path segments containing two peer ASes.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7"><a href="#_figure-1" class="auto internal xref">Figure 1</a> shows the three types of links for one small ISD with two core ASes A and C, and four non-core ASes D,E,F, and G.<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<span id="name-the-three-types-of-scion-li"></span><div id="_figure-1">
<figure id="figure-1">
          <div id="section-1.3-8.1">
            <div class="alignLeft art-svg artwork" id="section-1.3-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="336" width="432" viewBox="0 0 432 336" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,144" fill="none" stroke="black"></path>
                <path d="M 24,80 L 24,112" fill="none" stroke="black"></path>
                <path d="M 24,192 L 24,224" fill="none" stroke="black"></path>
                <path d="M 24,288 L 24,320" fill="none" stroke="black"></path>
                <path d="M 48,112 L 48,192" fill="none" stroke="black"></path>
                <path d="M 48,224 L 48,288" fill="none" stroke="black"></path>
                <path d="M 72,80 L 72,112" fill="none" stroke="black"></path>
                <path d="M 72,192 L 72,224" fill="none" stroke="black"></path>
                <path d="M 72,288 L 72,320" fill="none" stroke="black"></path>
                <path d="M 152,80 L 152,112" fill="none" stroke="black"></path>
                <path d="M 152,192 L 152,224" fill="none" stroke="black"></path>
                <path d="M 152,288 L 152,320" fill="none" stroke="black"></path>
                <path d="M 176,112 L 176,192" fill="none" stroke="black"></path>
                <path d="M 176,224 L 176,288" fill="none" stroke="black"></path>
                <path d="M 200,80 L 200,112" fill="none" stroke="black"></path>
                <path d="M 200,192 L 200,224" fill="none" stroke="black"></path>
                <path d="M 200,288 L 200,320" fill="none" stroke="black"></path>
                <path d="M 216,32 L 216,144" fill="none" stroke="black"></path>
                <path d="M 280,48 L 280,112" fill="none" stroke="black"></path>
                <path d="M 8,32 L 216,32" fill="none" stroke="black"></path>
                <path d="M 24,80 L 72,80" fill="none" stroke="black"></path>
                <path d="M 152,80 L 200,80" fill="none" stroke="black"></path>
                <path d="M 88,96 L 136,96" fill="none" stroke="black"></path>
                <path d="M 24,112 L 72,112" fill="none" stroke="black"></path>
                <path d="M 152,112 L 200,112" fill="none" stroke="black"></path>
                <path d="M 8,144 L 40,144" fill="none" stroke="black"></path>
                <path d="M 56,144 L 168,144" fill="none" stroke="black"></path>
                <path d="M 184,144 L 216,144" fill="none" stroke="black"></path>
                <path d="M 256,144 L 304,144" fill="none" stroke="black"></path>
                <path d="M 256,176 L 304,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 72,192" fill="none" stroke="black"></path>
                <path d="M 152,192 L 200,192" fill="none" stroke="black"></path>
                <path d="M 88,208 L 136,208" fill="none" stroke="black"></path>
                <path d="M 24,224 L 72,224" fill="none" stroke="black"></path>
                <path d="M 152,224 L 200,224" fill="none" stroke="black"></path>
                <path d="M 24,288 L 72,288" fill="none" stroke="black"></path>
                <path d="M 152,288 L 200,288" fill="none" stroke="black"></path>
                <path d="M 24,320 L 72,320" fill="none" stroke="black"></path>
                <path d="M 152,320 L 200,320" fill="none" stroke="black"></path>
                <circle cx="48" cy="176" r="6" class="opendot" fill="white" stroke="black"></circle>
                <circle cx="48" cy="272" r="6" class="opendot" fill="white" stroke="black"></circle>
                <circle cx="176" cy="176" r="6" class="opendot" fill="white" stroke="black"></circle>
                <circle cx="176" cy="272" r="6" class="opendot" fill="white" stroke="black"></circle>
                <circle cx="280" cy="96" r="6" class="opendot" fill="white" stroke="black"></circle>
                <g class="text">
                  <text x="88" y="68">ISD</text>
                  <text x="124" y="68">Core</text>
                  <text x="380" y="68">parent-child</text>
                  <text x="348" y="84">link</text>
                  <text x="36" y="100">AS</text>
                  <text x="56" y="100">A</text>
                  <text x="80" y="100">c</text>
                  <text x="144" y="100">c</text>
                  <text x="164" y="100">AS</text>
                  <text x="184" y="100">C</text>
                  <text x="248" y="148">c</text>
                  <text x="312" y="148">c</text>
                  <text x="348" y="148">core</text>
                  <text x="388" y="148">link</text>
                  <text x="248" y="180">p</text>
                  <text x="312" y="180">p</text>
                  <text x="360" y="180">peering</text>
                  <text x="412" y="180">link</text>
                  <text x="36" y="212">AS</text>
                  <text x="56" y="212">D</text>
                  <text x="80" y="212">p</text>
                  <text x="144" y="212">p</text>
                  <text x="164" y="212">AS</text>
                  <text x="184" y="212">E</text>
                  <text x="36" y="308">AS</text>
                  <text x="56" y="308">G</text>
                  <text x="164" y="308">AS</text>
                  <text x="184" y="308">F</text>
                </g>
              </svg><a href="#section-1.3-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-three-types-of-scion-li" class="selfRef">The three types of SCION links in one ISD. Each node in the figure is a SCION AS.</a>
          </figcaption></figure>
</div>
<p id="section-1.3-9">Each link connecting SCION routers is bi-directional and is identified by its corresponding egress and ingress Interface IDs. An Interface ID is a 16-bit identifier as described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> in the "Terminology" section. It is required to be unique within each AS and can therefore be chosen without any need for coordination between ASes.<a href="#section-1.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing">
<section id="section-1.4">
        <h3 id="name-routing">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-routing" class="section-name selfRef">Routing</a>
        </h3>
<p id="section-1.4-1">SCION provides path-aware inter-domain routing between SCION ASes. The SCION Control Plane is responsible for discovering these inter-domain paths and making them available to the endpoints within the ASes.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">SCION inter-domain routing operates on two levels: within an ISD which is called <em>intra</em>-ISD routing, and between ISDs which is called <em>inter</em>-ISD routing. Both levels use <em>Path-Segment Construction Beacons (PCBs)</em> to explore network paths. A PCB is originated by a core AS and then disseminated either within an ISD to explore intra-ISD paths, or among core ASes to explore core paths across different ISDs.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">The PCBs accumulate cryptographically protected path and forwarding information at an AS level and store this information in the form of <em>Hop Fields</em>. Endpoints use information from these Hop Fields to create end-to-end forwarding paths for data packets that carry this information in their headers. This also supports multi-path communication among endpoints.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">The creation of end-to-end forwarding paths consists of the following processes:<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-5.1">
            <p id="section-1.4-5.1.1"><em>Path exploration (or beaconing)</em>: This is the process where an AS Control Service discovers paths to other ASes. This is described in detail in <a href="#beaconing" class="auto internal xref">Section 2</a>.<a href="#section-1.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-5.2">
            <p id="section-1.4-5.2.1"><em>Path registration</em>: This is the process where an AS Control Service selects PCBs, according to defined policies, turns the selected PCBs into path segments, and adds these path segments to the relevant path infrastructure, thus making them available to other ASes. This is described in detail in <a href="#path-segment-reg" class="auto internal xref">Section 3</a>.<a href="#section-1.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-5.3">
            <p id="section-1.4-5.3.1"><em>Path resolution</em>: This is the process of actually creating an end-to-end forwarding path from the source endpoint to the destination. For this, an endpoint performs (a) a path lookup step to obtain path segments, and (b) a path combination step to combine the forwarding path from the segments. Step (a) is described in detail in <a href="#lookup" class="auto internal xref">Section 4</a> and step (b) is described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "Path Construction (Segment Combinations)".<a href="#section-1.4-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.4-6">All processes operate concurrently.<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7">The <strong>Control Service</strong> is responsible for the path exploration and registration processes in the Control Plane. It is the main control plane infrastructure component within each SCION AS and has the following tasks:<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-8.1">
            <p id="section-1.4-8.1.1">Generating, receiving, and propagating PCBs. Periodically, the Control Service of a core AS generates a set of PCBs, which are forwarded to the child ASes or neighboring core ASes. In the latter case, the PCBs are sent over policy compliant paths to discover multiple paths between any pair of core ASes.<a href="#section-1.4-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-8.2">
            <p id="section-1.4-8.2.1">Selecting and registering the set of path segments via which the AS wants to be reached.<a href="#section-1.4-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.4-8.3">
            <p id="section-1.4-8.3.1">Distributing certificates and keys to secure inter-AS communication. Each PCB contains signatures of all on-path ASes and each time the Control Service of an AS receives a PCB, it validates the PCB's authenticity. When the Control Service lacks an intermediate certificate, it can query the Control Service of the neighboring AS that sent the PCB through the API described in <a href="#crypto-api" class="auto internal xref">Section 2.4</a>.<a href="#section-1.4-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.4-9"><strong>Note:</strong> The Control Service of an AS is decoupled from SCION border routers and operators may deploy it anywhere within the AS.<a href="#section-1.4-9" class="pilcrow">¶</a></p>
<div id="path-segments">
<section id="section-1.4.1">
          <h4 id="name-path-segments">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-path-segments" class="section-name selfRef">Path Segments</a>
          </h4>
<p id="section-1.4.1-1">SCION distinguishes the following types of path segments:<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-2.1">
              <p id="section-1.4.1-2.1.1">A path segment from a non-core AS to a core AS is an <em>up segment</em>.<a href="#section-1.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-2.2">
              <p id="section-1.4.1-2.2.1">A path segment from a core AS to a non-core AS is a <em>down segment</em>.<a href="#section-1.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-2.3">
              <p id="section-1.4.1-2.3.1">A path segment between core ASes is a <em>core segment</em>.<a href="#section-1.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.1-3">Each path segment starts and/or ends at a core AS. Path segments are not created between non-core ASes.<a href="#section-1.4.1-3" class="pilcrow">¶</a></p>
<p id="section-1.4.1-4">All path segments may be reversed: a core segment can be used bi-directionally, an up segment can be converted into a down segment, and a down segment can be converted into an up segment depending on the direction of the end-to-end path. This means that all path segments can be used to send data traffic in both directions.<a href="#section-1.4.1-4" class="pilcrow">¶</a></p>
<p id="section-1.4.1-5">The cryptographic protection of PCBs and path segments is based on the Control Plane PKI. The signatures are structured such that the entire message sequence constituting the path segment can be authenticated by anyone with access to this PKI.<a href="#section-1.4.1-5" class="pilcrow">¶</a></p>
<p id="section-1.4.1-6">For fast validation of the path information carried in individual packets during packet forwarding, symmetric key cryptography is used and the Hop Fields contain a MAC. These MACs are structured to allow verification of the sequence of hops, but in contrast to the PCBs can only be validated by the border routers of the respective AS.<a href="#section-1.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="numbering">
<section id="section-1.5">
        <h3 id="name-addressing">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-addressing" class="section-name selfRef">Addressing</a>
        </h3>
<p id="section-1.5-1">Inter-domain SCION routing is based on an &lt;ISD, AS&gt; tuple. Although a complete SCION address is composed of the &lt;ISD, AS, endpoint address&gt; 3-tuple, the endpoint address is not used for inter-domain routing or forwarding. The endpoint address is of variable length, does not need to be globally unique, and can thus be an IPv4, IPv6, or link layer address.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2"><strong>Note:</strong> As a consequence of the fact that SCION relies on existing routing protocols (e.g., IS-IS, OSPF, SR) and communication fabric (e.g., IP, MPLS) for intra-domain forwarding, existing internal routers do not need to be changed to support SCION.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<div id="isd-numbers">
<section id="section-1.5.1">
          <h4 id="name-isd-numbers">
<a href="#section-1.5.1" class="section-number selfRef">1.5.1. </a><a href="#name-isd-numbers" class="section-name selfRef">ISD Numbers</a>
          </h4>
<p id="section-1.5.1-1">An ISD number is the 16-bit global identifier for an ISD.<a href="#section-1.5.1-1" class="pilcrow">¶</a></p>
<p id="section-1.5.1-2">The following table gives an overview of the ISD number allocation:<a href="#section-1.5.1-2" class="pilcrow">¶</a></p>
<span id="name-isd-number-allocations"></span><div id="_table-1">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-isd-number-allocations" class="selfRef">ISD number allocations</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ISD</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">The wildcard ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1 - 15</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for documentation and sample code (analogous to <span>[<a href="#RFC5398" class="cite xref">RFC5398</a>]</span>).</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">16 - 63</td>
                <td class="text-left" rowspan="1" colspan="1">Private use (analogous to <span>[<a href="#RFC6996" class="cite xref">RFC6996</a>]</span>) - can be used for testing and private deployments</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">64 - 4094</td>
                <td class="text-left" rowspan="1" colspan="1">Public ISDs. They <span class="bcp14">MUST</span> be globally unique.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4095 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Unallocated</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-1.5.1-4">The wildcard ISD is not directly used by the control or data plane. Implementations may use it to represent any ISD, for example in path filters.
ISD numbers are allocated by the SCION Association (<span>[<a href="#ISD-AS-assignments" class="cite xref">ISD-AS-assignments</a>]</span>).<a href="#section-1.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scion-as-numbers">
<section id="section-1.5.2">
          <h4 id="name-scion-as-numbers">
<a href="#section-1.5.2" class="section-number selfRef">1.5.2. </a><a href="#name-scion-as-numbers" class="section-name selfRef">SCION AS Numbers</a>
          </h4>
<p id="section-1.5.2-1">A SCION AS number is the 48-bit identifier for an AS. Although they play a similar role, there is no relationship between SCION AS numbers and BGP ASNs as defined by <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>. For historical reasons some SCION Autonomous Systems use an AS number where the first 16 bits are 0 and the remaining 32 bits are identical to their BGP ASN, but there is no technical requirement for this. AS numbers of public ASes <span class="bcp14">MUST</span> be globally unique.<a href="#section-1.5.2-1" class="pilcrow">¶</a></p>
<div id="serv-disc">
<section id="section-1.5.2.1">
            <h5 id="name-wildcard-addressing">
<a href="#section-1.5.2.1" class="section-number selfRef">1.5.2.1. </a><a href="#name-wildcard-addressing" class="section-name selfRef">Wildcard Addressing</a>
            </h5>
<p id="section-1.5.2.1-1">SCION endpoints use wildcard AS <code>0</code> to designate any core AS, e.g., to place requests for core segments or down segments during path lookup. These wildcard addresses are of the form I-0, to designate any AS in ISD I. For more information, see <a href="#wildcard" class="auto internal xref">Section 4.2.1</a>.<a href="#section-1.5.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scion-as-numbers-1">
<section id="section-1.5.2.2">
            <h5 id="name-scion-as-numbers-2">
<a href="#section-1.5.2.2" class="section-number selfRef">1.5.2.2. </a><a href="#name-scion-as-numbers-2" class="section-name selfRef">SCION AS numbers</a>
            </h5>
<span id="name-as-number-allocations"></span><div id="_table-2">
<table class="center" id="table-2">
              <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-as-number-allocations" class="selfRef">AS number allocations</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">AS</th>
                  <th class="text-left" rowspan="1" colspan="1">Size</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>0</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">The wildcard AS</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>1 - 4294967295</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~4.3 billion</td>
                  <td class="text-left" rowspan="1" colspan="1">Public SCION AS numbers</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>1:0:0 - 1:ffff:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~4.3 billion</td>
                  <td class="text-left" rowspan="1" colspan="1">Public SCION AS numbers - future allocations</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>2:0:0 - 2:ffff:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~4.3 billion</td>
                  <td class="text-left" rowspan="1" colspan="1">Public SCION AS numbers</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>3:0:0 - feff:ffff:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~280 trillion</td>
                  <td class="text-left" rowspan="1" colspan="1">Unallocated</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>ff00:0:0 - ff00:0:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">65536</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for documentation and sample code (analogous to <span>[<a href="#RFC5398" class="cite xref">RFC5398</a>]</span>)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>ff00:1:0 - ffa9:ffff:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~730 billion</td>
                  <td class="text-left" rowspan="1" colspan="1">Unallocated</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>ffaa:0:0 - ffaa:ff:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~16.8 million</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for private use (analogous to <span>[<a href="#RFC6996" class="cite xref">RFC6996</a>]</span>) - these numbers can be used for testing and private deployments</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>ffaa:100:0 - ffff:ffff:fffe</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">~369 billion</td>
                  <td class="text-left" rowspan="1" colspan="1">Unallocated</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>ffff:ffff:ffff</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
              </tbody>
            </table>
</div>
</section>
</div>
</section>
</div>
<div id="text-representation">
<section id="section-1.5.3">
          <h4 id="name-text-representation">
<a href="#section-1.5.3" class="section-number selfRef">1.5.3. </a><a href="#name-text-representation" class="section-name selfRef">Text Representation</a>
          </h4>
<div id="isd-numbers-1">
<section id="section-1.5.3.1">
            <h5 id="name-isd-numbers-2">
<a href="#section-1.5.3.1" class="section-number selfRef">1.5.3.1. </a><a href="#name-isd-numbers-2" class="section-name selfRef">ISD numbers</a>
            </h5>
<p id="section-1.5.3.1-1">The text representation of SCION ISD numbers <span class="bcp14">MUST</span> be its decimal ASCII representation.<a href="#section-1.5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-numbers">
<section id="section-1.5.3.2">
            <h5 id="name-as-numbers">
<a href="#section-1.5.3.2" class="section-number selfRef">1.5.3.2. </a><a href="#name-as-numbers" class="section-name selfRef">AS numbers</a>
            </h5>
<p id="section-1.5.3.2-1">The text representation of SCION AS numbers is as follows:<a href="#section-1.5.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.3.2-2.1">
                <p id="section-1.5.3.2-2.1.1">SCION AS numbers in the lower 32-bit range <span class="bcp14">MUST</span> be printed as decimal by implementations. Implementations may parse AS numbers in the lower 32-bit range in hexadecimal notation too (e.g.,, a program may accept AS number '0:1:f' for AS 65551).<a href="#section-1.5.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5.3.2-2.2">
                <p id="section-1.5.3.2-2.2.1">SCION AS numbers in the higher 32-bit range <span class="bcp14">MUST</span> be printed using big-endian hexadecimal notation in 3 groups of 4, in the range <code>1:0:0</code> to <code>ffff:ffff:ffff</code>. Leading zeros in each group are omitted, with the exception that one zero <span class="bcp14">MUST</span> be notated if a group is entirely zeros (e.g.,, <code>1:0:1</code>). The <code>::</code> zero-compression feature of IPv6 <span class="bcp14">MUST NOT</span> be used.<a href="#section-1.5.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.5.3.2-2.3">
                <p id="section-1.5.3.2-2.3.1">A range of AS numbers can be shortened with a notation similar to the one used for CIDR IP ranges (<span>[<a href="#RFC4632" class="cite xref">RFC4632</a>]</span>). In such case, hexadecimal notation <span class="bcp14">MUST</span> be used. For example, the range of the lowest 32-bit AS numbers (0-4294967295) can be represented as <code>0:0:0/16</code>.<a href="#section-1.5.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="isd-as-tuples">
<section id="section-1.5.3.3">
            <h5 id="name-isd-as-tuples">
<a href="#section-1.5.3.3" class="section-number selfRef">1.5.3.3. </a><a href="#name-isd-as-tuples" class="section-name selfRef">&lt;ISD, AS&gt; tuples</a>
            </h5>
<p id="section-1.5.3.3-1">The text representation of SCION addresses <span class="bcp14">MUST</span> be <code>&lt;ISD&gt;-&lt;AS&gt;</code>, where <code>&lt;ISD&gt;</code> is the text representation of the ISD number, <code>&lt;AS&gt;</code> is the text representation of the AS number, and <code>-</code> is the literal ASCII character 0x2D. This text representation is used for the ISD-AS number attribute in the certificates (see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>).<a href="#section-1.5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-1.5.3.3-2">For example, the text representation of AS number ff00:0:1 in ISD number 15 is <code>15-ff00:0:1</code>.<a href="#section-1.5.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="bootstrapping-ability">
<section id="section-1.6">
        <h3 id="name-bootstrapping-ability">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-bootstrapping-ability" class="section-name selfRef">Bootstrapping ability</a>
        </h3>
<p id="section-1.6-1">SCION uses the following mechanisms to avoid circular dependencies during bootstrapping, and to provide resiliency after systemic failures:<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-2.1">
            <p id="section-1.6-2.1.1">Neighbor-based path discovery: Path discovery in SCION is performed by the beaconing mechanism. In order to participate in this process, an AS Control Service only needs to be aware of its direct neighbors. As long as no path segments are available, communicating with the neighboring ASes is possible with the one-hop path type which does not rely on any path information. SCION uses these <em>one-hop paths</em> to propagate PCBs to neighboring ASes to which no forwarding path is available yet. The One-Hop Path Type is described in more detail in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-1.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.2">
            <p id="section-1.6-2.2.1">Path reversal: In SCION, every path is reversible. That is, the receiver of a packet can reverse the path in the packet header in order to produce a reply packet without having to perform a path lookup. Such a packet follows the original packet's path.<a href="#section-1.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-2.3">
            <p id="section-1.6-2.3.1">Availability of certificates: Every entity is required to be in possession of all cryptographic material including the ISD's TRC and AS certificates, in order to verify any message it sends. This together with the path reversal means that the receiver of a message can always obtain all this material by contacting the sender.<br><a href="#section-1.6-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.6-3"><strong>Note:</strong> For a detailed description of a TRC and more information on the availability of certificates and TRCs, see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>.<a href="#section-1.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="communication-protocol">
<section id="section-1.7">
        <h3 id="name-communication-protocol">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-communication-protocol" class="section-name selfRef">Communication Protocol</a>
        </h3>
<p id="section-1.7-1">All communication between the Control Services in different SCION ASes is expressed in terms of RPC remote procedure calls. Service interfaces and messages are defined in the Protocol Buffer "proto3" interface definition language (for details, see <span>[<a href="#proto3" class="cite xref">proto3</a>]</span>).<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<p id="section-1.7-2">The RPC messages are transported via <span>[<a href="#Connect" class="cite xref">Connect</a>]</span>'s RPC protocol that carries messages over HTTP/3 (see <span>[<a href="#RFC9114" class="cite xref">RFC9114</a>]</span>)), which in turn uses QUIC/UDP (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>) as a transport layer. Connect is compatible with <span>[<a href="#gRPC" class="cite xref">gRPC</a>]</span> which is supported but deprecated.<a href="#section-1.7-2" class="pilcrow">¶</a></p>
<p id="section-1.7-3">In case of failure, RPC calls return an error as specified by the RPC framework. That is, a non-zero status code and an explanatory string. <a href="#service-discovery" class="auto internal xref">Section 5</a> provides details about the establishment of the underlying QUIC connections.<a href="#section-1.7-3" class="pilcrow">¶</a></p>
<p id="section-1.7-4">SCION's Control Plane does not require any domain name resolution for communication.<a href="#section-1.7-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="beaconing">
<section id="section-2">
      <h2 id="name-path-exploration-or-beaconi">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-path-exploration-or-beaconi" class="section-name selfRef">Path Exploration or Beaconing</a>
      </h2>
<div id="introduction-and-overview">
<section id="section-2.1">
        <h3 id="name-introduction-and-overview">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-introduction-and-overview" class="section-name selfRef">Introduction and Overview</a>
        </h3>
<p id="section-2.1-1"><strong>Path Exploration</strong> is the process where a SCION AS discovers paths to other ASes. In SCION, this process is referred to as <em>beaconing</em>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The <em>Control Service</em> of each SCION AS is responsible for the beaconing process. The Control Service generates, receives, and propagates <em>Path-Segment Construction Beacons (PCBs)</em> on a regular basis, to iteratively construct path segments.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">PCBs contain inter-domain topology and authentication information, and can include additional metadata that helps with path management and selection. The beaconing process itself is divided into routing processes on two levels, where <em>core</em> or inter-ISD is based on the (selective) sending of PCBs without a defined direction, and <em>intra-ISD</em> beaconing on top-to-bottom propagation. Beaconing is initiated by core ASes, therefore each ISD <span class="bcp14">MUST</span> have at least one core AS.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">
            <p id="section-2.1-4.1.1"><em>Core or Inter-ISD beaconing</em> is the process of constructing path segments between core ASes in the same or in different ISDs. During core beaconing, the Control Service of a core AS either originates PCBs or propagates PCBs received from neighboring core ASes to other neighboring core ASes.<a href="#section-2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1"><em>Intra-ISD beaconing</em> creates path segments from core ASes to non-core ASes. For this, the Control Services of core ASes originates PCBs and sends them to the non-core child ASes (typically customer ASes) at regular intervals. The Control Service of a non-core child AS receives these PCBs and forwards them to its child ASes, and so on until the PCB reaches an AS without any children. As a result, all ASes within an ISD receive path segments to reach the core ASes of their ISD and register reciprocal segments with the Control Service of the associated core ASes.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-5">On its way, a PCB accumulates cryptographically protected path and forwarding information per traversed AS. At every AS, metadata as well as information about the AS's ingress and egress interfaces is added to the PCB. The full PCB message format is described in <a href="#pcbs" class="auto internal xref">Section 2.2</a>. PCBs are used to construct path segments. ASes register them to make them available to other ASes, as described in <a href="#path-segment-reg" class="auto internal xref">Section 3</a>.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<div id="peering-links">
<section id="section-2.1.1">
          <h4 id="name-peering-links">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-peering-links" class="section-name selfRef">Peering Links</a>
          </h4>
<p id="section-2.1.1-1">PCBs do not traverse peering links, but peering links are instead announced along with a regular path in a PCB. If both ASes at either end of a peering link have registered path segments that include this specific peering link, then it is possible to use this during segment combination to create the end-to-end path.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pcb-appending">
<section id="section-2.1.2">
          <h4 id="name-appending-entries-to-a-pcb">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-appending-entries-to-a-pcb" class="section-name selfRef">Appending Entries to a PCB</a>
          </h4>
<p id="section-2.1.2-1">Every propagation interval (as configured by the AS operator), the Control Service:<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.2-2.1">
              <p id="section-2.1.2-2.1.1">selects the best combinations of PCBs and interfaces connecting to a neighboring AS (i.e., a child AS or a core AS). This is described in <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-2.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.2-2.2">
              <p id="section-2.1.2-2.2.1">propagates each selected PCB to the selected egress interface(s) associated with it. Selection policies are described in <a href="#path-segment-prop" class="auto internal xref">Section 2.3.5</a>.<a href="#section-2.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.1.2-3">For every selected PCB and egress interface combination, the AS Control Service appends an <em>AS entry</em> to the selected PCB. This includes a Hop Field that specifies the ingress and egress interface for the packet forwarding through this AS, in the beaconing direction. The AS entry can also contain peer entries.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pcb-propagation-illustrated-examples">
<section id="section-2.1.3">
          <h4 id="name-pcb-propagation-illustrated">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-pcb-propagation-illustrated" class="section-name selfRef">PCB Propagation - Illustrated Examples</a>
          </h4>
<p id="section-2.1.3-1">The following three figures show how intra-ISD PCB propagation works, from the ISD's core AS down to child ASes. Interface identifiers of each AS are numbered with integer values while ASes are described with an upper case letter for the sake of illustration. Arrows represent the PCB propagation direction.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<span id="name-intra-isd-pcb-propagation-f"></span><div id="_figure-3a">
<figure id="figure-2">
            <div id="section-2.1.3-2.1">
              <div class="alignLeft art-svg artwork" id="section-2.1.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="240" viewBox="0 0 240 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,160 L 8,240" fill="none" stroke="black"></path>
                  <path d="M 48,240 L 48,256" fill="none" stroke="black"></path>
                  <path d="M 64,32 L 64,128" fill="none" stroke="black"></path>
                  <path d="M 64,272 L 64,288" fill="none" stroke="black"></path>
                  <path d="M 80,160 L 80,240" fill="none" stroke="black"></path>
                  <path d="M 104,128 L 104,272" fill="none" stroke="black"></path>
                  <path d="M 136,128 L 136,272" fill="none" stroke="black"></path>
                  <path d="M 160,160 L 160,240" fill="none" stroke="black"></path>
                  <path d="M 176,32 L 176,128" fill="none" stroke="black"></path>
                  <path d="M 176,272 L 176,288" fill="none" stroke="black"></path>
                  <path d="M 192,240 L 192,256" fill="none" stroke="black"></path>
                  <path d="M 232,160 L 232,240" fill="none" stroke="black"></path>
                  <path d="M 64,32 L 176,32" fill="none" stroke="black"></path>
                  <path d="M 64,128 L 176,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 80,160" fill="none" stroke="black"></path>
                  <path d="M 160,160 L 232,160" fill="none" stroke="black"></path>
                  <path d="M 8,190 L 80,190" fill="none" stroke="black"></path>
                  <path d="M 8,194 L 80,194" fill="none" stroke="black"></path>
                  <path d="M 160,190 L 232,190" fill="none" stroke="black"></path>
                  <path d="M 160,194 L 232,194" fill="none" stroke="black"></path>
                  <path d="M 8,240 L 80,240" fill="none" stroke="black"></path>
                  <path d="M 160,240 L 232,240" fill="none" stroke="black"></path>
                  <path d="M 64,272 L 176,272" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="200,256 188,250.4 188,261.6" fill="black" transform="rotate(90,192,256)"></polygon>
                  <polygon class="arrowhead" points="56,256 44,250.4 44,261.6" fill="black" transform="rotate(90,48,256)"></polygon>
                  <circle cx="104" cy="256" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="136" cy="256" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <g class="text">
                    <text x="100" y="84">Core</text>
                    <text x="132" y="84">AS</text>
                    <text x="152" y="84">X</text>
                    <text x="104" y="116">2</text>
                    <text x="136" y="116">1</text>
                    <text x="32" y="180">PCB</text>
                    <text x="56" y="180">a</text>
                    <text x="184" y="180">PCB</text>
                    <text x="208" y="180">b</text>
                    <text x="36" y="212">Core</text>
                    <text x="180" y="212">Core</text>
                    <text x="16" y="228">-</text>
                    <text x="48" y="228">Out:2</text>
                    <text x="168" y="228">-</text>
                    <text x="200" y="228">Out:1</text>
                    <text x="108" y="292">AS</text>
                    <text x="128" y="292">Y</text>
                  </g>
                </svg><a href="#section-2.1.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-intra-isd-pcb-propagation-f" class="selfRef">Intra-ISD PCB propagation from the ISD core to child ASes - Part 1</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-3">In <a href="#_figure-3a" class="auto internal xref">Figure 2</a>, core AS X sends the two different PCBs "a" and "b" via two different links to child AS Y: PCB "a" exits core AS X via egress interface "2", whereas PCB "b" is sent over egress interface "1". Core AS X adds the respective egress information to the PCBs when sending them off, as can be seen in the figure (the entries "<em>Core - Out:2</em>" and "<em>Core - Out:1</em>", respectively).<a href="#section-2.1.3-3" class="pilcrow">¶</a></p>
<span id="name-intra-isd-pcb-propagation-fr"></span><div id="_figure-3b">
<figure id="figure-3">
            <div id="section-2.1.3-4.1">
              <div class="alignLeft art-svg artwork" id="section-2.1.3-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="512" width="448" viewBox="0 0 448 512" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,112 L 8,208" fill="none" stroke="black"></path>
                  <path d="M 16,240 L 16,416" fill="none" stroke="black"></path>
                  <path d="M 56,416 L 56,432" fill="none" stroke="black"></path>
                  <path d="M 88,240 L 88,416" fill="none" stroke="black"></path>
                  <path d="M 112,32 L 112,64" fill="none" stroke="black"></path>
                  <path d="M 112,240 L 112,416" fill="none" stroke="black"></path>
                  <path d="M 120,112 L 120,208" fill="none" stroke="black"></path>
                  <path d="M 152,64 L 152,80" fill="none" stroke="black"></path>
                  <path d="M 152,416 L 152,432" fill="none" stroke="black"></path>
                  <path d="M 168,112 L 168,208" fill="none" stroke="black"></path>
                  <path d="M 168,464 L 168,480" fill="none" stroke="black"></path>
                  <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                  <path d="M 184,240 L 184,416" fill="none" stroke="black"></path>
                  <path d="M 208,32 L 208,112" fill="none" stroke="black"></path>
                  <path d="M 208,208 L 208,464" fill="none" stroke="black"></path>
                  <path d="M 240,32 L 240,112" fill="none" stroke="black"></path>
                  <path d="M 240,208 L 240,464" fill="none" stroke="black"></path>
                  <path d="M 264,32 L 264,64" fill="none" stroke="black"></path>
                  <path d="M 264,240 L 264,416" fill="none" stroke="black"></path>
                  <path d="M 280,112 L 280,208" fill="none" stroke="black"></path>
                  <path d="M 280,464 L 280,480" fill="none" stroke="black"></path>
                  <path d="M 296,64 L 296,80" fill="none" stroke="black"></path>
                  <path d="M 296,416 L 296,432" fill="none" stroke="black"></path>
                  <path d="M 328,112 L 328,208" fill="none" stroke="black"></path>
                  <path d="M 336,32 L 336,64" fill="none" stroke="black"></path>
                  <path d="M 336,240 L 336,416" fill="none" stroke="black"></path>
                  <path d="M 360,240 L 360,416" fill="none" stroke="black"></path>
                  <path d="M 392,416 L 392,432" fill="none" stroke="black"></path>
                  <path d="M 432,240 L 432,416" fill="none" stroke="black"></path>
                  <path d="M 440,112 L 440,208" fill="none" stroke="black"></path>
                  <path d="M 112,32 L 184,32" fill="none" stroke="black"></path>
                  <path d="M 264,32 L 336,32" fill="none" stroke="black"></path>
                  <path d="M 112,64 L 184,64" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 336,64" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 120,112" fill="none" stroke="black"></path>
                  <path d="M 168,112 L 280,112" fill="none" stroke="black"></path>
                  <path d="M 328,112 L 440,112" fill="none" stroke="black"></path>
                  <path d="M 136,144 L 152,144" fill="none" stroke="black"></path>
                  <path d="M 296,176 L 312,176" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 120,208" fill="none" stroke="black"></path>
                  <path d="M 168,208 L 280,208" fill="none" stroke="black"></path>
                  <path d="M 328,208 L 440,208" fill="none" stroke="black"></path>
                  <path d="M 16,240 L 88,240" fill="none" stroke="black"></path>
                  <path d="M 112,240 L 184,240" fill="none" stroke="black"></path>
                  <path d="M 264,240 L 336,240" fill="none" stroke="black"></path>
                  <path d="M 360,240 L 432,240" fill="none" stroke="black"></path>
                  <path d="M 16,270 L 88,270" fill="none" stroke="black"></path>
                  <path d="M 16,274 L 88,274" fill="none" stroke="black"></path>
                  <path d="M 112,270 L 184,270" fill="none" stroke="black"></path>
                  <path d="M 112,274 L 184,274" fill="none" stroke="black"></path>
                  <path d="M 264,270 L 336,270" fill="none" stroke="black"></path>
                  <path d="M 264,274 L 336,274" fill="none" stroke="black"></path>
                  <path d="M 360,270 L 432,270" fill="none" stroke="black"></path>
                  <path d="M 360,274 L 432,274" fill="none" stroke="black"></path>
                  <path d="M 16,320 L 88,320" fill="none" stroke="black"></path>
                  <path d="M 112,320 L 184,320" fill="none" stroke="black"></path>
                  <path d="M 264,320 L 336,320" fill="none" stroke="black"></path>
                  <path d="M 360,320 L 432,320" fill="none" stroke="black"></path>
                  <path d="M 16,416 L 88,416" fill="none" stroke="black"></path>
                  <path d="M 112,416 L 184,416" fill="none" stroke="black"></path>
                  <path d="M 264,416 L 336,416" fill="none" stroke="black"></path>
                  <path d="M 360,416 L 432,416" fill="none" stroke="black"></path>
                  <path d="M 168,464 L 280,464" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="400,432 388,426.4 388,437.6" fill="black" transform="rotate(90,392,432)"></polygon>
                  <polygon class="arrowhead" points="304,432 292,426.4 292,437.6" fill="black" transform="rotate(90,296,432)"></polygon>
                  <polygon class="arrowhead" points="304,80 292,74.4 292,85.6" fill="black" transform="rotate(90,296,80)"></polygon>
                  <polygon class="arrowhead" points="160,432 148,426.4 148,437.6" fill="black" transform="rotate(90,152,432)"></polygon>
                  <polygon class="arrowhead" points="160,80 148,74.4 148,85.6" fill="black" transform="rotate(90,152,80)"></polygon>
                  <polygon class="arrowhead" points="64,432 52,426.4 52,437.6" fill="black" transform="rotate(90,56,432)"></polygon>
                  <circle cx="208" cy="96" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="208" cy="448" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="240" cy="96" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="240" cy="448" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <g class="text">
                    <text x="136" y="52">PCB</text>
                    <text x="160" y="52">a</text>
                    <text x="288" y="52">PCB</text>
                    <text x="312" y="52">b</text>
                    <text x="208" y="132">2</text>
                    <text x="240" y="132">3</text>
                    <text x="128" y="148">p</text>
                    <text x="160" y="148">p</text>
                    <text x="184" y="148">1</text>
                    <text x="52" y="164">AS</text>
                    <text x="72" y="164">V</text>
                    <text x="212" y="164">AS</text>
                    <text x="232" y="164">Y</text>
                    <text x="372" y="164">AS</text>
                    <text x="392" y="164">W</text>
                    <text x="264" y="180">4</text>
                    <text x="288" y="180">p</text>
                    <text x="320" y="180">p</text>
                    <text x="208" y="196">6</text>
                    <text x="240" y="196">5</text>
                    <text x="40" y="260">PCB</text>
                    <text x="64" y="260">e</text>
                    <text x="136" y="260">PCB</text>
                    <text x="160" y="260">c</text>
                    <text x="288" y="260">PCB</text>
                    <text x="312" y="260">d</text>
                    <text x="384" y="260">PCB</text>
                    <text x="408" y="260">f</text>
                    <text x="36" y="292">Core</text>
                    <text x="64" y="292">X</text>
                    <text x="132" y="292">Core</text>
                    <text x="160" y="292">X</text>
                    <text x="284" y="292">Core</text>
                    <text x="312" y="292">X</text>
                    <text x="380" y="292">Core</text>
                    <text x="408" y="292">X</text>
                    <text x="24" y="308">-</text>
                    <text x="56" y="308">Out:1</text>
                    <text x="120" y="308">-</text>
                    <text x="152" y="308">Out:2</text>
                    <text x="272" y="308">-</text>
                    <text x="304" y="308">Out:2</text>
                    <text x="368" y="308">-</text>
                    <text x="400" y="308">Out:1</text>
                    <text x="28" y="340">AS</text>
                    <text x="48" y="340">Y</text>
                    <text x="124" y="340">AS</text>
                    <text x="144" y="340">Y</text>
                    <text x="276" y="340">AS</text>
                    <text x="296" y="340">Y</text>
                    <text x="372" y="340">AS</text>
                    <text x="392" y="340">Y</text>
                    <text x="40" y="356">-In:3</text>
                    <text x="136" y="356">-In:2</text>
                    <text x="288" y="356">-In:2</text>
                    <text x="384" y="356">-In:3</text>
                    <text x="44" y="372">-Out:6</text>
                    <text x="140" y="372">-Out:6</text>
                    <text x="292" y="372">-Out:5</text>
                    <text x="388" y="372">-Out:5</text>
                    <text x="52" y="388">-PeerV:1</text>
                    <text x="148" y="388">-PeerV:1</text>
                    <text x="300" y="388">-PeerV:1</text>
                    <text x="396" y="388">-PeerV:1</text>
                    <text x="52" y="404">-PeerW:4</text>
                    <text x="148" y="404">-PeerW:4</text>
                    <text x="300" y="404">-PeerW:4</text>
                    <text x="396" y="404">-PeerW:4</text>
                    <text x="212" y="484">AS</text>
                    <text x="232" y="484">Z</text>
                  </g>
                </svg><a href="#section-2.1.3-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-intra-isd-pcb-propagation-fr" class="selfRef">Intra-ISD PCB propagation from the ISD core to child ASes - Part 2</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-5">In <a href="#_figure-3b" class="auto internal xref">Figure 3</a>, AS Y receives the two PCBs "a" and "b" through two different (ingress) interfaces, namely "2" and "3", respectively. Additionally, AS Y forwards to AS Z four PCBs that were previously sent by core AS X. For this, AS Y uses the two different (egress) links "5" and "6". AS Y appends the corresponding ingress and egress interface information to the four PCBs.<a href="#section-2.1.3-5" class="pilcrow">¶</a></p>
<p id="section-2.1.3-6">AS Y also has two peering links to its neighboring peers V and W, through the interfaces "1" and "4" respectively, which is included in the information in the PCBs. Thus, each forwarded PCB accumulates path information on its way "down" from core AS X.<a href="#section-2.1.3-6" class="pilcrow">¶</a></p>
<span id="name-intra-isd-pcb-propagation-fro"></span><div id="_figure-3c">
<figure id="figure-4">
            <div id="section-2.1.3-7.1">
              <div class="alignLeft art-svg artwork" id="section-2.1.3-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="544" width="432" viewBox="0 0 432 544" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                  <path d="M 8,240 L 8,480" fill="none" stroke="black"></path>
                  <path d="M 48,64 L 48,80" fill="none" stroke="black"></path>
                  <path d="M 48,480 L 48,496" fill="none" stroke="black"></path>
                  <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                  <path d="M 80,240 L 80,480" fill="none" stroke="black"></path>
                  <path d="M 104,32 L 104,64" fill="none" stroke="black"></path>
                  <path d="M 104,240 L 104,480" fill="none" stroke="black"></path>
                  <path d="M 144,64 L 144,80" fill="none" stroke="black"></path>
                  <path d="M 144,480 L 144,496" fill="none" stroke="black"></path>
                  <path d="M 160,112 L 160,208" fill="none" stroke="black"></path>
                  <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
                  <path d="M 176,240 L 176,480" fill="none" stroke="black"></path>
                  <path d="M 200,32 L 200,112" fill="none" stroke="black"></path>
                  <path d="M 216,208 L 216,512" fill="none" stroke="black"></path>
                  <path d="M 232,32 L 232,112" fill="none" stroke="black"></path>
                  <path d="M 256,32 L 256,64" fill="none" stroke="black"></path>
                  <path d="M 256,240 L 256,480" fill="none" stroke="black"></path>
                  <path d="M 272,112 L 272,208" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 288,80" fill="none" stroke="black"></path>
                  <path d="M 288,480 L 288,496" fill="none" stroke="black"></path>
                  <path d="M 328,32 L 328,64" fill="none" stroke="black"></path>
                  <path d="M 328,240 L 328,480" fill="none" stroke="black"></path>
                  <path d="M 352,32 L 352,64" fill="none" stroke="black"></path>
                  <path d="M 352,240 L 352,480" fill="none" stroke="black"></path>
                  <path d="M 384,64 L 384,80" fill="none" stroke="black"></path>
                  <path d="M 384,480 L 384,496" fill="none" stroke="black"></path>
                  <path d="M 424,32 L 424,64" fill="none" stroke="black"></path>
                  <path d="M 424,240 L 424,480" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                  <path d="M 104,32 L 176,32" fill="none" stroke="black"></path>
                  <path d="M 256,32 L 328,32" fill="none" stroke="black"></path>
                  <path d="M 352,32 L 424,32" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
                  <path d="M 104,64 L 176,64" fill="none" stroke="black"></path>
                  <path d="M 256,64 L 328,64" fill="none" stroke="black"></path>
                  <path d="M 352,64 L 424,64" fill="none" stroke="black"></path>
                  <path d="M 160,112 L 272,112" fill="none" stroke="black"></path>
                  <path d="M 160,208 L 272,208" fill="none" stroke="black"></path>
                  <path d="M 8,240 L 80,240" fill="none" stroke="black"></path>
                  <path d="M 104,240 L 176,240" fill="none" stroke="black"></path>
                  <path d="M 256,240 L 328,240" fill="none" stroke="black"></path>
                  <path d="M 352,240 L 424,240" fill="none" stroke="black"></path>
                  <path d="M 8,270 L 80,270" fill="none" stroke="black"></path>
                  <path d="M 8,274 L 80,274" fill="none" stroke="black"></path>
                  <path d="M 104,270 L 176,270" fill="none" stroke="black"></path>
                  <path d="M 104,274 L 176,274" fill="none" stroke="black"></path>
                  <path d="M 256,270 L 328,270" fill="none" stroke="black"></path>
                  <path d="M 256,274 L 328,274" fill="none" stroke="black"></path>
                  <path d="M 352,270 L 424,270" fill="none" stroke="black"></path>
                  <path d="M 352,274 L 424,274" fill="none" stroke="black"></path>
                  <path d="M 8,320 L 80,320" fill="none" stroke="black"></path>
                  <path d="M 104,320 L 176,320" fill="none" stroke="black"></path>
                  <path d="M 256,320 L 328,320" fill="none" stroke="black"></path>
                  <path d="M 352,320 L 424,320" fill="none" stroke="black"></path>
                  <path d="M 8,416 L 80,416" fill="none" stroke="black"></path>
                  <path d="M 104,416 L 176,416" fill="none" stroke="black"></path>
                  <path d="M 256,416 L 328,416" fill="none" stroke="black"></path>
                  <path d="M 352,416 L 424,416" fill="none" stroke="black"></path>
                  <path d="M 8,480 L 80,480" fill="none" stroke="black"></path>
                  <path d="M 104,480 L 176,480" fill="none" stroke="black"></path>
                  <path d="M 256,480 L 328,480" fill="none" stroke="black"></path>
                  <path d="M 352,480 L 424,480" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="392,496 380,490.4 380,501.6" fill="black" transform="rotate(90,384,496)"></polygon>
                  <polygon class="arrowhead" points="392,80 380,74.4 380,85.6" fill="black" transform="rotate(90,384,80)"></polygon>
                  <polygon class="arrowhead" points="296,496 284,490.4 284,501.6" fill="black" transform="rotate(90,288,496)"></polygon>
                  <polygon class="arrowhead" points="296,80 284,74.4 284,85.6" fill="black" transform="rotate(90,288,80)"></polygon>
                  <polygon class="arrowhead" points="152,496 140,490.4 140,501.6" fill="black" transform="rotate(90,144,496)"></polygon>
                  <polygon class="arrowhead" points="152,80 140,74.4 140,85.6" fill="black" transform="rotate(90,144,80)"></polygon>
                  <polygon class="arrowhead" points="56,496 44,490.4 44,501.6" fill="black" transform="rotate(90,48,496)"></polygon>
                  <polygon class="arrowhead" points="56,80 44,74.4 44,85.6" fill="black" transform="rotate(90,48,80)"></polygon>
                  <circle cx="200" cy="96" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="216" cy="496" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="232" cy="96" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <g class="text">
                    <text x="32" y="52">PCB</text>
                    <text x="56" y="52">e</text>
                    <text x="128" y="52">PCB</text>
                    <text x="152" y="52">c</text>
                    <text x="280" y="52">PCB</text>
                    <text x="304" y="52">d</text>
                    <text x="376" y="52">PCB</text>
                    <text x="400" y="52">f</text>
                    <text x="200" y="132">5</text>
                    <text x="232" y="132">1</text>
                    <text x="204" y="164">AS</text>
                    <text x="224" y="164">Z</text>
                    <text x="216" y="196">3</text>
                    <text x="32" y="260">PCB</text>
                    <text x="56" y="260">i</text>
                    <text x="128" y="260">PCB</text>
                    <text x="152" y="260">g</text>
                    <text x="280" y="260">PCB</text>
                    <text x="304" y="260">h</text>
                    <text x="376" y="260">PCB</text>
                    <text x="400" y="260">j</text>
                    <text x="28" y="292">Core</text>
                    <text x="56" y="292">X</text>
                    <text x="124" y="292">Core</text>
                    <text x="152" y="292">X</text>
                    <text x="276" y="292">Core</text>
                    <text x="304" y="292">X</text>
                    <text x="372" y="292">Core</text>
                    <text x="400" y="292">X</text>
                    <text x="16" y="308">-</text>
                    <text x="48" y="308">Out:1</text>
                    <text x="112" y="308">-</text>
                    <text x="144" y="308">Out:2</text>
                    <text x="264" y="308">-</text>
                    <text x="296" y="308">Out:2</text>
                    <text x="360" y="308">-</text>
                    <text x="392" y="308">Out:1</text>
                    <text x="20" y="340">AS</text>
                    <text x="40" y="340">Y</text>
                    <text x="116" y="340">AS</text>
                    <text x="136" y="340">Y</text>
                    <text x="268" y="340">AS</text>
                    <text x="288" y="340">Y</text>
                    <text x="364" y="340">AS</text>
                    <text x="384" y="340">Y</text>
                    <text x="32" y="356">-In:3</text>
                    <text x="128" y="356">-In:2</text>
                    <text x="280" y="356">-In:2</text>
                    <text x="376" y="356">-In:3</text>
                    <text x="36" y="372">-Out:6</text>
                    <text x="132" y="372">-Out:6</text>
                    <text x="284" y="372">-Out:5</text>
                    <text x="376" y="372">Out:5</text>
                    <text x="44" y="388">-PeerV:1</text>
                    <text x="140" y="388">-PeerV:1</text>
                    <text x="292" y="388">-PeerV:1</text>
                    <text x="388" y="388">-PeerV:1</text>
                    <text x="44" y="404">-PeerW:4</text>
                    <text x="140" y="404">-PeerW:4</text>
                    <text x="292" y="404">-PeerW:4</text>
                    <text x="388" y="404">-PeerW:4</text>
                    <text x="20" y="436">AS</text>
                    <text x="40" y="436">Z</text>
                    <text x="116" y="436">AS</text>
                    <text x="136" y="436">Z</text>
                    <text x="268" y="436">AS</text>
                    <text x="288" y="436">Z</text>
                    <text x="364" y="436">AS</text>
                    <text x="384" y="436">Z</text>
                    <text x="32" y="452">-In:5</text>
                    <text x="128" y="452">-In:5</text>
                    <text x="280" y="452">-In:1</text>
                    <text x="376" y="452">-In:1</text>
                    <text x="36" y="468">-Out:3</text>
                    <text x="132" y="468">-Out:3</text>
                    <text x="284" y="468">-Out:3</text>
                    <text x="380" y="468">-Out:3</text>
                  </g>
                </svg><a href="#section-2.1.3-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-intra-isd-pcb-propagation-fro" class="selfRef">Intra-ISD PCB propagation from the ISD core to child ASes - Part 3</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-8">In <a href="#_figure-3c" class="auto internal xref">Figure 4</a>, the four PCBs "c", "d", "e", and "f" are coming from AS Y and are received by AS Z over two different links: PCBs "c" and "e" reach AS Z over ingress interface "5", whereas PCBs "d" and "f" enter AS Z via ingress interface "1". Additionally, AS Z propagates PCBs "g", "h", "i", and "j" further downwards over the same link (egress interface "3"), and extends the PCBs with the relevant information so that each of these includes AS hop entries from core AS X, AS Y, and AS Z.<a href="#section-2.1.3-8" class="pilcrow">¶</a></p>
<span id="name-possible-up-or-down-segment"></span><div id="_figure-4">
<figure id="figure-5">
            <div id="section-2.1.3-9.1">
              <div class="alignLeft art-svg artwork" id="section-2.1.3-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="736" width="568" viewBox="0 0 568 736" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 128,64 L 128,160" fill="none" stroke="black"></path>
                  <path d="M 128,240 L 128,336" fill="none" stroke="black"></path>
                  <path d="M 128,416 L 128,512" fill="none" stroke="black"></path>
                  <path d="M 128,592 L 128,688" fill="none" stroke="black"></path>
                  <path d="M 240,64 L 240,160" fill="none" stroke="black"></path>
                  <path d="M 240,240 L 240,336" fill="none" stroke="black"></path>
                  <path d="M 240,416 L 240,512" fill="none" stroke="black"></path>
                  <path d="M 240,592 L 240,688" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 288,160" fill="none" stroke="black"></path>
                  <path d="M 288,240 L 288,336" fill="none" stroke="black"></path>
                  <path d="M 288,416 L 288,512" fill="none" stroke="black"></path>
                  <path d="M 288,592 L 288,688" fill="none" stroke="black"></path>
                  <path d="M 344,272 L 344,304" fill="none" stroke="black"></path>
                  <path d="M 344,448 L 344,480" fill="none" stroke="black"></path>
                  <path d="M 400,64 L 400,160" fill="none" stroke="black"></path>
                  <path d="M 400,240 L 400,336" fill="none" stroke="black"></path>
                  <path d="M 400,416 L 400,512" fill="none" stroke="black"></path>
                  <path d="M 400,592 L 400,688" fill="none" stroke="black"></path>
                  <path d="M 448,64 L 448,160" fill="none" stroke="black"></path>
                  <path d="M 448,240 L 448,264" fill="none" stroke="black"></path>
                  <path d="M 448,280 L 448,336" fill="none" stroke="black"></path>
                  <path d="M 448,416 L 448,512" fill="none" stroke="black"></path>
                  <path d="M 448,592 L 448,688" fill="none" stroke="black"></path>
                  <path d="M 560,64 L 560,160" fill="none" stroke="black"></path>
                  <path d="M 560,240 L 560,336" fill="none" stroke="black"></path>
                  <path d="M 560,416 L 560,512" fill="none" stroke="black"></path>
                  <path d="M 560,592 L 560,688" fill="none" stroke="black"></path>
                  <path d="M 128,64 L 240,64" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 400,64" fill="none" stroke="black"></path>
                  <path d="M 448,64 L 560,64" fill="none" stroke="black"></path>
                  <path d="M 240,128 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 280,128 L 288,128" fill="none" stroke="black"></path>
                  <path d="M 304,128 L 384,128" fill="none" stroke="black"></path>
                  <path d="M 400,128 L 424,128" fill="none" stroke="black"></path>
                  <path d="M 440,128 L 448,128" fill="none" stroke="black"></path>
                  <path d="M 128,160 L 240,160" fill="none" stroke="black"></path>
                  <path d="M 288,160 L 400,160" fill="none" stroke="black"></path>
                  <path d="M 448,160 L 560,160" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 560,208" fill="none" stroke="black"></path>
                  <path d="M 128,240 L 240,240" fill="none" stroke="black"></path>
                  <path d="M 288,240 L 400,240" fill="none" stroke="black"></path>
                  <path d="M 448,240 L 560,240" fill="none" stroke="black"></path>
                  <path d="M 344,272 L 384,272" fill="none" stroke="black"></path>
                  <path d="M 400,272 L 432,272" fill="none" stroke="black"></path>
                  <path d="M 448,272 L 456,272" fill="none" stroke="black"></path>
                  <path d="M 240,304 L 264,304" fill="none" stroke="black"></path>
                  <path d="M 280,304 L 288,304" fill="none" stroke="black"></path>
                  <path d="M 304,304 L 344,304" fill="none" stroke="black"></path>
                  <path d="M 128,336 L 240,336" fill="none" stroke="black"></path>
                  <path d="M 288,336 L 400,336" fill="none" stroke="black"></path>
                  <path d="M 448,336 L 560,336" fill="none" stroke="black"></path>
                  <path d="M 8,384 L 560,384" fill="none" stroke="black"></path>
                  <path d="M 128,416 L 240,416" fill="none" stroke="black"></path>
                  <path d="M 288,416 L 400,416" fill="none" stroke="black"></path>
                  <path d="M 448,416 L 560,416" fill="none" stroke="black"></path>
                  <path d="M 240,448 L 264,448" fill="none" stroke="black"></path>
                  <path d="M 280,448 L 288,448" fill="none" stroke="black"></path>
                  <path d="M 304,448 L 344,448" fill="none" stroke="black"></path>
                  <path d="M 344,480 L 384,480" fill="none" stroke="black"></path>
                  <path d="M 400,480 L 424,480" fill="none" stroke="black"></path>
                  <path d="M 440,480 L 448,480" fill="none" stroke="black"></path>
                  <path d="M 128,512 L 240,512" fill="none" stroke="black"></path>
                  <path d="M 288,512 L 400,512" fill="none" stroke="black"></path>
                  <path d="M 448,512 L 560,512" fill="none" stroke="black"></path>
                  <path d="M 8,560 L 560,560" fill="none" stroke="black"></path>
                  <path d="M 128,592 L 240,592" fill="none" stroke="black"></path>
                  <path d="M 288,592 L 400,592" fill="none" stroke="black"></path>
                  <path d="M 448,592 L 560,592" fill="none" stroke="black"></path>
                  <path d="M 240,624 L 264,624" fill="none" stroke="black"></path>
                  <path d="M 280,624 L 288,624" fill="none" stroke="black"></path>
                  <path d="M 304,624 L 384,624" fill="none" stroke="black"></path>
                  <path d="M 400,624 L 424,624" fill="none" stroke="black"></path>
                  <path d="M 440,624 L 448,624" fill="none" stroke="black"></path>
                  <path d="M 128,688 L 240,688" fill="none" stroke="black"></path>
                  <path d="M 288,688 L 400,688" fill="none" stroke="black"></path>
                  <path d="M 448,688 L 560,688" fill="none" stroke="black"></path>
                  <circle cx="272" cy="128" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="272" cy="304" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="272" cy="448" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="272" cy="624" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="432" cy="128" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="432" cy="480" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="432" cy="624" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <circle cx="440" cy="272" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <g class="text">
                    <text x="140" y="36">AS</text>
                    <text x="176" y="36">Entry</text>
                    <text x="220" y="36">Core</text>
                    <text x="308" y="36">AS</text>
                    <text x="344" y="36">Entry</text>
                    <text x="376" y="36">Y</text>
                    <text x="468" y="36">AS</text>
                    <text x="504" y="36">Entry</text>
                    <text x="536" y="36">Z</text>
                    <text x="164" y="84">Core</text>
                    <text x="196" y="84">AS</text>
                    <text x="216" y="84">X</text>
                    <text x="332" y="84">AS</text>
                    <text x="352" y="84">Y</text>
                    <text x="492" y="84">AS</text>
                    <text x="512" y="84">Z</text>
                    <text x="20" y="100">Path</text>
                    <text x="72" y="100">Segment</text>
                    <text x="112" y="100">1</text>
                    <text x="232" y="100">1</text>
                    <text x="296" y="100">3</text>
                    <text x="392" y="100">5</text>
                    <text x="456" y="100">1</text>
                    <text x="232" y="132">2</text>
                    <text x="296" y="132">2</text>
                    <text x="392" y="132">6</text>
                    <text x="456" y="132">5</text>
                    <text x="172" y="180">Egress</text>
                    <text x="208" y="180">2</text>
                    <text x="296" y="180">Ingress</text>
                    <text x="336" y="180">2</text>
                    <text x="352" y="180">-</text>
                    <text x="388" y="180">Egress</text>
                    <text x="424" y="180">6</text>
                    <text x="496" y="180">Ingress</text>
                    <text x="536" y="180">5</text>
                    <text x="164" y="260">Core</text>
                    <text x="196" y="260">AS</text>
                    <text x="216" y="260">X</text>
                    <text x="332" y="260">AS</text>
                    <text x="352" y="260">Y</text>
                    <text x="492" y="260">AS</text>
                    <text x="512" y="260">Z</text>
                    <text x="232" y="276">1</text>
                    <text x="296" y="276">3</text>
                    <text x="392" y="276">5</text>
                    <text x="464" y="276">1</text>
                    <text x="20" y="292">Path</text>
                    <text x="72" y="292">Segment</text>
                    <text x="112" y="292">2</text>
                    <text x="232" y="308">2</text>
                    <text x="296" y="308">2</text>
                    <text x="392" y="308">6</text>
                    <text x="456" y="308">5</text>
                    <text x="172" y="356">Egress</text>
                    <text x="208" y="356">2</text>
                    <text x="296" y="356">Ingress</text>
                    <text x="336" y="356">2</text>
                    <text x="352" y="356">-</text>
                    <text x="388" y="356">Egress</text>
                    <text x="424" y="356">5</text>
                    <text x="496" y="356">Ingress</text>
                    <text x="536" y="356">1</text>
                    <text x="164" y="436">Core</text>
                    <text x="196" y="436">AS</text>
                    <text x="216" y="436">X</text>
                    <text x="332" y="436">AS</text>
                    <text x="352" y="436">Y</text>
                    <text x="492" y="436">AS</text>
                    <text x="512" y="436">Z</text>
                    <text x="232" y="452">1</text>
                    <text x="296" y="452">3</text>
                    <text x="392" y="452">5</text>
                    <text x="456" y="452">1</text>
                    <text x="20" y="468">Path</text>
                    <text x="72" y="468">Segment</text>
                    <text x="112" y="468">3</text>
                    <text x="232" y="484">2</text>
                    <text x="296" y="484">2</text>
                    <text x="392" y="484">6</text>
                    <text x="456" y="484">5</text>
                    <text x="172" y="532">Egress</text>
                    <text x="208" y="532">1</text>
                    <text x="296" y="532">Ingress</text>
                    <text x="336" y="532">3</text>
                    <text x="352" y="532">-</text>
                    <text x="388" y="532">Egress</text>
                    <text x="424" y="532">6</text>
                    <text x="496" y="532">Ingress</text>
                    <text x="536" y="532">5</text>
                    <text x="164" y="612">Core</text>
                    <text x="196" y="612">AS</text>
                    <text x="216" y="612">X</text>
                    <text x="332" y="612">AS</text>
                    <text x="352" y="612">Y</text>
                    <text x="492" y="612">AS</text>
                    <text x="512" y="612">Z</text>
                    <text x="232" y="628">1</text>
                    <text x="296" y="628">3</text>
                    <text x="392" y="628">5</text>
                    <text x="456" y="628">1</text>
                    <text x="20" y="644">Path</text>
                    <text x="72" y="644">Segment</text>
                    <text x="112" y="644">4</text>
                    <text x="232" y="660">2</text>
                    <text x="296" y="660">2</text>
                    <text x="392" y="660">6</text>
                    <text x="456" y="660">5</text>
                    <text x="172" y="708">Egress</text>
                    <text x="208" y="708">1</text>
                    <text x="296" y="708">Ingress</text>
                    <text x="336" y="708">3</text>
                    <text x="352" y="708">-</text>
                    <text x="388" y="708">Egress</text>
                    <text x="424" y="708">5</text>
                    <text x="504" y="708">Ingress</text>
                    <text x="544" y="708">1</text>
                  </g>
                </svg><a href="#section-2.1.3-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-possible-up-or-down-segment" class="selfRef">Possible up- or down segments for AS Z</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-10">According to <a href="#_figure-3a" class="auto internal xref">Figure 2</a>, <a href="#_figure-3b" class="auto internal xref">Figure 3</a> and <a href="#_figure-3c" class="auto internal xref">Figure 4</a> above, it appears that a PCB represents a single path segment. However, there is a difference between a PCB and a registered path segment as a PCB is a so-called "travelling path segment" that accumulates AS entries when traversing SCION networks. A registered path segment is instead a "snapshot" of a travelling PCB at a given time T and from the vantage point of a particular AS A. This is illustrated by <a href="#_figure-4" class="auto internal xref">Figure 5</a> which shows several possible path segments to reach AS Z, based on the PCBs "g", "h", "i", and "j" from <a href="#_figure-3c" class="auto internal xref">Figure 4</a> above. It is up to AS Z to choose which of these path segments to use.<a href="#section-2.1.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pcbs">
<section id="section-2.2">
        <h3 id="name-pcb-message-format">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-pcb-message-format" class="section-name selfRef">PCB Message Format</a>
        </h3>
<p id="section-2.2-1">Each PCB is comprised of a message containing the following top-level fields:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span id="name-pcb-top-level-message-forma"></span><div id="_figure-6">
<figure id="figure-6">
          <div id="section-2.2-2.1">
            <div class="alignLeft art-svg artwork" id="section-2.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="96" width="488" viewBox="0 0 488 96" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,64" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,64" fill="none" stroke="black"></path>
                <path d="M 328,32 L 328,64" fill="none" stroke="black"></path>
                <path d="M 376,32 L 376,64" fill="none" stroke="black"></path>
                <path d="M 480,32 L 480,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 480,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 480,64" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="40" y="52">Segment</text>
                  <text x="92" y="52">Info</text>
                  <text x="140" y="52">AS</text>
                  <text x="176" y="52">Entry</text>
                  <text x="208" y="52">0</text>
                  <text x="244" y="52">AS</text>
                  <text x="280" y="52">Entry</text>
                  <text x="312" y="52">1</text>
                  <text x="352" y="52">...</text>
                  <text x="396" y="52">AS</text>
                  <text x="432" y="52">Entry</text>
                  <text x="464" y="52">N</text>
                </g>
              </svg><a href="#section-2.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-pcb-top-level-message-forma" class="selfRef">PCB Top-Level Message Format</a>
          </figcaption></figure>
</div>
<p id="section-2.2-3">Each PCB <span class="bcp14">MUST</span> consist of at least:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-4.1">
            <p id="section-2.2-4.1.1">An information field with an identifier and a timestamp.<a href="#section-2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-4.2">
            <p id="section-2.2-4.2.1">Entries of all ASes on the path segment represented by this PCB.<a href="#section-2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-5">The PCB top level Protobuf message format is:<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-6">
<pre>
   message PathSegment {
       bytes segment_info = 1;
       repeated ASEntry as_entries = 2;
   }
</pre><a href="#section-2.2-6" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2-7.1">
            <p id="section-2.2-7.1.1"><code>segment_info</code>: This field is used as input for the PCB signature. It is the encoded version of the <code>SegmentInformation</code> component which provides basic information about the PCB. This component is specified in detail in <a href="#seginfo" class="auto internal xref">Section 2.2.1</a>.<a href="#section-2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-7.2">
            <p id="section-2.2-7.2.1"><code>as_entries</code>: Contains the <code>ASEntry</code> component of all ASes on the path segment represented by this PCB. The order of the AS entries <span class="bcp14">MUST</span> correspond to the path traversal order in the PCB propagation direction.<a href="#section-2.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-7.3">
            <p id="section-2.2-7.3.1"><code>ASEntry</code>: The <code>ASEntry</code> component contains the complete path information of a specific AS that is part of the path segment represented by the PCB. This component is specified in detail in <a href="#as-entry" class="auto internal xref">Section 2.2.2</a>.<a href="#section-2.2-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-8">The information to be included in each of these fields is described below.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<div id="seginfo">
<section id="section-2.2.1">
          <h4 id="name-segment-information">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-segment-information" class="section-name selfRef">Segment Information</a>
          </h4>
<span id="name-segment-information-compone"></span><div id="_figure-7">
<figure id="figure-7">
            <div id="section-2.2.1-1.1">
              <div class="alignLeft art-svg artwork" id="section-2.2.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="248" viewBox="0 0 248 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                  <path d="M 120,64 L 120,80" fill="none" stroke="black"></path>
                  <path d="M 120,112 L 120,144" fill="none" stroke="black"></path>
                  <path d="M 240,32 L 240,64" fill="none" stroke="black"></path>
                  <path d="M 240,112 L 240,144" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 240,32" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 240,64" fill="none" stroke="black"></path>
                  <path d="M 24,96 L 104,96" fill="none" stroke="black"></path>
                  <path d="M 136,96 L 224,96" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 240,112" fill="none" stroke="black"></path>
                  <path d="M 8,144 L 240,144" fill="none" stroke="black"></path>
                  <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                  <path d="M 104,96 C 112.83064,96 120,88.83064 120,80" fill="none" stroke="black"></path>
                  <path d="M 136,96 C 127.16936,96 120,88.83064 120,80" fill="none" stroke="black"></path>
                  <path d="M 224,96 C 232.83064,96 240,103.16936 240,112" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="112" y="52">Segment</text>
                    <text x="164" y="52">Info</text>
                    <text x="64" y="132">Timestamp</text>
                    <text x="168" y="132">Seg</text>
                    <text x="196" y="132">ID</text>
                  </g>
                </svg><a href="#section-2.2.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-segment-information-compone" class="selfRef">Segment Information Component</a>
            </figcaption></figure>
</div>
<p id="section-2.2.1-2">Each PCB <span class="bcp14">MUST</span> include a <code>SegmentInformation</code> message with basic information about the PCB. Its Protobuf message format is:<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-3">
<pre>
   message SegmentInformation {
       int64 timestamp = 1;
       uint32 segment_id = 2;
   }
</pre><a href="#section-2.2.1-3" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.1-4.1">
              <p id="section-2.2.1-4.1.1"><code>timestamp</code>: The timestamp indicates the creation time of this PCB. It is set by the originating core AS and the expiration time of each Hop Field in the PCB is computed relative to this timestamp. The timestamp is encoded as the number of seconds elapsed since the POSIX Epoch (1970-01-01 00:00:00 UTC). Note that this timestamp is encoded as a 32-bit unsigned integer in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-2.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-4.2">
              <p id="section-2.2.1-4.2.1"><code>segment_id</code>: The 16-bit identifier of this PCB and the corresponding path segment. The segment ID is <span class="bcp14">REQUIRED</span> for the computation of the message authentication code (MAC) of an AS's Hop Field. The MAC is used for Hop Field verification in the data plane and the originating core AS <span class="bcp14">MUST</span> fill this field with a cryptographically random number.<a href="#section-2.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.1-5"><strong>Note:</strong> See <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a> for more information on the Hop Field message format. <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> provides a detailed description of the computation of the MAC and the verification of the Hop Field in the data plane.<a href="#section-2.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-entry">
<section id="section-2.2.2">
          <h4 id="name-as-entry">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-as-entry" class="section-name selfRef">AS Entry</a>
          </h4>
<span id="name-as-entry-2"></span><div id="_figure-8">
<figure id="figure-8">
            <div id="section-2.2.2-1.1">
              <div class="alignLeft art-svg artwork" id="section-2.2.2-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="552" viewBox="0 0 552 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                  <path d="M 200,112 L 200,144" fill="none" stroke="black"></path>
                  <path d="M 224,32 L 224,64" fill="none" stroke="black"></path>
                  <path d="M 280,64 L 280,80" fill="none" stroke="black"></path>
                  <path d="M 344,32 L 344,64" fill="none" stroke="black"></path>
                  <path d="M 544,112 L 544,144" fill="none" stroke="black"></path>
                  <path d="M 224,32 L 344,32" fill="none" stroke="black"></path>
                  <path d="M 224,64 L 344,64" fill="none" stroke="black"></path>
                  <path d="M 24,96 L 264,96" fill="none" stroke="black"></path>
                  <path d="M 296,96 L 528,96" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 544,112" fill="none" stroke="black"></path>
                  <path d="M 8,144 L 544,144" fill="none" stroke="black"></path>
                  <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                  <path d="M 264,96 C 272.83064,96 280,88.83064 280,80" fill="none" stroke="black"></path>
                  <path d="M 296,96 C 287.16936,96 280,88.83064 280,80" fill="none" stroke="black"></path>
                  <path d="M 528,96 C 536.83064,96 544,103.16936 544,112" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="260" y="52">AS</text>
                    <text x="296" y="52">Entry</text>
                    <text x="60" y="132">Unsigned</text>
                    <text x="136" y="132">Extension</text>
                    <text x="332" y="132">Signed</text>
                    <text x="372" y="132">AS</text>
                    <text x="408" y="132">Entry</text>
                  </g>
                </svg><a href="#section-2.2.2-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-as-entry-2" class="selfRef">AS Entry</a>
            </figcaption></figure>
</div>
<p id="section-2.2.2-2">Each PCB <span class="bcp14">MUST</span> also contain the entries of all ASes included in the corresponding path segment. This means that the originating core AS <span class="bcp14">MUST</span> add its AS entry to each PCB it creates, and each traversed AS <span class="bcp14">MUST</span> attach its AS entry to the PCB.<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2-3">One AS entry contains the complete hop information for this specific AS in this specific path segment. It consists of a signed and an unsigned component.<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2.2-4">The code block below defines an AS entry <code>ASEntry</code> in Protobuf message format.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-5">
<pre>
   message ASEntry {
       SignedMessage signed = 1;
       PathSegmentUnsignedExtensions unsigned = 2;
   }
</pre><a href="#section-2.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-6">It includes the following components:<a href="#section-2.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-7.1">
              <p id="section-2.2.2-7.1.1"><code>SignedMessage</code>: The AS entry signed component.<a href="#section-2.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-7.2">
              <p id="section-2.2.2-7.2.1"><code>PathSegmentUnsignedExtensions</code>: Optional unsigned PCB extensions, further described in <a href="#pcb-ext" class="auto internal xref">Section 2.2.3</a>.<a href="#section-2.2.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-as-entry-signed-component"></span><div id="_figure-9">
<figure id="figure-9">
            <div id="section-2.2.2-8.1">
              <div class="alignLeft art-svg artwork" id="section-2.2.2-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="576" viewBox="0 0 576 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                  <path d="M 72,32 L 72,64" fill="none" stroke="black"></path>
                  <path d="M 176,112 L 176,144" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 288,80" fill="none" stroke="black"></path>
                  <path d="M 328,112 L 328,144" fill="none" stroke="black"></path>
                  <path d="M 512,32 L 512,64" fill="none" stroke="black"></path>
                  <path d="M 568,112 L 568,144" fill="none" stroke="black"></path>
                  <path d="M 72,32 L 512,32" fill="none" stroke="black"></path>
                  <path d="M 72,64 L 512,64" fill="none" stroke="black"></path>
                  <path d="M 24,96 L 272,96" fill="none" stroke="black"></path>
                  <path d="M 304,96 L 552,96" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 568,112" fill="none" stroke="black"></path>
                  <path d="M 8,144 L 568,144" fill="none" stroke="black"></path>
                  <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                  <path d="M 272,96 C 280.83064,96 288,88.83064 288,80" fill="none" stroke="black"></path>
                  <path d="M 304,96 C 295.16936,96 288,88.83064 288,80" fill="none" stroke="black"></path>
                  <path d="M 552,96 C 560.83064,96 568,103.16936 568,112" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="252" y="52">Signed</text>
                    <text x="292" y="52">AS</text>
                    <text x="328" y="52">Entry</text>
                    <text x="88" y="132">Signature</text>
                    <text x="252" y="132">Header</text>
                    <text x="452" y="132">Body</text>
                  </g>
                </svg><a href="#section-2.2.2-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-as-entry-signed-component" class="selfRef">AS Entry Signed Component</a>
            </figcaption></figure>
</div>
<p id="section-2.2.2-9">Each AS entry of a PCB <span class="bcp14">MUST</span> include a signed component as well as a signature computed over the signed component. Each AS entry <span class="bcp14">MUST</span> be signed with the Control Plane AS Certificate (see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>).<a href="#section-2.2.2-9" class="pilcrow">¶</a></p>
<p id="section-2.2.2-10">The signed component of an AS entry <span class="bcp14">MUST</span> include the following elements:<a href="#section-2.2.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-11.1">
              <p id="section-2.2.2-11.1.1">a header,<a href="#section-2.2.2-11.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-11.2">
              <p id="section-2.2.2-11.2.1">a body, and<a href="#section-2.2.2-11.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-11.3">
              <p id="section-2.2.2-11.3.1">a signature.<a href="#section-2.2.2-11.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.2-12">In the Protobuf message format, the signed component of an AS entry is specified by the <code>SignedMessage</code>. It consists of a header-and-body part (<code>header_and_body</code>) and a raw signature (<code>signature</code>). Their protobuf message formats are:<a href="#section-2.2.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-13">
<pre>
   message SignedMessage {
       bytes header_and_body = 1;
       bytes signature = 2;
   }
</pre><a href="#section-2.2.2-13" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-14">Protobuf definition of the <code>HeaderAndBody</code> message used for signature computation input.<a href="#section-2.2.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-15">
<pre>
   message HeaderAndBody {
       bytes header = 1;
       bytes body = 2;
   }
</pre><a href="#section-2.2.2-15" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2-16">The Signed Header, Signed Body, and Signature Fields are detailed below.<a href="#section-2.2.2-16" class="pilcrow">¶</a></p>
<div id="ase-header">
<section id="section-2.2.2.1">
            <h5 id="name-as-entry-signed-header">
<a href="#section-2.2.2.1" class="section-number selfRef">2.2.2.1. </a><a href="#name-as-entry-signed-header" class="section-name selfRef">AS Entry Signed Header</a>
            </h5>
<span id="name-as-entry-signed-header-2"></span><div id="_figure-10">
<figure id="figure-10">
              <div id="section-2.2.2.1-1.1">
                <div class="alignLeft art-svg artwork" id="section-2.2.2.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="512" viewBox="0 0 512 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                    <path d="M 48,192 L 48,224" fill="none" stroke="black"></path>
                    <path d="M 88,112 L 88,160" fill="none" stroke="black"></path>
                    <path d="M 128,192 L 128,224" fill="none" stroke="black"></path>
                    <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                    <path d="M 208,192 L 208,224" fill="none" stroke="black"></path>
                    <path d="M 248,112 L 248,160" fill="none" stroke="black"></path>
                    <path d="M 256,64 L 256,80" fill="none" stroke="black"></path>
                    <path d="M 312,192 L 312,224" fill="none" stroke="black"></path>
                    <path d="M 328,32 L 328,64" fill="none" stroke="black"></path>
                    <path d="M 328,112 L 328,144" fill="none" stroke="black"></path>
                    <path d="M 400,112 L 400,144" fill="none" stroke="black"></path>
                    <path d="M 432,192 L 432,224" fill="none" stroke="black"></path>
                    <path d="M 504,112 L 504,144" fill="none" stroke="black"></path>
                    <path d="M 184,32 L 328,32" fill="none" stroke="black"></path>
                    <path d="M 184,64 L 328,64" fill="none" stroke="black"></path>
                    <path d="M 24,96 L 240,96" fill="none" stroke="black"></path>
                    <path d="M 272,96 L 488,96" fill="none" stroke="black"></path>
                    <path d="M 8,112 L 504,112" fill="none" stroke="black"></path>
                    <path d="M 8,144 L 504,144" fill="none" stroke="black"></path>
                    <path d="M 64,176 L 72,176" fill="none" stroke="black"></path>
                    <path d="M 264,176 L 416,176" fill="none" stroke="black"></path>
                    <path d="M 48,192 L 432,192" fill="none" stroke="black"></path>
                    <path d="M 48,224 L 432,224" fill="none" stroke="black"></path>
                    <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                    <path d="M 240,96 C 248.83064,96 256,88.83064 256,80" fill="none" stroke="black"></path>
                    <path d="M 272,96 C 263.16936,96 256,88.83064 256,80" fill="none" stroke="black"></path>
                    <path d="M 488,96 C 496.83064,96 504,103.16936 504,112" fill="none" stroke="black"></path>
                    <path d="M 64,176 C 55.16936,176 48,183.16936 48,192" fill="none" stroke="black"></path>
                    <path d="M 72,176 C 80.83064,176 88,168.83064 88,160" fill="none" stroke="black"></path>
                    <path d="M 264,176 C 255.16936,176 248,168.83064 248,160" fill="none" stroke="black"></path>
                    <path d="M 416,176 C 424.83064,176 432,183.16936 432,192" fill="none" stroke="black"></path>
                    <g class="text">
                      <text x="252" y="52">Header</text>
                      <text x="28" y="132">Sig.</text>
                      <text x="68" y="132">Alg.</text>
                      <text x="140" y="132">Verification</text>
                      <text x="208" y="132">Key</text>
                      <text x="236" y="132">ID</text>
                      <text x="288" y="132">Timestamp</text>
                      <text x="364" y="132">Metadata</text>
                      <text x="452" y="132">AssocDataLen</text>
                      <text x="84" y="212">ISD-AS</text>
                      <text x="144" y="212">TRC</text>
                      <text x="180" y="212">Base</text>
                      <text x="232" y="212">TRC</text>
                      <text x="276" y="212">Serial</text>
                      <text x="344" y="212">Subject</text>
                      <text x="392" y="212">Key</text>
                      <text x="420" y="212">ID</text>
                    </g>
                  </svg><a href="#section-2.2.2.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-as-entry-signed-header-2" class="selfRef">AS Entry Signed Header</a>
              </figcaption></figure>
</div>
<p id="section-2.2.2.1-2">The header part carries information that is relevant to the computation and verification of the signature. It contains the following fields:<a href="#section-2.2.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.1-3.1">
                <p id="section-2.2.2.1-3.1.1"><code>signature_algorithm</code>: Specifies the algorithm to compute the signature. Possible types are defined by the <code>SignatureAlgorithm</code> definition and are further discussed in <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>, but an unspecified signature algorithm is never valid. Other signature algorithms or curves <span class="bcp14">MAY</span> be used in the future. This field is <span class="bcp14">REQUIRED</span>.<a href="#section-2.2.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-3.2">
                <p id="section-2.2.2.1-3.2.1"><code>verification_key_id</code>: Contains a <code>VerificationKeyID</code> message, carrying information relevant to signing and verifying PCBs and other control-plane messages. This field is <span class="bcp14">REQUIRED</span>.<a href="#section-2.2.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-3.3">
                <p id="section-2.2.2.1-3.3.1"><code>timestamp</code>: Defines the signature creation timestamp. This field is <span class="bcp14">OPTIONAL</span>.<a href="#section-2.2.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-3.4">
                <p id="section-2.2.2.1-3.4.1"><code>metadata</code>: May include metadata. While it is part of the generic <code>Header</code> message format, it <span class="bcp14">MUST</span> be empty in an AS entry signed header. This field is <span class="bcp14">OPTIONAL</span>.<a href="#section-2.2.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-3.5">
                <p id="section-2.2.2.1-3.5.1"><code>associated_data_length</code>: Specifies the length of the data covered by the signature but not included within the header or body. This data contains information about preceding AS entries, as described in <a href="#sign" class="auto internal xref">Section 2.2.2.6</a>. The value of this field is zero if no associated data is covered by the signature.<a href="#section-2.2.2.1-3.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.1-4">The <code>Header</code> and <code>SignatureAlgorithm</code> protobuf message formats are:<a href="#section-2.2.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.1-5">
<pre>
   message Header {
       SignatureAlgorithm signature_algorithm = 1;
       bytes verification_key_id = 2;
       google.protobuf.Timestamp timestamp = 3;
       bytes metadata = 4;
       int32 associated_data_length = 5;
   }

  enum SignatureAlgorithm {
    SIGNATURE_ALGORITHM_UNSPECIFIED = 0;
    SIGNATURE_ALGORITHM_ECDSA_WITH_SHA256 = 1;
    SIGNATURE_ALGORITHM_ECDSA_WITH_SHA384 = 2;
    SIGNATURE_ALGORITHM_ECDSA_WITH_SHA512 = 3;
  }
</pre><a href="#section-2.2.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2.1-6">The <code>VerificationKeyID</code> message contains the following <span class="bcp14">REQUIRED</span> fields:<a href="#section-2.2.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.1-7.1">
                <p id="section-2.2.2.1-7.1.1"><code>isd_as</code>: The ISD-AS number of the current AS.<a href="#section-2.2.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-7.2">
                <p id="section-2.2.2.1-7.2.1"><code>subject_key_id</code>: Refers to the certificate that contains the public key needed to verify this PCB's signature.<a href="#section-2.2.2.1-7.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-7.3">
                <p id="section-2.2.2.1-7.3.1"><code>trc_base</code>: Defines the <em>base</em> number of the latest Trust Root Configuration (TRC) available to the signer at the time of the signature creation.<a href="#section-2.2.2.1-7.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-7.4">
                <p id="section-2.2.2.1-7.4.1"><code>trc_serial</code>: Defines the <em>serial</em> number of the latest TRC available to the signer at the time of the signature creation.<a href="#section-2.2.2.1-7.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.1-8">Its protobuf message format is:<a href="#section-2.2.2.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.1-9">
<pre>
   message VerificationKeyID {
       uint64 isd_as = 1;
       bytes subject_key_id = 2;
       uint64 trc_base = 3;
       uint64 trc_serial = 4;
   }
</pre><a href="#section-2.2.2.1-9" class="pilcrow">¶</a>
</div>
<p id="section-2.2.2.1-10">For more information on signing and verifying control plane messages (such as PCBs), see 'Signing and Verifying Control Plane Messages' in <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>. For more information on the TRC base and serial number, see 'Trust Root Configuration Specification' in <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>.<a href="#section-2.2.2.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ase-sign">
<section id="section-2.2.2.2">
            <h5 id="name-as-entry-signed-body">
<a href="#section-2.2.2.2" class="section-number selfRef">2.2.2.2. </a><a href="#name-as-entry-signed-body" class="section-name selfRef">AS Entry Signed Body</a>
            </h5>
<span id="name-as-entry-signed-body-2"></span><div id="_figure-11">
<figure id="figure-11">
              <div id="section-2.2.2.2-1.1">
                <div class="alignLeft art-svg artwork" id="section-2.2.2.2-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="576" viewBox="0 0 576 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                    <path d="M 64,112 L 64,144" fill="none" stroke="black"></path>
                    <path d="M 136,32 L 136,64" fill="none" stroke="black"></path>
                    <path d="M 160,112 L 160,144" fill="none" stroke="black"></path>
                    <path d="M 240,112 L 240,144" fill="none" stroke="black"></path>
                    <path d="M 288,64 L 288,80" fill="none" stroke="black"></path>
                    <path d="M 352,112 L 352,144" fill="none" stroke="black"></path>
                    <path d="M 384,112 L 384,144" fill="none" stroke="black"></path>
                    <path d="M 448,32 L 448,64" fill="none" stroke="black"></path>
                    <path d="M 496,112 L 496,144" fill="none" stroke="black"></path>
                    <path d="M 528,112 L 528,144" fill="none" stroke="black"></path>
                    <path d="M 568,112 L 568,144" fill="none" stroke="black"></path>
                    <path d="M 136,32 L 448,32" fill="none" stroke="black"></path>
                    <path d="M 136,64 L 448,64" fill="none" stroke="black"></path>
                    <path d="M 24,96 L 272,96" fill="none" stroke="black"></path>
                    <path d="M 304,96 L 552,96" fill="none" stroke="black"></path>
                    <path d="M 8,112 L 568,112" fill="none" stroke="black"></path>
                    <path d="M 8,144 L 568,144" fill="none" stroke="black"></path>
                    <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                    <path d="M 272,96 C 280.83064,96 288,88.83064 288,80" fill="none" stroke="black"></path>
                    <path d="M 304,96 C 295.16936,96 288,88.83064 288,80" fill="none" stroke="black"></path>
                    <path d="M 552,96 C 560.83064,96 568,103.16936 568,112" fill="none" stroke="black"></path>
                    <g class="text">
                      <text x="292" y="52">Body</text>
                      <text x="36" y="132">ISD-AS</text>
                      <text x="84" y="132">Next</text>
                      <text x="132" y="132">ISD-AS</text>
                      <text x="176" y="132">Hop</text>
                      <text x="216" y="132">Entry</text>
                      <text x="260" y="132">Peer</text>
                      <text x="304" y="132">Entry</text>
                      <text x="336" y="132">0</text>
                      <text x="368" y="132">...</text>
                      <text x="404" y="132">Peer</text>
                      <text x="448" y="132">Entry</text>
                      <text x="480" y="132">N</text>
                      <text x="512" y="132">MTU</text>
                      <text x="548" y="132">Ext.</text>
                    </g>
                  </svg><a href="#section-2.2.2.2-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-as-entry-signed-body-2" class="selfRef">AS Entry Signed Body</a>
              </figcaption></figure>
</div>
<p id="section-2.2.2.2-2">The body of an AS entry <span class="bcp14">MUST</span> consist of the signed component <code>ASEntrySignedBody</code> of all the ASes in the path segment represented by the PCB, up until and including the current AS. Its Protobuf message format is:<a href="#section-2.2.2.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.2-3">
<pre>
   message ASEntrySignedBody {
       uint64 isd_as = 1;
       uint64 next_isd_as = 2;
       HopEntry hop_entry = 3;
       repeated PeerEntry peer_entries = 4;
       uint32 mtu = 5;
       PathSegmentExtensions extensions = 6;
   }
</pre><a href="#section-2.2.2.2-3" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.2.2-4.1">
                <p id="section-2.2.2.2-4.1.1"><code>isd_as</code>: The ISD-AS number of the AS that created this AS entry.<a href="#section-2.2.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.2-4.2">
                <p id="section-2.2.2.2-4.2.1"><code>next_isd_as</code>: The ISD-AS number of the downstream AS to which the PCB <span class="bcp14">MUST</span> be forwarded. The presence of this field prevents path hijacking attacks, as further discussed in <a href="#path-hijack" class="auto internal xref">Section 8.3.1</a>.<a href="#section-2.2.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.2-4.3">
                <p id="section-2.2.2.2-4.3.1"><code>hop_entry</code>: The hop entry (<code>HopEntry</code>) with the information required by the data plane to forward this PCB through the current AS to the next AS. For the specification of the hop entry, see <a href="#hopentry" class="auto internal xref">Section 2.2.2.3</a>.<a href="#section-2.2.2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.2-4.4">
                <p id="section-2.2.2.2-4.4.1"><code>peer_entries</code>: The list of optional peer entries (<code>PeerEntry</code>). For a specification of one peer entry, see <a href="#peerentry" class="auto internal xref">Section 2.2.2.4</a>.<a href="#section-2.2.2.2-4.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.2-4.5">
                <p id="section-2.2.2.2-4.5.1"><code>mtu</code>: The maximum transmission unit (MTU) in bytes that is supported by all intra-domain links within the current AS. This value is set by the Control Service when adding the AS entry to the beacon. How the Control Service obtains this information is implementation dependent, but current practice is to make it a configuration item.<a href="#section-2.2.2.2-4.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.2-4.6">
                <p id="section-2.2.2.2-4.6.1"><code>extensions</code>: List of signed extensions (optional). PCB extensions defined here are part of the signed AS entry. This field <span class="bcp14">SHOULD</span> therefore only contain extensions that include important metadata for which cryptographic protection is required. For more information on PCB extensions, see <a href="#pcb-ext" class="auto internal xref">Section 2.2.3</a>.<a href="#section-2.2.2.2-4.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="hopentry">
<section id="section-2.2.2.3">
            <h5 id="name-hop-entry">
<a href="#section-2.2.2.3" class="section-number selfRef">2.2.2.3. </a><a href="#name-hop-entry" class="section-name selfRef">Hop Entry</a>
            </h5>
<span id="name-hop-entry-2"></span><div id="_figure-12">
<figure id="figure-12">
              <div id="section-2.2.2.3-1.1">
                <div class="alignLeft art-svg artwork" id="section-2.2.2.3-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="240" viewBox="0 0 240 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                    <path d="M 72,32 L 72,64" fill="none" stroke="black"></path>
                    <path d="M 120,64 L 120,80" fill="none" stroke="black"></path>
                    <path d="M 120,112 L 120,144" fill="none" stroke="black"></path>
                    <path d="M 168,32 L 168,64" fill="none" stroke="black"></path>
                    <path d="M 232,112 L 232,144" fill="none" stroke="black"></path>
                    <path d="M 72,32 L 168,32" fill="none" stroke="black"></path>
                    <path d="M 72,64 L 168,64" fill="none" stroke="black"></path>
                    <path d="M 24,96 L 104,96" fill="none" stroke="black"></path>
                    <path d="M 136,96 L 216,96" fill="none" stroke="black"></path>
                    <path d="M 8,112 L 232,112" fill="none" stroke="black"></path>
                    <path d="M 8,144 L 232,144" fill="none" stroke="black"></path>
                    <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                    <path d="M 104,96 C 112.83064,96 120,88.83064 120,80" fill="none" stroke="black"></path>
                    <path d="M 136,96 C 127.16936,96 120,88.83064 120,80" fill="none" stroke="black"></path>
                    <path d="M 216,96 C 224.83064,96 232,103.16936 232,112" fill="none" stroke="black"></path>
                    <g class="text">
                      <text x="96" y="52">Hop</text>
                      <text x="136" y="52">Entry</text>
                      <text x="48" y="132">Ingress</text>
                      <text x="96" y="132">MTU</text>
                      <text x="152" y="132">Hop</text>
                      <text x="192" y="132">Field</text>
                    </g>
                  </svg><a href="#section-2.2.2.3-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-hop-entry-2" class="selfRef">Hop Entry</a>
              </figcaption></figure>
</div>
<p id="section-2.2.2.3-2">Each body of an AS entry <span class="bcp14">MUST</span> contain exactly one hop entry. It specifies forwarding information which the data plane requires to create the hop through the current AS (in the direction of the beaconing).<a href="#section-2.2.2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2.3-3">The <code>HopEntry</code> Protobuf message format is:<a href="#section-2.2.2.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.3-4">
<pre>
   message HopEntry {
       HopField hop_field = 1;
       uint32 ingress_mtu = 2;
   }
</pre><a href="#section-2.2.2.3-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.2.3-5.1">
                <p id="section-2.2.2.3-5.1.1"><code>hop_field</code>: Contains the authenticated information about the ingress and egress interfaces in the direction of beaconing. Routers need this information to forward packets through the current AS. For further specifications, see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>.<a href="#section-2.2.2.3-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-5.2">
                <p id="section-2.2.2.3-5.2.1"><code>ingress_mtu</code>: Specifies the maximum transmission unit (MTU) of the ingress interface (in beaconing direction) of the hop being described. The MTU of paths constructed from the containing beacon is necessarily less than or equal to this value. How the Control Service obtains the MTU of an inter-AS link is implementation dependent. It may be discovered or configured by operators, but current practice to make it a configuration item. Path MTU is further discussed in <a href="#path-mtu" class="auto internal xref">Section 3.4</a>.<a href="#section-2.2.2.3-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.3-6">In this description, MTU and packet size are to be understood in the same sense as in <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>. That is, exclusive of any layer 2 framing or packet encapsulation (for links using an underlay network).<a href="#section-2.2.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="peerentry">
<section id="section-2.2.2.4">
            <h5 id="name-peer-entry">
<a href="#section-2.2.2.4" class="section-number selfRef">2.2.2.4. </a><a href="#name-peer-entry" class="section-name selfRef">Peer Entry</a>
            </h5>
<span id="name-peer-entry-2"></span><div id="_figure-14">
<figure id="figure-13">
              <div id="section-2.2.2.4-1.1">
                <div class="alignLeft art-svg artwork" id="section-2.2.2.4-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="488" viewBox="0 0 488 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                    <path d="M 120,112 L 120,144" fill="none" stroke="black"></path>
                    <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                    <path d="M 224,112 L 224,144" fill="none" stroke="black"></path>
                    <path d="M 248,64 L 248,80" fill="none" stroke="black"></path>
                    <path d="M 304,32 L 304,64" fill="none" stroke="black"></path>
                    <path d="M 344,112 L 344,144" fill="none" stroke="black"></path>
                    <path d="M 480,112 L 480,144" fill="none" stroke="black"></path>
                    <path d="M 184,32 L 304,32" fill="none" stroke="black"></path>
                    <path d="M 184,64 L 304,64" fill="none" stroke="black"></path>
                    <path d="M 24,96 L 232,96" fill="none" stroke="black"></path>
                    <path d="M 264,96 L 464,96" fill="none" stroke="black"></path>
                    <path d="M 8,112 L 480,112" fill="none" stroke="black"></path>
                    <path d="M 8,144 L 480,144" fill="none" stroke="black"></path>
                    <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                    <path d="M 232,96 C 240.83064,96 248,88.83064 248,80" fill="none" stroke="black"></path>
                    <path d="M 264,96 C 255.16936,96 248,88.83064 248,80" fill="none" stroke="black"></path>
                    <path d="M 464,96 C 472.83064,96 480,103.16936 480,112" fill="none" stroke="black"></path>
                    <g class="text">
                      <text x="220" y="52">Peer</text>
                      <text x="264" y="52">Entry</text>
                      <text x="40" y="132">Hop</text>
                      <text x="80" y="132">Field</text>
                      <text x="156" y="132">Peer</text>
                      <text x="192" y="132">MTU</text>
                      <text x="252" y="132">Peer</text>
                      <text x="300" y="132">ISD-AS</text>
                      <text x="372" y="132">Peer</text>
                      <text x="432" y="132">Interface</text>
                    </g>
                  </svg><a href="#section-2.2.2.4-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-peer-entry-2" class="selfRef">Peer Entry</a>
              </figcaption></figure>
</div>
<p id="section-2.2.2.4-2">By means of a peer entry, an AS can announce that it has a peering link to another AS. A peer entry is an optional component of a PCB, and is only included if there is a peering link to a peer AS.<a href="#section-2.2.2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2.4-3">The <code>PeerEntry</code> Protobuf message format is:<a href="#section-2.2.2.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.4-4">
<pre>
   message PeerEntry {
       uint64 peer_isd_as = 1;
       uint64 peer_interface = 2;
       uint32 peer_mtu = 3;
       HopField hop_field = 4;
   }
</pre><a href="#section-2.2.2.4-4" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.2.4-5.1">
                <p id="section-2.2.2.4-5.1.1"><code>peer_isd_as</code>: The ISD-AS number of the peer AS. This number is used to match peering segments during path construction.<a href="#section-2.2.2.4-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.4-5.2">
                <p id="section-2.2.2.4-5.2.1"><code>peer_interface</code>: The 16-bit interface identifier of the peering link on the peer AS side. This identifier is used to match peering segments during path construction.<a href="#section-2.2.2.4-5.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.4-5.3">
                <p id="section-2.2.2.4-5.3.1"><code>peer_mtu</code>: Specifies the maximum transmission unit (MTU) of the peering link being described. The MTU of paths via such link is necessarily less than or equal to this value. How the Control Service obtains the MTU of an inter-AS link is implementation dependent. It may be discovered or configured, but current practice is to make it a configuration item.<a href="#section-2.2.2.4-5.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.4-5.4">
                <p id="section-2.2.2.4-5.4.1"><code>hop_field</code>: Contains authenticated information about the ingress and egress interfaces in the current AS (coming from the peering link, in the direction of beaconing - see also <a href="#_figure-6" class="auto internal xref">Figure 6</a>). The data plane needs this information to forward packets through the current AS. For further specifications, see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>.<a href="#section-2.2.2.4-5.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.4-6">In this description, MTU and packet size are to be understood in the same sense as in <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>. That is, exclusive of any layer 2 framing or packet encapsulation (for links using an underlay network).<a href="#section-2.2.2.4-6" class="pilcrow">¶</a></p>
<span id="name-peer-entry-information-in-t"></span><div id="_figure-15">
<figure id="figure-14">
              <div id="section-2.2.2.4-7.1">
                <div class="alignLeft art-svg artwork" id="section-2.2.2.4-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="432" width="432" viewBox="0 0 432 432" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,160 L 8,288" fill="none" stroke="black"></path>
                    <path d="M 32,32 L 32,96" fill="none" stroke="black"></path>
                    <path d="M 40,352 L 40,416" fill="none" stroke="black"></path>
                    <path d="M 80,96 L 80,280" fill="none" stroke="black"></path>
                    <path d="M 88,288 L 88,352" fill="none" stroke="black"></path>
                    <path d="M 96,208 L 96,280" fill="none" stroke="black"></path>
                    <path d="M 128,32 L 128,96" fill="none" stroke="black"></path>
                    <path d="M 136,352 L 136,416" fill="none" stroke="black"></path>
                    <path d="M 176,160 L 176,288" fill="none" stroke="black"></path>
                    <path d="M 328,176 L 328,240" fill="none" stroke="black"></path>
                    <path d="M 424,176 L 424,240" fill="none" stroke="black"></path>
                    <path d="M 32,32 L 128,32" fill="none" stroke="black"></path>
                    <path d="M 32,96 L 128,96" fill="none" stroke="black"></path>
                    <path d="M 8,160 L 176,160" fill="none" stroke="black"></path>
                    <path d="M 328,176 L 424,176" fill="none" stroke="black"></path>
                    <path d="M 96,208 L 176,208" fill="none" stroke="black"></path>
                    <path d="M 192,208 L 312,208" fill="none" stroke="black"></path>
                    <path d="M 328,240 L 424,240" fill="none" stroke="black"></path>
                    <path d="M 8,288 L 176,288" fill="none" stroke="black"></path>
                    <path d="M 40,352 L 136,352" fill="none" stroke="black"></path>
                    <path d="M 40,416 L 136,416" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="104,280 92,274.4 92,285.6" fill="black" transform="rotate(90,96,280)"></polygon>
                    <polygon class="arrowhead" points="88,280 76,274.4 76,285.6" fill="black" transform="rotate(90,80,280)"></polygon>
                    <circle cx="80" cy="144" r="6" class="opendot" fill="white" stroke="black"></circle>
                    <circle cx="88" cy="336" r="6" class="opendot" fill="white" stroke="black"></circle>
                    <g class="text">
                      <text x="68" y="68">Parent</text>
                      <text x="108" y="68">AS</text>
                      <text x="148" y="148">ASE.HF.ingress</text>
                      <text x="276" y="180">PE.peer_</text>
                      <text x="280" y="196">interface</text>
                      <text x="184" y="212">p</text>
                      <text x="320" y="212">p</text>
                      <text x="364" y="212">Peer</text>
                      <text x="396" y="212">AS</text>
                      <text x="240" y="228">PE.HF.ingress</text>
                      <text x="148" y="308">PE.HF.egress</text>
                      <text x="152" y="324">ASE.HF.egress</text>
                      <text x="72" y="388">Child</text>
                      <text x="108" y="388">AS</text>
                    </g>
                  </svg><a href="#section-2.2.2.4-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-peer-entry-information-in-t" class="selfRef">Peer entry information, in the direction of beaconing. PE denotes a peer entry, ASE an AS entry, HF an hop field.</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="hopfield">
<section id="section-2.2.2.5">
            <h5 id="name-hop-field">
<a href="#section-2.2.2.5" class="section-number selfRef">2.2.2.5. </a><a href="#name-hop-field" class="section-name selfRef">Hop Field</a>
            </h5>
<span id="name-hop-field-2"></span><div id="_figure-13">
<figure id="figure-15">
              <div id="section-2.2.2.5-1.1">
                <div class="alignLeft art-svg artwork" id="section-2.2.2.5-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="488" viewBox="0 0 488 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                    <path d="M 120,112 L 120,144" fill="none" stroke="black"></path>
                    <path d="M 184,32 L 184,64" fill="none" stroke="black"></path>
                    <path d="M 232,64 L 232,80" fill="none" stroke="black"></path>
                    <path d="M 232,112 L 232,144" fill="none" stroke="black"></path>
                    <path d="M 280,32 L 280,64" fill="none" stroke="black"></path>
                    <path d="M 392,112 L 392,144" fill="none" stroke="black"></path>
                    <path d="M 480,112 L 480,144" fill="none" stroke="black"></path>
                    <path d="M 184,32 L 280,32" fill="none" stroke="black"></path>
                    <path d="M 184,64 L 280,64" fill="none" stroke="black"></path>
                    <path d="M 24,96 L 216,96" fill="none" stroke="black"></path>
                    <path d="M 248,96 L 464,96" fill="none" stroke="black"></path>
                    <path d="M 8,112 L 480,112" fill="none" stroke="black"></path>
                    <path d="M 8,144 L 480,144" fill="none" stroke="black"></path>
                    <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                    <path d="M 216,96 C 224.83064,96 232,88.83064 232,80" fill="none" stroke="black"></path>
                    <path d="M 248,96 C 239.16936,96 232,88.83064 232,80" fill="none" stroke="black"></path>
                    <path d="M 464,96 C 472.83064,96 480,103.16936 480,112" fill="none" stroke="black"></path>
                    <g class="text">
                      <text x="208" y="52">Hop</text>
                      <text x="248" y="52">Entry</text>
                      <text x="64" y="132">Ingress</text>
                      <text x="180" y="132">Egress</text>
                      <text x="292" y="132">Expiration</text>
                      <text x="356" y="132">Time</text>
                      <text x="432" y="132">MAC</text>
                    </g>
                  </svg><a href="#section-2.2.2.5-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-hop-field-2" class="selfRef">Hop Field</a>
              </figcaption></figure>
</div>
<p id="section-2.2.2.5-2">The Hop Field, part of both hop and peer entries, is used directly in the data plane for packet forwarding and specifies the incoming and outgoing interfaces of the ASes on the forwarding path. This information is authenticated with a Message Authentication Code (MAC) which is used by the Control Service of an AS to authenticate path segments with its border routers during packet forwarding.<a href="#section-2.2.2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2.5-3">The algorithm used to compute the Hop Field MAC is an AS-specific choice, although the Control Services and border routers within an AS <span class="bcp14">MUST</span> use the same algorithm. Implementations <span class="bcp14">MUST</span> also support the Default Hop Field MAC algorithm. See <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "Authorizing Segments through Chained MACs" for more information including configuration. Endpoints do not compute MACs.<a href="#section-2.2.2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.2.2.5-4">The <code>HopField</code> Protobuf message format is:<a href="#section-2.2.2.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.5-5">
<pre>
   message HopField {
       uint64 ingress = 1;
       uint64 egress = 2;
       uint32 exp_time = 3;
       bytes mac = 4;
   }

</pre><a href="#section-2.2.2.5-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.2.2.5-6.1">
                <p id="section-2.2.2.5-6.1.1"><code>ingress</code>: The 16-bit ingress interface identifier (in the direction of the path construction. That is, in the direction of beaconing through the current AS).<a href="#section-2.2.2.5-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.5-7"><strong>Note:</strong> The core AS originating a PCB <span class="bcp14">MUST</span> set the ingress interface identifier to the "unspecified" value (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "Terminology").<a href="#section-2.2.2.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.5-8.1">
                <p id="section-2.2.2.5-8.1.1"><code>egress</code>: The 16-bit egress interface identifier (in the direction of beaconing).<a href="#section-2.2.2.5-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.5-8.2">
                <p id="section-2.2.2.5-8.2.1"><code>exp_time</code>: The 8-bit encoded expiration time of the Hop Field, indicating its validity. This field expresses a duration in seconds according to the formula: <code>duration = (1 + exp_time) * (24*60*60/256)</code> and the minimum duration is therefore 337.5 seconds. This duration is relative to the PCB creation timestamp set in the PCB's segment information component (see also <a href="#seginfo" class="auto internal xref">Section 2.2.1</a>), so the absolute expiration time of the Hop Field is the sum of these two values.<a href="#section-2.2.2.5-8.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.5-8.3">
                <p id="section-2.2.2.5-8.3.1"><code>mac</code>: The message authentication code (MAC) used in the data plane to verify the Hop Field, as described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-2.2.2.5-8.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="sign">
<section id="section-2.2.2.6">
            <h5 id="name-as-entry-signature">
<a href="#section-2.2.2.6" class="section-number selfRef">2.2.2.6. </a><a href="#name-as-entry-signature" class="section-name selfRef">AS Entry Signature</a>
            </h5>
<p id="section-2.2.2.6-1">Each AS entry <span class="bcp14">MUST</span> be signed with the AS certificate's private key K<sub>i</sub>. The certificate <span class="bcp14">MUST</span> have a validity period that is longer than the Hop Field absolute expiration time (described in <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>). The signature Sig<sub>i</sub> of an AS entry ASE<sub>i</sub> is computed over the AS entry's signed component.<a href="#section-2.2.2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2.6-2">This is the input for the computation of the signature:<a href="#section-2.2.2.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.6-3.1">
                <p id="section-2.2.2.6-3.1.1">The signed header and body of the current AS (<code>header_and_body</code>).<a href="#section-2.2.2.6-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.6-3.2">
                <p id="section-2.2.2.6-3.2.1">The <code>segment_info</code> component of the current AS. This is the encoded version of the <code>SegmentInformation</code> component containing basic information about the path segment represented by the PCB. For the specification of <code>SegmentInformation</code>, see <a href="#seginfo" class="auto internal xref">Section 2.2.1</a>.<a href="#section-2.2.2.6-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.6-3.3">
                <p id="section-2.2.2.6-3.3.1">The signed <code>header_and_body</code>/<code>signature</code> combination of each previous AS on this specific path segment.<a href="#section-2.2.2.6-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.6-4">The signature Sig<sub>i</sub> of an AS entry ASE<sub>i</sub> is now computed as follows. Symbol <code>||</code> represents concatenation.<a href="#section-2.2.2.6-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2.6-5">Sig<sub>i</sub> =
K<sub>i</sub>( ASE<sub>i</sub><sup>(signed)</sup> || SegInfo || ASE<sub>0</sub><sup>(signed)</sup> || Sig<sub>0</sub> || ... || ASE<sub>i-1</sub><sup>(signed)</sup> || Sig<sub>i-1</sub> )<a href="#section-2.2.2.6-5" class="pilcrow">¶</a></p>
<p id="section-2.2.2.6-6">The signature metadata minimally contains the ISD-AS number of the signing entity and the key identifier of the public key that other ASes can use to verify the message. For more information on signing and verifying control plane messages, see 'Signing and Verifying Control Plane Messages' in <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>.<a href="#section-2.2.2.6-6" class="pilcrow">¶</a></p>
<p id="section-2.2.2.6-7">Some of the data used as an input to the signature comes from previous ASes in the path segment. This data is therefore called "associated data" and it gives the signature a nested structure. The content of associated data defined in Protobuf is:<a href="#section-2.2.2.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2.6-8">
<pre>
input(ps, i) = signed.header_and_body || associated_data(ps, i)

associated_data(ps, i) = ps.segment_info ||
                         ps.as_entries[1].signed.header_and_body ||
                         ps.as_entries[1].signed.signature ||
                         ...
                         ps.as_entries[i-1].signed.header_and_body ||
                         ps.as_entries[i-1].signed.signature
</pre><a href="#section-2.2.2.6-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="pcb-ext">
<section id="section-2.2.3">
          <h4 id="name-pcb-extensions">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-pcb-extensions" class="section-name selfRef">PCB Extensions</a>
          </h4>
<p id="section-2.2.3-1">AS entries in PCBs may carry a number of optional extensions that accumulate information while traveling across ASes. Extensions can be:<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3-2.1">
              <p id="section-2.2.3-2.1.1">Unsigned extensions <code>PathSegmentUnsignedExtensions</code>. They are part of the AS entry component (the <code>ASEntry</code> message, see also <a href="#as-entry" class="auto internal xref">Section 2.2.2</a>).<a href="#section-2.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-2.2">
              <p id="section-2.2.3-2.2.1">Signed extensions <code>PathSegmentExtensions</code>. They are part of the signed body component of an AS entry (the <code>ASEntrySignedBody</code> message, see also <a href="#ase-sign" class="auto internal xref">Section 2.2.2.2</a>).<a href="#section-2.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.3-3">The Protobuf message format of extensions is below. As an example, it mentions the <code>StaticInfoExtension</code>, a signed extension that is used to carry path segment metadata, such as segment latency, bandwidth, router coordinates, link type, number of internal hops. This and other extensions are at time of writing experimental, so definitions of this message format are omitted and <span>[<a href="#PCBExtensions" class="cite xref">PCBExtensions</a>]</span> should be referred to.<a href="#section-2.2.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.3-4">
<pre>
message PathSegmentUnsignedExtensions {
    }

message PathSegmentExtensions {
    StaticInfoExtension static_info = 1;
  }
</pre><a href="#section-2.2.3-4" class="pilcrow">¶</a>
</div>
<p id="section-2.2.3-5">If a Control Service receives an unknown PCB extension, it <span class="bcp14">SHOULD</span> skip the extension, but preserve it unmodified in case the PCB is further propagated.<a href="#section-2.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pcb-validity">
<section id="section-2.2.4">
          <h4 id="name-pcb-validity">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-pcb-validity" class="section-name selfRef">PCB Validity</a>
          </h4>
<p id="section-2.2.4-1">To be valid (that is, usable to construct a valid path), a PCB <span class="bcp14">MUST</span>:<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.4-2.1">
              <p id="section-2.2.4-2.1.1">Contain valid AS Entry signatures (<a href="#sign" class="auto internal xref">Section 2.2.2.6</a>).<a href="#section-2.2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.4-2.2">
              <p id="section-2.2.4-2.2.1">Have a timestamp (<a href="#seginfo" class="auto internal xref">Section 2.2.1</a>) that is not later than the current time at the point of validation, plus an allowance for differences between the clocks of the validator and originator.<a href="#section-2.2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.4-2.3">
              <p id="section-2.2.4-2.3.1">Contain only unexpired hop fields (<a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>).<a href="#section-2.2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.4-3">It is recommend to use the hopfield expiration time (that is 337.5 seconds, see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>) as the allowance for differences between the clocks of the validator and originator.<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.2.4-4">For the purpose of validation, a hop is considered expired if its absolute expiration time (as defined in <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>), is later than the current time + allowance at the point of validation.<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuration">
<section id="section-2.2.5">
          <h4 id="name-configuration">
<a href="#section-2.2.5" class="section-number selfRef">2.2.5. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
          </h4>
<p id="section-2.2.5-1">For the purpose of constructing and propagating path segments, a network operator needs to configure an AS Control Service with links to neighboring ASes. Such information may be conveyed to the Control Service in an out-of-band fashion (e.g., in a configuration file). For each link, these values <span class="bcp14">MUST</span> be configured:<a href="#section-2.2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.5-2.1">
              <p id="section-2.2.5-2.1.1">Local Interface ID. This <span class="bcp14">MUST</span> be unique within each AS.<a href="#section-2.2.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-2.2">
              <p id="section-2.2.5-2.2.1">Neighbor type (core, parent, child, peer), depending on link type (see <a href="#paths-links" class="auto internal xref">Section 1.3</a>). Link type depends on mutual agreements between operators of the ASes at each end of each link.<a href="#section-2.2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-2.3">
              <p id="section-2.2.5-2.3.1">Neighbor ISD-AS number.<a href="#section-2.2.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-2.4">
              <p id="section-2.2.5-2.4.1">Neighbor interface underlay address.<a href="#section-2.2.5-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-2.5">
              <p id="section-2.2.5-2.5.1">For peering links, neighbor Interface ID.<a href="#section-2.2.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.5-3">In addition, a network operator needs to configure an AS Control Service with:<a href="#section-2.2.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.5-4.1">
              <p id="section-2.2.5-4.1.1">the algorithm and forwarding key used to compute the Hop Field MAC, which are also used by routers within the AS. These are further described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-2.2.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-4.2">
              <p id="section-2.2.5-4.2.1">registration interval (see <a href="#intra-reg" class="auto internal xref">Section 3.1</a>).<a href="#section-2.2.5-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-4.3">
              <p id="section-2.2.5-4.3.1">propagation interval and best PCBs set size (see <a href="#propagation-interval-size" class="auto internal xref">Section 2.3.4</a>).<a href="#section-2.2.5-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-4.4">
              <p id="section-2.2.5-4.4.1">the maximum MTU supported by all intra-AS links may also be configured by the operator.<a href="#section-2.2.5-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.5-4.5">
              <p id="section-2.2.5-4.5.1">Hop Field expiration time (see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>). Current implementations default to 63, corresponding to 6 hours.<a href="#section-2.2.5-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.5-5">Optionally, it may configure per-link MTU (see <a href="#hopentry" class="auto internal xref">Section 2.2.2.3</a>) and PCB selection policies (see <a href="#selection" class="auto internal xref">Section 2.3.3</a>).<a href="#section-2.2.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="path-prop">
<section id="section-2.3">
        <h3 id="name-propagation-of-pcbs">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-propagation-of-pcbs" class="section-name selfRef">Propagation of PCBs</a>
        </h3>
<p id="section-2.3-1">This section describes how PCBs are received, selected and further propagated in the path exploration process.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="reception">
<section id="section-2.3.1">
          <h4 id="name-reception-of-pcbs">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-reception-of-pcbs" class="section-name selfRef">Reception of PCBs</a>
          </h4>
<p id="section-2.3.1-1">Upon receiving a PCB, the Control Service of an AS performs the following checks:<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.1-2">
<li id="section-2.3.1-2.1">
              <p id="section-2.3.1-2.1.1">PCB validity: The Control Service <span class="bcp14">MUST</span> check the validity of the PCB (see <a href="#pcb-validity" class="auto internal xref">Section 2.2.4</a>) and it <span class="bcp14">MUST</span> discard invalid PCBs. The PCB contains the version numbers of the TRC(s) and certificate(s) that <span class="bcp14">MUST</span> be used to verify its signatures which enables the Control Service to check whether it has the relevant TRC(s) and certificate(s). If not, they can be requested from the Control Service of the sending AS through the API described in <a href="#crypto-api" class="auto internal xref">Section 2.4</a>.<a href="#section-2.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-2.2">
              <p id="section-2.3.1-2.2.1">Loop avoidance: The Control Service <span class="bcp14">MUST</span> check whether the PCB is from a core AS and whether it includes duplicate hop entries created by the core AS itself or by other ASes. If so, it <span class="bcp14">MUST</span> discard the PCB in order to avoid loops. This is necessary because core beaconing is based on propagating PCBs to all AS neighbors. Additionally, core ASes <span class="bcp14">SHOULD</span> discard PCBs that were propagated at any point by a non-core AS. Ultimately, core ASes <span class="bcp14">MAY</span> make a policy decision to propagate beacons containing path segments that traverse the same ISD more than once as this can be legitimate - e.g., if the ISD spans a large geographical area, a path between different ASes transiting another ISD may constitute a shortcut.<a href="#section-2.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-2.3">
              <p id="section-2.3.1-2.3.1">Incoming Interface: The Control Service <span class="bcp14">MUST</span> check that the last ISD-AS entry in a received PCB (in its AS Entry Signed Body) corresponds with the ISD-AS neighbor of the interface where the PCB was received. In addition, the corresponding link <span class="bcp14">MUST</span> be core or parent, otherwise the PCB <span class="bcp14">MUST</span> be discarded.<a href="#section-2.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-2.4">
              <p id="section-2.3.1-2.4.1">Continuity: When the Control Service receives a PCB containing two or more AS entries, it <span class="bcp14">MUST</span> check every AS entry except the last and discard beacons where the <code>next_isd_as</code> of an entry does not equal the <code>isd_as</code> of the next entry.<a href="#section-2.3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.3.1-3">If the PCB verification is successful, the Control Service decides whether to store the PCB as a candidate for propagation based on selection criteria and polices specific for each AS.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="storing">
<section id="section-2.3.2">
          <h4 id="name-storing-candidate-pcbs">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-storing-candidate-pcbs" class="section-name selfRef">Storing Candidate PCBs</a>
          </h4>
<p id="section-2.3.2-1">An AS Control Service stores candidate PCBs in a temporary storage called the <em>Beacon Store</em>. The management of this storage is implementation specific, but current practice is to retain all PCBs until expired or replaced by one describing the same path with a later origination time.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selection">
<section id="section-2.3.3">
          <h4 id="name-pcb-selection-policies">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-pcb-selection-policies" class="section-name selfRef">PCB Selection Policies</a>
          </h4>
<p id="section-2.3.3-1">The Control Service of an AS <span class="bcp14">MUST</span> select which PCBs to propagate further. The selection process can inspect and compare the properties of the candidate PCBs (e.g., length, disjointness across different paths, age, expiration time) and/or take into account which PCBs have been propagated in the past. The PCBs to select or eliminate is determined by the policy of the AS.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-2">In order to avoid excessive overhead on the path discovery system in bigger networks, an AS Control Service should only propagate those candidate PCBs with the highest probability of meeting the needs of the endpoints that will perform path construction, in accordance with <a href="#propagation-interval-size" class="auto internal xref">Section 2.3.4</a>.<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3.3-3">As SCION does not provide any in-band signal about the intentions of endpoints nor about the policies of downstream ASes, the policy will typically select a somewhat diverse set optimized for multiple, generic parameters. Selection may be based on criteria such as:<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.3-4.1">
              <p id="section-2.3.3-4.1.1">AS path length: from the originator core AS to the child (non-core) AS.<a href="#section-2.3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.2">
              <p id="section-2.3.3-4.2.1">Expiration time: the maximum value for the expiration time when extending the segment.<a href="#section-2.3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.3">
              <p id="section-2.3.3-4.3.1">ISD or AS exclusion lists: certain ASes or ISD that may not appear in a segment.<a href="#section-2.3.3-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.4">
              <p id="section-2.3.3-4.4.1">ISD loops: if permitted, they allow core AS to reach other core ASes in the same ISD via a third party ISDs.<a href="#section-2.3.3-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.5">
              <p id="section-2.3.3-4.5.1">Availability of peering links: that is the number of different peering ASes from all non-core ASes on the PCB or path segment. A greater number of peering ASes increases the likelihood of finding a shortcut on the path segment.<a href="#section-2.3.3-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.3-4.6">
              <p id="section-2.3.3-4.6.1">Path disjointness: Paths can be either AS disjointed or link disjointed. AS disjointed paths have no common upstream/core AS for the current AS, whereas link disjointed paths do not share any AS-to-AS link. AS disjointness allows path diversity in the event that an AS becomes unresponsive, and link disjointness provides resilience in case of link failure. Both criteria can be used depending on the objective of the AS.<a href="#section-2.3.3-4.6.1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-4.6.2">
The relative disjointness of two PCBs A and B may be calculated by assigning a disjointness score, calculated as the number of links in A that don't appear in B. For example, the beacon that has the highest disjointness score and is not the shortest path should be selected, but if this not better than what has already been selected, then the beacon with the shortest path yet to be selected should be chosen instead.<a href="#section-2.3.3-4.6.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.3-5">A PCB Selection Policy can be expressed as a stateful filter of segments, i.e., a function which indicates whether to accept or deny a given segment. This filter is stateful in that it can be updated each time its AS registers a new segment.
It is expected that an AS's policy will select PCBs corresponding to paths that are commercially or otherwise operationally viable.<a href="#section-2.3.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3.3-6">To ensure reachability, PCB selection policies should forward as many PCBs as possible as PCB selection is not intended as a mechanism for traffic engineering (e.g., by excluding specific PCBs for that purpose).<a href="#section-2.3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="propagation-interval-size">
<section id="section-2.3.4">
          <h4 id="name-propagation-interval-and-be">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-propagation-interval-and-be" class="section-name selfRef">Propagation Interval and Best PCBs Set Size</a>
          </h4>
<p id="section-2.3.4-1">PCBs are propagated in batches to each neighboring AS at a fixed frequency known as the <em>propagation interval</em> which happens for both intra-ISD beaconing (<a href="#intra-isd-beaconing" class="auto internal xref">Section 7.4.1</a>) and core beaconing (<a href="#core-beaconing" class="auto internal xref">Section 7.4.2</a>). At each propagation event, the AS Control Service selects a set of the best PCBs from the candidates in the Beacon Store according to the AS's selection policy.<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4-2">The size of this set is called the <em>best PCBs set size</em>. It should be:<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-3.1">
              <p id="section-2.3.4-3.1.1">For intra-ISD beaconing (i.e., propagating to children ASes): at most 50.<a href="#section-2.3.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-3.2">
              <p id="section-2.3.4-3.2.1">For core beaconing (i.e., propagation between core ASes): at most 5 per immediate neighbor core AS. Current practice is for the set to contain an equal amount of PCBs from each neighbor.<a href="#section-2.3.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-4">These values reflect a tradeoff between scalability — limited by the computational overhead of signature verification — and the number of paths discovered. The PCBs set size should not be too low to ensure that beaconing can discover a significant number of paths. Further discussion on these trade-offs is provided in <a href="#scalability" class="auto internal xref">Section 7.4</a>.<a href="#section-2.3.4-4" class="pilcrow">¶</a></p>
<p id="section-2.3.4-5">In current practice the intra-ISD set size is typically 20. Current practice also showed that in small SCION core networks, higher values of the core best PCBs set size (e.g., 20) can be used.<a href="#section-2.3.4-5" class="pilcrow">¶</a></p>
<p id="section-2.3.4-6">Depending on the selection criteria, it may be necessary to keep more candidate PCBs than the <em>best PCBs set size</em> in the Beacon Store in order to determine the best set of PCBs. If this is the case, an AS Control Service should have a suitable pre-selection of candidate PCBs in place in order to keep the Beacon Store capacity limited.<a href="#section-2.3.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-7.1">
              <p id="section-2.3.4-7.1.1">The <em>propagation interval</em> should be at least 5 seconds for intra-ISD beaconing and at least 60 seconds for core beaconing.<a href="#section-2.3.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-8">Note that to quickly (re-)establish connectivity, an AS Control Service <span class="bcp14">MAY</span> attempt to forward a PCB more frequently ("fast recovery"). Current practice is to increase the frequency of attempts if no PCB propagation is known to have succeeded within the last propagation interval:<a href="#section-2.3.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-9.1">
              <p id="section-2.3.4-9.1.1">because the corresponding RPC failed;<a href="#section-2.3.4-9.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-9.2">
              <p id="section-2.3.4-9.2.1">or because no beacon was available to propagate.<a href="#section-2.3.4-9.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="path-segment-prop">
<section id="section-2.3.5">
          <h4 id="name-propagation-of-selected-pcb">
<a href="#section-2.3.5" class="section-number selfRef">2.3.5. </a><a href="#name-propagation-of-selected-pcb" class="section-name selfRef">Propagation of Selected PCBs</a>
          </h4>
<p id="section-2.3.5-1">The propagation process includes the following steps:<a href="#section-2.3.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.5-2">
<li id="section-2.3.5-2.1">
              <p id="section-2.3.5-2.1.1">From the candidate PCBs stored in the Beacon Store, the Control Service of an AS selects the best PCBs to propagate to its neighboring ASes, according to the AS selection policy (see <a href="#selection" class="auto internal xref">Section 2.3.3</a>). Core ASes propagate PCBs over both core and parent-child links; additionally, they originate new PCBs over these same links. Non-core ASes propagate PCBs exclusively over parent-child links.<a href="#section-2.3.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.5-2.2">
              <p id="section-2.3.5-2.2.1">The Control Service <span class="bcp14">MUST</span> add a new AS entry (see <a href="#as-entry" class="auto internal xref">Section 2.2.2</a>) including any Peer Entry information (see <a href="#peerentry" class="auto internal xref">Section 2.2.2.4</a>) the AS is configured to advertise to every selected PCB.<a href="#section-2.3.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.5-2.3">
              <p id="section-2.3.5-2.3.1">The Control Service <span class="bcp14">MUST</span> sign each selected, extended PCB and append the computed signature.<a href="#section-2.3.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.5-2.4">
              <p id="section-2.3.5-2.4.1">As a final step, the Control Service propagates each extended PCB to the neighboring AS specified in the new AS entry by invoking the <code>SegmentCreationService.Beacon</code> remote procedure call (RPC) in the Control Services of the neighboring ASes (see also <a href="#prop-proto" class="auto internal xref">Section 2.3.5.1</a>).<a href="#section-2.3.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.3.5-3">To bootstrap initial communication with a neighboring beacon service, ASes use one-hop paths. This special kind of path handles beaconing between neighboring ASes for which no forwarding path may be available yet. It is the task of beaconing to discover such forwarding paths and the purpose of one-hop paths is to break this circular dependency. The One-Hop Path Type is described in more detail in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-2.3.5-3" class="pilcrow">¶</a></p>
<div id="prop-proto">
<section id="section-2.3.5.1">
            <h5 id="name-propagation-of-pcbs-in-prot">
<a href="#section-2.3.5.1" class="section-number selfRef">2.3.5.1. </a><a href="#name-propagation-of-pcbs-in-prot" class="section-name selfRef">Propagation of PCBs in Protobuf Message Format</a>
            </h5>
<p id="section-2.3.5.1-1">The last step of the above described core and intra-ISD propagation procedures is implemented as follows in Protobuf message format:<a href="#section-2.3.5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.5.1-2">
<pre>
   service SegmentCreationService {
       rpc Beacon(BeaconRequest) returns (BeaconResponse) {}
   }

   message BeaconRequest {
       PathSegment segment = 1;
   }

   message BeaconResponse {}
</pre><a href="#section-2.3.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.5.1-3">The propagation procedure includes the following elements:<a href="#section-2.3.5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.1-4.1">
                <p id="section-2.3.5.1-4.1.1"><code>SegmentCreationService</code>: Specifies the service via which the extended PCB is propagated to the Control Service of the neighboring AS.<a href="#section-2.3.5.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.1-4.1.2.1">
                    <p id="section-2.3.5.1-4.1.2.1.1"><code>Beacon</code>: Specifies the method that calls the Control Service at the neighboring AS in order to propagate the extended PCB.<a href="#section-2.3.5.1-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.3.5.1-4.2">
                <p id="section-2.3.5.1-4.2.1"><code>BeaconRequest</code>: Specifies the request message sent by the <code>Beacon</code> method to the Control Service of the neighboring AS. It contains the following element:<a href="#section-2.3.5.1-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.5.1-4.2.2.1">
                    <p id="section-2.3.5.1-4.2.2.1.1"><code>PathSegment</code>: Specifies the path segment to propagate to the neighboring AS. For more information on the Protobuf message type <code>PathSegment</code>, see <a href="#pcbs" class="auto internal xref">Section 2.2</a>.<a href="#section-2.3.5.1-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.3.5.1-4.3">
                <p id="section-2.3.5.1-4.3.1"><code>BeaconResponse</code>: An empty message returned as an acknowledgement upon success.<a href="#section-2.3.5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="crypto-api">
<section id="section-2.4">
        <h3 id="name-distribution-of-cryptograph">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-distribution-of-cryptograph" class="section-name selfRef">Distribution of Cryptographic Material</a>
        </h3>
<p id="section-2.4-1">Control Services distribute cryptographic material for the PKI (see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>) using the following protobuf messages through the <code>TrustMaterialService</code> RPCs:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-2">
<pre>
service TrustMaterialService {
    rpc Chains(ChainsRequest) returns (ChainsResponse) {}
    rpc TRC(TRCRequest) returns (TRCResponse) {}
}
</pre><a href="#section-2.4-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.4-3.1">
            <p id="section-2.4-3.1.1"><code>Chains(ChainsRequest)</code>: Returns the certificate chains that match the request.<a href="#section-2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-3.2">
            <p id="section-2.4-3.2.1"><code>TRC(TRCRequest)</code>: Returns a specific TRC that matches the request.<a href="#section-2.4-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.4-4">The corresponding protobuf message formats are:<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-5">
<pre>
message ChainsRequest {
    uint64 isd_as = 1;
    bytes subject_key_id = 2;
    google.protobuf.Timestamp at_least_valid_until = 3;
    google.protobuf.Timestamp at_least_valid_since = 4;
}

message ChainsResponse {
    repeated Chain chains = 1;
}

message Chain {
    bytes as_cert = 1;
    bytes ca_cert = 2;
}
</pre><a href="#section-2.4-5" class="pilcrow">¶</a>
</div>
<p id="section-2.4-6">A <code>ChainsRequest</code> message includes the following fields:<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-7.1">
            <p id="section-2.4-7.1.1"><code>isd_as</code>: Returns ISD-AS of Subject in the AS certificate.<a href="#section-2.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-7.2">
            <p id="section-2.4-7.2.1"><code>subject_key_id</code>: Returns SubjectKeyID in the AS certificate.<a href="#section-2.4-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-7.3">
            <p id="section-2.4-7.3.1"><code>at_least_valid_until</code>: Point in time at which the AS certificate must still be valid - in seconds since Epoch according to <span>[<a href="#POSIX.1-2024" class="cite xref">POSIX.1-2024</a>]</span> Section 4.19, encoded as a 32-bit unsigned integer.<a href="#section-2.4-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-7.4">
            <p id="section-2.4-7.4.1"><code>at_least_valid_since</code>: Point in time at which the AS certificate must be or must have been valid - in seconds since Epoch according to <span>[<a href="#POSIX.1-2024" class="cite xref">POSIX.1-2024</a>]</span> Section 4.19, encoded as a 32-bit unsigned integer.<a href="#section-2.4-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.4-8">A <code>ChainsResponse</code> includes the following fields:<a href="#section-2.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-9.1">
            <p id="section-2.4-9.1.1"><code>chains</code>: Lists the certificate chains that match the request. A <code>Chain</code> contains:<a href="#section-2.4-9.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-9.1.2.1">
                <p id="section-2.4-9.1.2.1.1"><code>as_cert</code>: Returns the AS certificate in the chain.<a href="#section-2.4-9.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.4-9.1.2.2">
                <p id="section-2.4-9.1.2.2.1"><code>ca_cert</code>: Returns the CA certificate in the chain.<a href="#section-2.4-9.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-2.4-10">For requesting TRCs, the protobuf messages are:<a href="#section-2.4-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-11">
<pre>
message TRCRequest {
    uint32 isd = 1;
    uint64 base = 2;
    uint64 serial = 3;
}

message TRCResponse {
    bytes trc = 1;
}
</pre><a href="#section-2.4-11" class="pilcrow">¶</a>
</div>
<p id="section-2.4-12">A <code>TRCRequest</code> includes the following fields:<a href="#section-2.4-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-13.1">
            <p id="section-2.4-13.1.1"><code>isd</code>: Returns the ISD number of the TRC.<a href="#section-2.4-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-13.2">
            <p id="section-2.4-13.2.1"><code>base</code>: Returns the base number of the TRC.<a href="#section-2.4-13.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-13.3">
            <p id="section-2.4-13.3.1"><code>serial</code>: Returns the serial number of the TRC.<a href="#section-2.4-13.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.4-14">The returned <code>trc</code> contains the raw TRC.<a href="#section-2.4-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="crypto-renewal">
<section id="section-2.5">
        <h3 id="name-renewal-of-cryptographic-ma">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-renewal-of-cryptographic-ma" class="section-name selfRef">Renewal of Cryptographic Material</a>
        </h3>
<p id="section-2.5-1">To renew PKI cryptographic material (see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>), Control Services <span class="bcp14">MAY</span> employ out-of-band mechanisms or utilize the <code>ChainRenewalService</code> RPC to exchange the Protobuf messages defined below.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.5-2">
<pre>
service ChainRenewalService {
    rpc ChainRenewal(ChainRenewalRequest) returns (
      ChainRenewalResponse) {}
}
</pre><a href="#section-2.5-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.5-3.1">
            <p id="section-2.5-3.1.1"><code>ChainRenewal(ChainRenewalRequest)</code>: returns a renewed certificate chain.<a href="#section-2.5-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.5-4">The corresponding protobuf message format for requests is:<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.5-5">
<pre>
message ChainRenewalRequest {
    reserved 1;
    bytes cms_signed_request = 2;
}
</pre><a href="#section-2.5-5" class="pilcrow">¶</a>
</div>
<p id="section-2.5-6">A <code>ChainRenewalRequest</code> message includes the following fields:<a href="#section-2.5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-7.1">
            <p id="section-2.5-7.1.1">Field number 1 is legacy and it is not in use.<a href="#section-2.5-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.5-7.2">
            <p id="section-2.5-7.2.1"><code>cms_signed_request</code>: it contains the ASN.1 DER encoded CMS SignedData structure that contains an ASN.1 DER encoded PKCS #10 request.<a href="#section-2.5-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.5-8">The  protobuf message format for responses is:<a href="#section-2.5-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.5-9">
<pre>
message ChainRenewalResponse {
    reserved 1;
    bytes cms_signed_response = 2;
}
</pre><a href="#section-2.5-9" class="pilcrow">¶</a>
</div>
<p id="section-2.5-10">A <code>ChainRenewalResponse</code> message includes the following fields:<a href="#section-2.5-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-11.1">
            <p id="section-2.5-11.1.1">Field number 1 is legacy and it is not in use.<a href="#section-2.5-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.5-11.2">
            <p id="section-2.5-11.2.1"><code>cms_signed_response</code>: it contains an ASN.1 DER encoded CMS SignedData structure containing a two-certificate chain. The chain comprises the AS certificate followed by the CA certificate, both encoded in ASN.1 DER.<a href="#section-2.5-11.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="path-segment-reg">
<section id="section-3">
      <h2 id="name-registration-of-path-segmen">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-registration-of-path-segmen" class="section-name selfRef">Registration of Path Segments</a>
      </h2>
<p id="section-3-1"><strong>Path registration</strong> is the process where a SCION AS transforms selected PCBs into path segments, and adding these segments to the relevant path databases thereby making them available to other ASes.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">A non-core AS typically receives several PCBs representing several path segments to the core ASes of the ISD the AS belongs to. Out of these PCBs, the non-core AS selects those down path segments through which it wants to be reached, based on AS-specific selection criteria.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The next step is to register the selected down segments with the Control Service of the relevant core ASes in accordance with a process called <em>intra-ISD path segment registration</em>. In addition, each core AS Control Service also stores the preferred core path segments to other core ASes during the <em>core segment registration</em> process.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Both processes are described below.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="intra-reg">
<section id="section-3.1">
        <h3 id="name-intra-isd-path-segment-regi">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-intra-isd-path-segment-regi" class="section-name selfRef">Intra-ISD Path Segment Registration</a>
        </h3>
<p id="section-3.1-1">Every <em>registration interval</em> (configured by each AS) the AS's Control Service selects two sets of PCBs to transform into two types of path segments:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">Up segments, which allow the infrastructure entities and endpoints in this AS to communicate with core ASes; and<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">Down segments, which allow remote entities to reach this AS.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-3">The up segments and down segments do not have to be equal as an AS may want to communicate with core ASes via one or more up segments that differ from the down segment(s) through which it wants to be reached. Therefore, an AS operator can define different selection policies for the up segment and down segment sets. In addition, the processes of transforming a PCB in an up segment or a down segment differ slightly.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div id="term-pcb">
<section id="section-3.1.1">
          <h4 id="name-terminating-a-pcb">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-terminating-a-pcb" class="section-name selfRef">Terminating a PCB</a>
          </h4>
<p id="section-3.1.1-1">Both the up segments and down segments end at the AS, so by transforming a PCB into a path segment, an AS Control Service "terminates" the PCB for this AS ingress interface and at that moment in time.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">The Control Service of a non-core performs the following steps to "terminate" a PCB:<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.1-3">
<li id="section-3.1.1-3.1">
              <p id="section-3.1.1-3.1.1">The Control Service adds a new AS entry to the PCB which <span class="bcp14">MUST</span> be defined as follows:<a href="#section-3.1.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-3.1.2.1">
                  <p id="section-3.1.1-3.1.2.1.1">The next AS <span class="bcp14">MUST NOT</span> be specified.<a href="#section-3.1.1-3.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-3.1.2.1.2.1">
                      <p id="section-3.1.1-3.1.2.1.2.1.1">In Protobuf message format, this means that the value of the <code>next_isd_as</code> field in the <code>ASEntrySignedBody</code> component <span class="bcp14">MUST</span> be "0".<a href="#section-3.1.1-3.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-3.1.1-3.1.2.2">
                  <p id="section-3.1.1-3.1.2.2.1">The egress interface in the Hop Field component <span class="bcp14">MUST NOT</span> be specified.<a href="#section-3.1.1-3.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-3.1.2.2.2.1">
                      <p id="section-3.1.1-3.1.2.2.2.1.1">In Protobuf message format, this means that the value of the <code>egress</code> field in the <code>HopField</code> component <span class="bcp14">MUST</span> be "0".<a href="#section-3.1.1-3.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-3.1.1-3.2">
              <p id="section-3.1.1-3.2.1">If the AS has peering links, the Control Service <span class="bcp14">MAY</span> add corresponding peer entry components to the signed body of the AS entry - one peer entry component for each peering link that the AS wants to advertise. The Control Service <span class="bcp14">MUST NOT</span> specify the egress Interface ID in the Hop Field component of each added peer entry.<a href="#section-3.1.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-3.2.2.1">
                  <p id="section-3.1.1-3.2.2.1.1">In Protobuf message format, this means that the value of the <code>egress</code> field in the <code>HopField</code> component <span class="bcp14">MUST</span> be "0".<a href="#section-3.1.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.1.1-3.3">
              <p id="section-3.1.1-3.3.1">The Control Service <span class="bcp14">MUST</span> sign the modified PCB and append the computed signature.<a href="#section-3.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.1-4"><strong>Note:</strong><a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-5.1">
              <p id="section-3.1.1-5.1.1">For more information on the signed body component of an AS entry, see <a href="#ase-sign" class="auto internal xref">Section 2.2.2.2</a>.<a href="#section-3.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-5.2">
              <p id="section-3.1.1-5.2.1">For more information on a peer entry, see <a href="#peerentry" class="auto internal xref">Section 2.2.2.4</a>.<a href="#section-3.1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-5.3">
              <p id="section-3.1.1-5.3.1">For more information on the Hop Field component, see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>.<a href="#section-3.1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-5.4">
              <p id="section-3.1.1-5.4.1">For more information on signing an AS entry, see <a href="#sign" class="auto internal xref">Section 2.2.2.6</a>.<a href="#section-3.1.1-5.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="transforming-a-pcb-into-an-up-segment">
<section id="section-3.1.2">
          <h4 id="name-transforming-a-pcb-into-an-">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-transforming-a-pcb-into-an-" class="section-name selfRef">Transforming a PCB into an Up Segment</a>
          </h4>
<p id="section-3.1.2-1">Every registration interval, the Control Service of a non-core AS performs the following steps to transform PCBs into up segments:<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.2-2">
<li id="section-3.1.2-2.1">
              <p id="section-3.1.2-2.1.1">The Control Service selects the PCBs that it wants to transform into up segments from the candidate PCBs in the Beacon Store.<a href="#section-3.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.2">
              <p id="section-3.1.2-2.2.1">The Control Service "terminates" the selected PCBs by performing the steps described in <a href="#term-pcb" class="auto internal xref">Section 3.1.1</a>. From this moment on, the modified PCBs are called <strong>up segments</strong>.<a href="#section-3.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.3">
              <p id="section-3.1.2-2.3.1">The Control Service adds the newly created up segments to its own path database.<a href="#section-3.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.2-3"><strong>Note:</strong> For more information on possible selection strategies of PCBs, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transforming-a-pcb-into-a-down-segment">
<section id="section-3.1.3">
          <h4 id="name-transforming-a-pcb-into-a-d">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-transforming-a-pcb-into-a-d" class="section-name selfRef">Transforming a PCB into a Down Segment</a>
          </h4>
<p id="section-3.1.3-1">Every registration interval, the Control Service of a non-core AS performs the following steps to transform PCBs into down segments:<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-2">
<li id="section-3.1.3-2.1">
              <p id="section-3.1.3-2.1.1">The Control Service selects the PCBs that it wants to transform into down segments from the candidate PCBs in the Beacon Store.<a href="#section-3.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.3-2.2">
              <p id="section-3.1.3-2.2.1">The Control Service "terminates" the selected PCBs by performing the steps described in <a href="#term-pcb" class="auto internal xref">Section 3.1.1</a>. From this moment on, the modified PCBs are called <strong>down segments</strong>.<a href="#section-3.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.3-2.3">
              <p id="section-3.1.3-2.3.1">The Control Service registers the newly created down segments with the Control Services of the core ASes that originated the corresponding PCBs. This is done by invoking the <code>SegmentRegistrationService.SegmentsRegistration</code> remote procedure call (RPC) in the Control Services of the relevant core ASes (see also <a href="#reg-proto" class="auto internal xref">Section 3.3</a>). The first ISD-AS entry of the path segment <span class="bcp14">SHOULD</span> be equal to the core ISD-AS where the segment is being registered, otherwise the core AS <span class="bcp14">MUST</span> reject the segment. As a result, a core AS’s Control Service contains all down segments registered by its direct or indirect customer ASes.<a href="#section-3.1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.3-3"><strong>Note:</strong> For more information on possible selection strategies of PCBs, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-3.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="core-path-segment-registration">
<section id="section-3.2">
        <h3 id="name-core-path-segment-registrat">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-core-path-segment-registrat" class="section-name selfRef">Core Path Segment Registration</a>
        </h3>
<p id="section-3.2-1">The core beaconing process creates path segments from core AS to core AS. These core segments are then added to the Control Service path database of the core AS that created the segment so that local and remote endpoints can obtain and use these core segments. In contrast to the intra-ISD registration procedure, there is no need to register core segments with other core ASes as each core AS will receive PCBs originated from every other core AS.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In every registration interval, the Control Service of a core AS performs the following operations:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3">
<li id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">The core Control Service selects the best PCBs towards each core AS observed so far.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">The core Control Service "terminates" the selected PCBs by performing the steps described in <a href="#term-pcb" class="auto internal xref">Section 3.1.1</a>. From this moment on, the modified PCBs are called <strong>core segments</strong>.<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">The Control Service adds the newly created core segments to its own path database.<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-4"><strong>Note:</strong> For more information on possible selection strategies of PCBs, see <a href="#selection" class="auto internal xref">Section 2.3.3</a>.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reg-proto">
<section id="section-3.3">
        <h3 id="name-path-segment-registration-r">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-path-segment-registration-r" class="section-name selfRef">Path Segment Registration RPC API</a>
        </h3>
<p id="section-3.3-1">The Control Service of a non-core AS has to register the newly created down segments with the Control Services of the core ASes that originated the corresponding PCBs. This registration step is implemented as follows in Protobuf message format:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>
   enum SegmentType {
       SEGMENT_TYPE_UNSPECIFIED = 0;
       SEGMENT_TYPE_UP = 1;
       SEGMENT_TYPE_DOWN = 2;
       SEGMENT_TYPE_CORE = 3;
   }

   service SegmentRegistrationService {
       rpc SegmentsRegistration(SegmentsRegistrationRequest) returns (
         SegmentsRegistrationResponse) {}
   }

   message SegmentsRegistrationRequest {
       message Segments {
           repeated PathSegment segments = 1;
       }

       map&lt;int32, Segments&gt; segments = 1;
   }

   message SegmentsRegistrationResponse {}
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">
            <p id="section-3.3-3.1.1"><code>SegmentType</code>: Specifies the type of the path segment to be registered. Currently, only the following type is used:<a href="#section-3.3-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1.2.1">
                <p id="section-3.3-3.1.2.1.1"><code>SEGMENT_TYPE_DOWN</code>: Specifies a down segment.<a href="#section-3.3-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.3-3.2">
            <p id="section-3.3-3.2.1"><code>map&lt;int32, Segments&gt; segments</code>: Represents a separate list of segments for each path segment type. The key is the integer representation of the corresponding <code>SegmentType</code>.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.3">
            <p id="section-3.3-3.3.1"><code>SegmentRegistrationResponse</code>: an empty message returned as an acknowledgement upon success.<a href="#section-3.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="path-mtu">
<section id="section-3.4">
        <h3 id="name-path-mtu">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-path-mtu" class="section-name selfRef">Path MTU</a>
        </h3>
<p id="section-3.4-1">SCION paths represent a sequence of ASes and inter-AS links, each with possibly different MTUs. As a result, the path MTU is the minimum of the MTUs of each inter-AS link and intra-AS network it traverses. Such MTU information is disseminated during path construction:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">The MTU of each intra-AS network traversed (represented by the MTU field of the corresponding <span><a href="#ase-sign" class="internal xref">AS Entries</a> (<a href="#ase-sign" class="auto internal xref">Section 2.2.2.2</a>)</span>)<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The MTU of each inter-AS link or peering link (indicated by the ingress_mtu field of each <a href="#hopentry" class="auto internal xref">Section 2.2.2.3</a> or the peer_mtu field of each <a href="#peerentry" class="auto internal xref">Section 2.2.2.4</a> used)<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">Such information is then made available to source endpoints during the path lookup process (see <a href="#lookup" class="auto internal xref">Section 4</a>). Note that the destination endpoint does not receive such information, so when using path reversibility it should use mechanisms to estimate the reverse path MTU (e.g.,, MTU discovery or estimate MTU from the largest packet received). SCION endpoints are oblivious to the internal topology of intermediate ASes, so when looking up a path they should assume that all hops are also constrained by the intra-AS MTU of each AS traversed.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="lookup">
<section id="section-4">
      <h2 id="name-path-lookup">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-path-lookup" class="section-name selfRef">Path Lookup</a>
      </h2>
<p id="section-4-1">The <em>path lookup</em> is a fundamental building block of SCION's path management as it enables endpoints to obtain path segments found during path exploration and registered during path registration. This allows the endpoints to construct end-to-end paths from the set of possible path segments returned by the path lookup process. The lookup of paths still happens in the control plane, whereas the construction of the actual end-to-end paths happens in the data plane.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="lookup-process">
<section id="section-4.1">
        <h3 id="name-lookup-process">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-lookup-process" class="section-name selfRef">Lookup Process</a>
        </h3>
<p id="section-4.1-1">An endpoint (source) that wants to start communication with another endpoint (destination) requires up to three path segments:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">An up segment to reach the core of the source ISD (only if the source endpoint is a non-core AS);<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">a core segment to reach<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.2.2.1">
                <p id="section-4.1-2.2.2.1.1">another core AS in the source ISD, in case the destination AS is in the same source ISD, or;<a href="#section-4.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.2.2.2">
                <p id="section-4.1-2.2.2.2.1">a core AS in a remote ISD, if the destination AS is in another ISD, and;<a href="#section-4.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">a down segment to reach the destination AS.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">The actual number of required path segments depends on the location of the destination AS as well as on the availability of shortcuts and peering links. More information on combining and constructing paths is provided by <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">The process to look up and fetch path segments consists of the following steps:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-5">
<li id="section-4.1-5.1">
            <p id="section-4.1-5.1.1">The source endpoint queries the Control Service in its own AS (i.e., the source AS) for the required segments by sending up to three <code>SegmentsRequest</code> messages, respectively for up, core and down segments.<a href="#section-4.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-5.2">
            <p id="section-4.1-5.2.1">The Control Service of the source AS answers each request with  a <code>SegmentsResponse</code> message. Specifically, for each segment type:<a href="#section-4.1-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-5.2.2.1">
                <p id="section-4.1-5.2.2.1.1">up segments: The local Control Service has up segments stored in the path database and returns them immediately.<a href="#section-4.1-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-5.2.2.2">
                <p id="section-4.1-5.2.2.2.1">core segments: The local Control Service may return locally cached core segments or query the Control Services of the reachable core ASes in the source ISD. These core ASes return core segments to core ASes in the destination ISD. To reach the core Control Services, the Control Service of the source AS uses the locally stored up segments. Once obtained, it returns the core segments and adds them to the local cache for future request.<a href="#section-4.1-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-5.2.2.3">
                <p id="section-4.1-5.2.2.3.1">down segments: The local Control Service may return locally cached core segments or query the Control Services of the remote core ASes in the destination ISD. These remote core ASes return down segments to the destination AS. To reach the remote core ASes, the Control Service of the source AS uses the previously obtained and combined up and core segments. Once obtained, it returns the down segments.<a href="#section-4.1-5.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-4.1-5.3">
            <p id="section-4.1-5.3.1">As the source endpoint receives each path segment, it verifies the <code>SegmentInformation</code> timestamp validity (see <a href="#pcb-validity" class="auto internal xref">Section 2.2.4</a>), the AS entry signature for each AS entry (see <a href="#sign" class="auto internal xref">Section 2.2.2.6</a>), and requests any missing AS or intermediate certificates from the Control Service (see <a href="#crypto-api" class="auto internal xref">Section 2.4</a>).<a href="#section-4.1-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-5.4">
            <p id="section-4.1-5.4.1">Once it has obtained some valid path segments, the source endpoint combines them into an end-to-end path in the data plane.<a href="#section-4.1-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-5.5">
            <p id="section-4.1-5.5.1">The destination endpoint, once it receives the first packet, <span class="bcp14">MAY</span> reverse the path in the received packet in order to construct a response. This ensures that traffic flows on the same path bidirectionally.<a href="#section-4.1-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.1-6"><a href="#_table-3" class="auto internal xref">Table 3</a> below shows which Control Service provides the source endpoint with which type of path segment.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<span id="name-control-services-responsibl"></span><div id="_table-3">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-control-services-responsibl" class="selfRef">Control services responsible for different types of path segments</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Segment Type</th>
              <th class="text-left" rowspan="1" colspan="1">Responsible Control Service(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Up-segment</td>
              <td class="text-left" rowspan="1" colspan="1">Control service of the source AS</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Core-segment</td>
              <td class="text-left" rowspan="1" colspan="1">Control service of core ASes in source ISD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Down-segment</td>
              <td class="text-left" rowspan="1" colspan="1">Control service of core ASes in destination ISD (either the local ISD or a remote ISD)</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="sequence-of-lookup-requests">
<section id="section-4.1.1">
          <h4 id="name-sequence-of-lookup-requests">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-sequence-of-lookup-requests" class="section-name selfRef">Sequence of Lookup Requests</a>
          </h4>
<p id="section-4.1.1-1">The overall sequence of requests to resolve a path <span class="bcp14">SHOULD</span> be as follows:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1-2">
<li id="section-4.1.1-2.1">
              <p id="section-4.1.1-2.1.1">Request up segments for the source endpoint at the Control Service of the source AS.<a href="#section-4.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.1-2.2">
              <p id="section-4.1.1-2.2.1">Request core segments, which start at the core ASes that are reachable with up segments and end at the core ASes in the destination ISD. If the destination ISD coincides with the source ISD, this step requests core segments to core ASes that the source endpoint cannot directly reach with an up segment.<a href="#section-4.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.1.1-2.3">
              <p id="section-4.1.1-2.3.1">Request down segments starting at core ASes in the destination ISD.<a href="#section-4.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="lookup-requests-message-format">
<section id="section-4.1.2">
          <h4 id="name-lookup-requests-message-for">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-lookup-requests-message-for" class="section-name selfRef">Lookup Requests Message Format</a>
          </h4>
<p id="section-4.1.2-1">Control Services provide path segments through the <code>SegmentLookupService</code> RPC. This API is exposed:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-2.1">
              <p id="section-4.1.2-2.1.1">for core ASes, on the SCION dataplane to other ASes<a href="#section-4.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-2.2">
              <p id="section-4.1.2-2.2.1">for all ASes, on the intra-AS network to endpoints.<a href="#section-4.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-4.1.2-3">
<pre>
service SegmentLookupService {
    rpc Segments(SegmentsRequest) returns (SegmentsResponse) {}
}
</pre><a href="#section-4.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-4">They use the following protobuf messages: a <code>SegmentsRequest</code>, which includes:<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-5.1">
              <p id="section-4.1.2-5.1.1"><code>src_isd_as</code>: The source ISD-AS of the segment.<a href="#section-4.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-5.2">
              <p id="section-4.1.2-5.2.1"><code>dst_isd_as</code>: The destination ISD-AS of the segment.<a href="#section-4.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.2-6">The corresponding <code>SegmentsResponse</code> returns:<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-7.1">
              <p id="section-4.1.2-7.1.1"><code>segments</code>: a list of <code>PathSegment</code> matching the request.<a href="#section-4.1.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.2-7.2">
              <p id="section-4.1.2-7.2.1">a mapping from path segment type to path segments, where the key is the integer representation of the <code>SegmentType</code> enum defined in <a href="#reg-proto" class="auto internal xref">Section 3.3</a>.<a href="#section-4.1.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-4.1.2-8">
<pre>
message SegmentsRequest {
    uint64 src_isd_as = 1;
    uint64 dst_isd_as = 2;
}

message SegmentsResponse {
    message Segments {
        repeated PathSegment segments = 1;
    }
    map&lt;int32, Segments&gt; segments = 1;
}
</pre><a href="#section-4.1.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="caching">
<section id="section-4.1.3">
          <h4 id="name-caching">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-caching" class="section-name selfRef">Caching</a>
          </h4>
<p id="section-4.1.3-1">For the sake of efficiency, the Control Service of the source AS <span class="bcp14">SHOULD</span> cache each returned path segment request. Caching ensures that path lookups are fast for frequently used destinations and is also essential to ensure that the path lookup process is scalable and that endpoints can perform it with low latency.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">In general, to improve overall efficiency, the Control Services of all ASes <span class="bcp14">SHOULD</span> do the following:<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.3-3.1">
              <p id="section-4.1.3-3.1.1">Cache the returned path segments.<a href="#section-4.1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-3.2">
              <p id="section-4.1.3-3.2.1">Send requests in parallel when requesting path segments from other Control Services.<a href="#section-4.1.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="behavior-of-actors-in-the-lookup-process">
<section id="section-4.2">
        <h3 id="name-behavior-of-actors-in-the-l">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-behavior-of-actors-in-the-l" class="section-name selfRef">Behavior of Actors in the Lookup Process</a>
        </h3>
<p id="section-4.2-1">The source endpoint resolves paths with a sequence of segment requests to the Control Service of the source AS. The Control Service in the source AS either answers directly or forwards these requests to the responsible Control Services of core ASes. In SCION, the instances that handle these segment requests at the Control Services are called <em>source AS segment-request handler</em> and <em>core AS segment-request handler</em>, respectively.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">This section specifies the behavior of the segment request handlers in the lookup process.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div id="wildcard">
<section id="section-4.2.1">
          <h4 id="name-use-of-wildcard-addresses-i">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-use-of-wildcard-addresses-i" class="section-name selfRef">Use of Wildcard Addresses in the Lookup Process</a>
          </h4>
<p id="section-4.2.1-1">Endpoints can use wildcard addresses to designate any core AS in path segment requests. The segment request handlers <span class="bcp14">MUST</span> expand these wildcard addresses and translate them into one or more actual addresses. <a href="#_table-4" class="auto internal xref">Table 4</a> below shows who is responsible for what.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2"><strong>Note:</strong> For general information on the use of wildcard addresses in SCION, see <a href="#serv-disc" class="auto internal xref">Section 1.5.2.1</a>.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<span id="name-use-of-wildcards-in-path-se"></span><div id="_table-4">
<table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-use-of-wildcards-in-path-se" class="selfRef">Use of wildcards in path segments requests</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Segment Request</th>
                <th class="text-left" rowspan="1" colspan="1">Wildcard Represents</th>
                <th class="text-left" rowspan="1" colspan="1">Expanded/Translated By</th>
                <th class="text-left" rowspan="1" colspan="1">Translated Into</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Up segment</td>
                <td class="text-left" rowspan="1" colspan="1">"Destination" core AS (where up segment ends)</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address destination core AS in source ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Core segment</td>
                <td class="text-left" rowspan="1" colspan="1">Source core AS (where core segment starts)<sup>1</sup>
</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address source core AS in source ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Core segment</td>
                <td class="text-left" rowspan="1" colspan="1">Destination core AS (where core segment ends)</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source core AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address destination core AS in destination ISD</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Down segment</td>
                <td class="text-left" rowspan="1" colspan="1">"Source" core AS (where down segment starts)<sup>2</sup>
</td>
                <td class="text-left" rowspan="1" colspan="1">Control service of the <em>source AS</em>
</td>
                <td class="text-left" rowspan="1" colspan="1">Actual address source core AS in destination ISD</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.2.1-4">1) Includes all core ASes for which an up segment from the source AS exists.<br>
2) Includes all core ASes in destination ISD with a down segment to destination AS.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="segment-request-handler-of-a-non-core-source-as">
<section id="section-4.2.2">
          <h4 id="name-segment-request-handler-of-">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-segment-request-handler-of-" class="section-name selfRef">Segment-Request Handler of a Non-Core Source AS</a>
          </h4>
<p id="section-4.2.2-1">When the segment request handler of the Control Service of a <em>non-core</em> source AS receives a path segment request, it <span class="bcp14">MUST</span> proceed as follows:<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2-2">
<li id="section-4.2.2-2.1">
              <p id="section-4.2.2-2.1.1">Determine the requested segment type.<a href="#section-4.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.2-2.2">
              <p id="section-4.2.2-2.2.1">In the case of an up segment request, look up matching up segments in the path database and return them.<a href="#section-4.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.2-2.3">
              <p id="section-4.2.2-2.3.1">In the case of a core segment request from a source core AS to a destination core AS:<a href="#section-4.2.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-2.3.2.1">
                  <p id="section-4.2.2-2.3.2.1.1">Expand the source wildcard into separate requests for each reachable core AS in the source ISD.<a href="#section-4.2.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.2-2.3.2.2">
                  <p id="section-4.2.2-2.3.2.2.1">For each core segment request;<a href="#section-4.2.2-2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-2.3.2.2.2.1">
                      <p id="section-4.2.2-2.3.2.2.2.1.1">If possible, return matching core segments from cache;<a href="#section-4.2.2-2.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.2-2.3.2.2.2.2">
                      <p id="section-4.2.2-2.3.2.2.2.2.1">Otherwise, request the core segments from the Control Services of each reachable core AS at the source of the core segment, and then add the retrieved core segments to the cache.<a href="#section-4.2.2-2.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-4.2.2-2.4">
              <p id="section-4.2.2-2.4.1">In the case of a down segment request:<a href="#section-4.2.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-2.4.2.1">
                  <p id="section-4.2.2-2.4.2.1.1">Expand the source wildcard into separate requests for every core AS in the destination ISD (referring to the ISD to which the destination endpoint belongs).<a href="#section-4.2.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.2-2.4.2.2">
                  <p id="section-4.2.2-2.4.2.2.1">For each segment request;<a href="#section-4.2.2-2.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-2.4.2.2.2.1">
                      <p id="section-4.2.2-2.4.2.2.2.1.1">If possible, return matching down segments from cache;<a href="#section-4.2.2-2.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.2-2.4.2.2.2.2">
                      <p id="section-4.2.2-2.4.2.2.2.2.1">Otherwise, request the down segment from the Control Services of the core ASes at the source of the down segment. Sending the request may require looking up core segments to the source core AS of the down segment, and then adding the retrieved down segments to the cache.<a href="#section-4.2.2-2.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
<div id="segment-request-handler-of-a-core-as">
<section id="section-4.2.3">
          <h4 id="name-segment-request-handler-of-a">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-segment-request-handler-of-a" class="section-name selfRef">Segment-Request Handler of a Core AS</a>
          </h4>
<p id="section-4.2.3-1">When the segment request handler of a <em>core AS</em> Control Service receives a path segment request, it <span class="bcp14">MUST</span> proceed as follows:<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.3-2">
<li id="section-4.2.3-2.1">
              <p id="section-4.2.3-2.1.1">Validate the request:<a href="#section-4.2.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-2.1.2.1">
                  <p id="section-4.2.3-2.1.2.1.1">The source of the path segment <span class="bcp14">MUST</span> be this core AS.<a href="#section-4.2.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.3-2.1.2.2">
                  <p id="section-4.2.3-2.1.2.2.1">The request <span class="bcp14">MUST</span> either be;<a href="#section-4.2.3-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-2.1.2.2.2.1">
                      <p id="section-4.2.3-2.1.2.2.2.1.1">for a core segment to a core AS in this ISD or another ISD, or;<a href="#section-4.2.3-2.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.3-2.1.2.2.2.2">
                      <p id="section-4.2.3-2.1.2.2.2.2.1">for a down segment to an AS in this ISD.<a href="#section-4.2.3-2.1.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-4.2.3-2.2">
              <p id="section-4.2.3-2.2.1">If the destination is a core or wildcard address, then load matching core segments from the path database and return.<a href="#section-4.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.3-2.3">
              <p id="section-4.2.3-2.3.1">Otherwise, load the matching down segments from the path database and return.<a href="#section-4.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.2.3-3"><a href="#app-c" class="auto internal xref">Appendix "Path-Lookup Examples"</a> shows by means of an illustration how the lookup of path segments in SCION works.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="service-discovery">
<section id="section-5">
      <h2 id="name-control-service-discovery">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-control-service-discovery" class="section-name selfRef">Control Service Discovery</a>
      </h2>
<p id="section-5-1">The Control Plane RPC APIs rely on QUIC connections over UDP/SCION (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>. Establishing such connection requires the initiator to identify the relevant peer (service resolution) and to select a path to it. Since the Control Service is itself the source of path segment information, the following bootstrapping processes apply:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">Neighboring ASes communicate using one-hop paths, as described in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span>. Core ASes leverage this mechanism when originating new PCBs.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">Paths to non-neighboring ASes are discovered and constructed incrementally by propagating beacons received from neighbors via these one-hop paths.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">The resulting multi-hop path segments are registered with the Control Service of the origin Core AS (see <a href="#intra-reg" class="auto internal xref">Section 3.1</a>).<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.4">
          <p id="section-5-2.4.1">Control Services respond to requests from remote ASes by reversing the path carried in the request packet.<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">Clients find the relevant Control Service at a given AS by resolving a 'service address' as follows:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-4">
<li id="section-5-4.1">
          <p id="section-5-4.1.1">A client sends a <code>ServiceResolutionRequest</code> RPC (which has no parameters) to an endpoint address in the format:<a href="#section-5-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1.2.1">
              <p id="section-5-4.1.2.1.1">Common Header:<a href="#section-5-4.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1.2.1.2.1">
                  <p id="section-5-4.1.2.1.2.1.1">Path type: SCION (0x01)<a href="#section-5-4.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5-4.1.2.1.2.2">
                  <p id="section-5-4.1.2.1.2.2.1">DT/DL: "Service" (0b0100)<a href="#section-5-4.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5-4.1.2.2">
              <p id="section-5-4.1.2.2.1">Address Header:<a href="#section-5-4.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1.2.2.2.1">
                  <p id="section-5-4.1.2.2.2.1.1">DstHostAddr: "SVC_CS" (0x0002)<a href="#section-5-4.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5-4.1.2.3">
              <p id="section-5-4.1.2.3.1">UDP Header:<a href="#section-5-4.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1.2.3.2.1">
                  <p id="section-5-4.1.2.3.2.1.1">DstPort: 0<a href="#section-5-4.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-5-4.1.3">
A <code>ServiceResolutionRequest</code> <span class="bcp14">MUST</span> fit within a UDP datagram, otherwise clients and servers won't be able to establish control-plane reachability.<a href="#section-5-4.1.3" class="pilcrow">¶</a></p>
</li>
        <li id="section-5-4.2">
          <p id="section-5-4.2.1">The ingress border router at the destination AS resolves the service destination to an actual endpoint address. This document does not mandate any specific method for this resolution.<a href="#section-5-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-5-4.3">
          <p id="section-5-4.3.1">The ingress border router forwards the message to the resolved address.<a href="#section-5-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-5-4.4">
          <p id="section-5-4.4.1">The destination service responds to the client with a <code>ServiceResolutionResponse</code>. It contains one or more transport options and it <span class="bcp14">MUST</span> fit within a UDP datagram.
  Known transports are "QUIC". Clients <span class="bcp14">MUST</span> ignore unknown values. The response includes a <code>Transport</code> message containing supported addresses and port to reach the service.
  Supported address formats for QUIC are IPv4 and IPv6. An example of the corresponding address format is:
  <code>192.0.2.1:80</code> and <code>[2001:db8::1]:80</code>. Clients <span class="bcp14">MUST</span> treat a missing, zero or non-existent port value as an error.<a href="#section-5-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-5-4.5">
          <p id="section-5-4.5.1">The client uses the address and port from the "QUIC" option to establish a QUIC connection, which can then be used for other RPCs.<a href="#section-5-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-5-5">The service resolution API Protobuf message format is:<a href="#section-5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-6">
<pre>
message ServiceResolutionRequest {}

message ServiceResolutionResponse {
    map&lt;string, Transport&gt; transports = 1;
}

message Transport {
    string address = 1;
}
</pre><a href="#section-5-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="scmp">
<section id="section-6">
      <h2 id="name-scmp">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-scmp" class="section-name selfRef">SCMP</a>
      </h2>
<p id="section-6-1">The SCION Control Message Protocol (SCMP) provides functionality for network diagnostics, such as traceroute and error messages that signal packet processing or network layer problems. SCMP is a helpful tool for network diagnostics and - in the case of External Interface Down and Internal Connectivity Down messages - a signal for endpoints to detect network failures more rapidly and fail-over to different paths. However, SCION nodes should not strictly rely on the availability of SCMP, as this protocol may not be supported by all devices and/or may be subject to rate limiting.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This document only specifies the messages used for the purposes of path diagnosis and recovery. An extended specification can be found in <span>[<a href="#SCMP" class="cite xref">SCMP</a>]</span>. Its security considerations are discussed in <a href="#manipulate-selection" class="auto internal xref">Section 8.3.4</a>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Note that there is not currently a defined mechanism for converting ICMP messages to SCMP messages, or vice-versa.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="general-format">
<section id="section-6.1">
        <h3 id="name-general-format">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-general-format" class="section-name selfRef">General Format</a>
        </h3>
<p id="section-6.1-1">Every SCMP message is preceded by a SCION header and zero or more SCION extension headers (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "SCION Header Specification"). The SCMP header is identified by a <code>NextHdr</code> value of <code>202</code> in the immediately preceding header.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The messages have the following general format:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<span id="name-scmp-message-format"></span><div id="scmp-format">
<figure id="figure-16">
          <div id="section-6.1-3.1">
            <div class="alignLeft art-svg artwork" id="section-6.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="528" viewBox="0 0 528 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,64 L 8,160" fill="none" stroke="black"></path>
                <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                <path d="M 264,64 L 264,96" fill="none" stroke="black"></path>
                <path d="M 520,64 L 520,160" fill="none" stroke="black"></path>
                <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                <path d="M 8,160 L 520,160" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="16" y="36">0</text>
                  <text x="176" y="36">1</text>
                  <text x="336" y="36">2</text>
                  <text x="496" y="36">3</text>
                  <text x="16" y="52">0</text>
                  <text x="32" y="52">1</text>
                  <text x="48" y="52">2</text>
                  <text x="64" y="52">3</text>
                  <text x="80" y="52">4</text>
                  <text x="96" y="52">5</text>
                  <text x="112" y="52">6</text>
                  <text x="128" y="52">7</text>
                  <text x="144" y="52">8</text>
                  <text x="160" y="52">9</text>
                  <text x="176" y="52">0</text>
                  <text x="192" y="52">1</text>
                  <text x="208" y="52">2</text>
                  <text x="224" y="52">3</text>
                  <text x="240" y="52">4</text>
                  <text x="256" y="52">5</text>
                  <text x="272" y="52">6</text>
                  <text x="288" y="52">7</text>
                  <text x="304" y="52">8</text>
                  <text x="320" y="52">9</text>
                  <text x="336" y="52">0</text>
                  <text x="352" y="52">1</text>
                  <text x="368" y="52">2</text>
                  <text x="384" y="52">3</text>
                  <text x="400" y="52">4</text>
                  <text x="416" y="52">5</text>
                  <text x="432" y="52">6</text>
                  <text x="448" y="52">7</text>
                  <text x="464" y="52">8</text>
                  <text x="480" y="52">9</text>
                  <text x="496" y="52">0</text>
                  <text x="512" y="52">1</text>
                  <text x="68" y="84">Type</text>
                  <text x="196" y="84">Code</text>
                  <text x="388" y="84">Checksum</text>
                  <text x="252" y="116">Type-dependent</text>
                  <text x="336" y="116">Block</text>
                  <text x="208" y="148">(</text>
                  <text x="252" y="148">variable</text>
                  <text x="316" y="148">length</text>
                  <text x="352" y="148">)</text>
                </g>
              </svg><a href="#section-6.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-scmp-message-format" class="selfRef">SCMP message format</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1"><code>Type</code>: it indicates the type of SCMP message. Its value determines the format of the type-dependent block.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1"><code>Code</code>: it provides additional granularity to the SCMP type.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.3">
            <p id="section-6.1-4.3.1"><code>Checksum</code>: it is used to detect data corruption.<a href="#section-6.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.4">
            <p id="section-6.1-4.4.1"><code>Type-dependent Block</code>: optional field of variable length which format is dependent on the message type.<a href="#section-6.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="message-types">
<section id="section-6.2">
        <h3 id="name-message-types">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-message-types" class="section-name selfRef">Message Types</a>
        </h3>
<p id="section-6.2-1">SCMP messages are grouped into two classes: error messages and informational messages. Error messages are identified by a zero in the high-order bit of the type value - i.e., error messages have a type value in the range of 0-127. Informational messages have type values in the range of 128-255.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">This specification defines the message formats for the following SCMP messages:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span id="name-error-message-types"></span><table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-error-message-types" class="selfRef">Error Message Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#packet-too-big" class="internal xref">Packet Too Big</a> (<a href="#packet-too-big" class="auto internal xref">Section 6.5.1</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#external-interface-down" class="internal xref">External Interface Down</a> (<a href="#external-interface-down" class="auto internal xref">Section 6.5.2</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#internal-connectivity-down" class="internal xref">Internal Connectivity Down</a> (<a href="#internal-connectivity-down" class="auto internal xref">Section 6.5.3</a>)</span>
</td>
            </tr>
          </tbody>
        </table>
<span id="name-informational-message-types"></span><table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-informational-message-types" class="selfRef">Informational Message Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#echo-request" class="internal xref">Echo Request</a> (<a href="#echo-request" class="auto internal xref">Section 6.6.1</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">129</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#echo-reply" class="internal xref">Echo Reply</a> (<a href="#echo-reply" class="auto internal xref">Section 6.6.2</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">130</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#traceroute-request" class="internal xref">Traceroute Request</a> (<a href="#traceroute-request" class="auto internal xref">Section 6.6.3</a>)</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">131</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span><a href="#traceroute-reply" class="internal xref">Traceroute Reply</a> (<a href="#traceroute-reply" class="auto internal xref">Section 6.6.4</a>)</span>
</td>
            </tr>
          </tbody>
        </table>
<p id="section-6.2-5">Further SCMP errors are covered in <span>[<a href="#SCMP" class="cite xref">SCMP</a>]</span>.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="checksum-calculation">
<section id="section-6.3">
        <h3 id="name-checksum-calculation">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-checksum-calculation" class="section-name selfRef">Checksum Calculation</a>
        </h3>
<p id="section-6.3-1">The checksum is calculated as the 16-bit one's complement of the one's complement sum of the entire SCMP message. This is starting with the SCMP message type field, and prepended with a "pseudo-header" consisting of the SCION address header and the Layer 4 protocol type as defined in <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "SCION Header Specification/Pseudo Header for Upper-Layer Checksum".<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-rules">
<section id="section-6.4">
        <h3 id="name-processing-rules">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-processing-rules" class="section-name selfRef">Processing Rules</a>
        </h3>
<p id="section-6.4-1">The following rules apply when processing SCMP messages:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
            <p id="section-6.4-2.1.1">If an SCMP error message of unknown type is received at its destination, it <span class="bcp14">MUST</span> be passed to the upper-layer process that originated the packet that caused the error, if it can be identified.<a href="#section-6.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.2">
            <p id="section-6.4-2.2.1">If an SCMP informational message of unknown type is received, it <span class="bcp14">MUST</span> be silently dropped.<a href="#section-6.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.3">
            <p id="section-6.4-2.3.1">Every SCMP error message <span class="bcp14">MUST</span> include as much of the offending SCION packet as possible. The error message packet - including the SCION header and all extension headers <span class="bcp14">MUST NOT</span> exceed <strong>1232 bytes</strong> in order to fit into the minimum MTU (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "Deployment Considerations/MTU").<a href="#section-6.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.4">
            <p id="section-6.4-2.4.1">In case the implementation is required to pass an SCMP error message to the upper-layer process, the upper-layer protocol type is extracted from the original packet in the body of the SCMP error message and used to select the appropriate process to handle the error. In case the upper-layer protocol type cannot be extracted from the SCMP error message body, the SCMP message <span class="bcp14">MUST</span> be silently dropped.<a href="#section-6.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.5">
            <p id="section-6.4-2.5.1">An SCMP error message <span class="bcp14">MUST NOT</span> be originated in response to any of the following:<a href="#section-6.4-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.5.2.1">
                <p id="section-6.4-2.5.2.1.1">An SCMP error message.<a href="#section-6.4-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.4-2.5.2.2">
                <p id="section-6.4-2.5.2.2.1">A packet which source address does not uniquely identify a single node. E.g., an IPv4 or IPv6 multicast address.<a href="#section-6.4-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.4-3">The maximum size 1232 bytes is chosen so that the entire datagram, if encapsulated in UDP and IPv6, does not exceed 1280 bytes (L2 Header excluded). 1280 bytes is the minimum MTU required by IPv6 and it is assumed that this MTU can also be safely expected when using IPv4.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scmp-notification">
<section id="section-6.5">
        <h3 id="name-error-messages">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-error-messages" class="section-name selfRef">Error Messages</a>
        </h3>
<div id="packet-too-big">
<section id="section-6.5.1">
          <h4 id="name-packet-too-big">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-packet-too-big" class="section-name selfRef">Packet Too Big</a>
          </h4>
<span id="name-packet-too-big-format"></span><div id="_figure-21">
<figure id="figure-17">
            <div id="section-6.5.1-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.5.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="528" viewBox="0 0 528 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,192" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,192" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                  <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="140" y="116">Reserved</text>
                    <text x="384" y="116">MTU</text>
                    <text x="148" y="148">As</text>
                    <text x="180" y="148">much</text>
                    <text x="212" y="148">of</text>
                    <text x="240" y="148">the</text>
                    <text x="296" y="148">offending</text>
                    <text x="364" y="148">packet</text>
                    <text x="132" y="164">as</text>
                    <text x="180" y="164">possible</text>
                    <text x="248" y="164">without</text>
                    <text x="296" y="164">the</text>
                    <text x="332" y="164">SCMP</text>
                    <text x="380" y="164">packet</text>
                    <text x="208" y="180">exceeding</text>
                    <text x="268" y="180">1232</text>
                    <text x="316" y="180">bytes.</text>
                  </g>
                </svg><a href="#section-6.5.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-packet-too-big-format" class="selfRef">Packet Too Big format</a>
            </figcaption></figure>
</div>
<span id="name-error-message-field-values"></span><table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-error-message-field-values" class="selfRef">Error Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">MTU</td>
                <td class="text-left" rowspan="1" colspan="1">The Maximum Transmission Unit of the next-hop link.</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.5.1-3">A <strong>Packet Too Big</strong> message <span class="bcp14">SHOULD</span> be originated by a router in response to a
packet that cannot be forwarded because the packet is larger than the MTU of the
outgoing link. The router sets the MTU value to the maximum size a SCION packet can have
to still fit on the next-hop link, as the sender has no knowledge of the
underlay.<a href="#section-6.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="external-interface-down">
<section id="section-6.5.2">
          <h4 id="name-external-interface-down">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-external-interface-down" class="section-name selfRef">External Interface Down</a>
          </h4>
<span id="name-external-interface-down-for"></span><div id="_figure-22">
<figure id="figure-18">
            <div id="section-6.5.2-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.5.2-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="528" viewBox="0 0 528 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,288" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,288" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 520,160" fill="none" stroke="black"></path>
                  <path d="M 8,224 L 520,224" fill="none" stroke="black"></path>
                  <path d="M 8,288 L 520,288" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="136" y="116">ISD</text>
                    <text x="380" y="132">AS</text>
                    <text x="240" y="196">Interface</text>
                    <text x="292" y="196">ID</text>
                    <text x="148" y="244">As</text>
                    <text x="180" y="244">much</text>
                    <text x="212" y="244">of</text>
                    <text x="240" y="244">the</text>
                    <text x="296" y="244">offending</text>
                    <text x="364" y="244">packet</text>
                    <text x="132" y="260">as</text>
                    <text x="180" y="260">possible</text>
                    <text x="248" y="260">without</text>
                    <text x="296" y="260">the</text>
                    <text x="332" y="260">SCMP</text>
                    <text x="380" y="260">packet</text>
                    <text x="208" y="276">exceeding</text>
                    <text x="268" y="276">1232</text>
                    <text x="316" y="276">bytes.</text>
                  </g>
                </svg><a href="#section-6.5.2-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-external-interface-down-for" class="selfRef">External Interface Down format</a>
            </figcaption></figure>
</div>
<span id="name-error-message-field-values-2"></span><table class="center" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-error-message-field-values-2" class="selfRef">Error Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">The 16-bit ISD identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">The 48-bit AS identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Interface ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the external link with connectivity issue.</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.5.2-3">A <strong>External Interface Down</strong> message <span class="bcp14">SHOULD</span> be originated by a router in response
to a packet that cannot be forwarded because the link to an external AS is broken.
The ISD and AS identifier are set to the ISD-AS of the originating router.
The Interface ID identifies the link of the originating AS that is down.
Recipients can use this information to route around broken data-plane links.<a href="#section-6.5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internal-connectivity-down">
<section id="section-6.5.3">
          <h4 id="name-internal-connectivity-down">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-internal-connectivity-down" class="section-name selfRef">Internal Connectivity Down</a>
          </h4>
<span id="name-internal-connectivity-down-"></span><div id="_figure-23">
<figure id="figure-19">
            <div id="section-6.5.3-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.5.3-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="528" viewBox="0 0 528 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,352" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,352" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 520,160" fill="none" stroke="black"></path>
                  <path d="M 8,224 L 520,224" fill="none" stroke="black"></path>
                  <path d="M 8,288 L 520,288" fill="none" stroke="black"></path>
                  <path d="M 8,352 L 520,352" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="136" y="116">ISD</text>
                    <text x="380" y="132">AS</text>
                    <text x="192" y="196">Ingress</text>
                    <text x="264" y="196">Interface</text>
                    <text x="316" y="196">ID</text>
                    <text x="188" y="260">Egress</text>
                    <text x="256" y="260">Interface</text>
                    <text x="308" y="260">ID</text>
                    <text x="148" y="308">As</text>
                    <text x="180" y="308">much</text>
                    <text x="212" y="308">of</text>
                    <text x="240" y="308">the</text>
                    <text x="296" y="308">offending</text>
                    <text x="364" y="308">packet</text>
                    <text x="132" y="324">as</text>
                    <text x="180" y="324">possible</text>
                    <text x="248" y="324">without</text>
                    <text x="296" y="324">the</text>
                    <text x="332" y="324">SCMP</text>
                    <text x="380" y="324">packet</text>
                    <text x="208" y="340">exceeding</text>
                    <text x="268" y="340">1232</text>
                    <text x="316" y="340">bytes.</text>
                  </g>
                </svg><a href="#section-6.5.3-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-internal-connectivity-down-" class="selfRef">Internal Connectivity Down format</a>
            </figcaption></figure>
</div>
<span id="name-error-message-field-values-3"></span><table class="center" id="table-9">
            <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-error-message-field-values-3" class="selfRef">Error Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">The 16-bit ISD identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">The 48-bit SCION AS identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ingress ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the ingress link.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Egress ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the egress link.</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.5.3-3">A <strong>Internal Connectivity Down</strong> message <span class="bcp14">SHOULD</span> be originated by a router in
response to a packet that cannot be forwarded inside the AS because the
connectivity between the ingress and egress routers is broken.
The ISD and AS identifier are set to the ISD-AS of the originating router.
The ingress Interface ID identifies the interface on which the packet enters the AS.
The egress Interface ID identifies the interface on which the packet is destined to
leave the AS, but the connection to which is broken.<a href="#section-6.5.3-3" class="pilcrow">¶</a></p>
<p id="section-6.5.3-4">Recipients can use this information to route around a broken data plane inside an
AS.<a href="#section-6.5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="scmp-information">
<section id="section-6.6">
        <h3 id="name-informational-messages">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-informational-messages" class="section-name selfRef">Informational Messages</a>
        </h3>
<div id="echo-request">
<section id="section-6.6.1">
          <h4 id="name-echo-request">
<a href="#section-6.6.1" class="section-number selfRef">6.6.1. </a><a href="#name-echo-request" class="section-name selfRef">Echo Request</a>
          </h4>
<span id="name-echo-request-format"></span><div id="_figure-24">
<figure id="figure-20">
            <div id="section-6.6.1-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.6.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="528" viewBox="0 0 528 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,160" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,160" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 520,160" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="140" y="116">Identifier</text>
                    <text x="364" y="116">Sequence</text>
                    <text x="428" y="116">Number</text>
                    <text x="196" y="148">Data</text>
                    <text x="224" y="148">(</text>
                    <text x="268" y="148">variable</text>
                    <text x="324" y="148">Len.</text>
                    <text x="352" y="148">)</text>
                  </g>
                </svg><a href="#section-6.6.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-echo-request-format" class="selfRef">Echo Request format</a>
            </figcaption></figure>
</div>
<span id="name-informational-message-field"></span><table class="center" id="table-10">
            <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-informational-message-field" class="selfRef">Informational Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">128</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit identifier to aid matching replies with requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit sequence number to aid matching replies with requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">Variable length of arbitrary data</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.1-3">Every node <span class="bcp14">SHOULD</span> implement a SCMP Echo responder function that receives Echo Requests and originates corresponding Echo replies.<a href="#section-6.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="echo-reply">
<section id="section-6.6.2">
          <h4 id="name-echo-reply">
<a href="#section-6.6.2" class="section-number selfRef">6.6.2. </a><a href="#name-echo-reply" class="section-name selfRef">Echo Reply</a>
          </h4>
<span id="name-echo-reply-format"></span><div id="_figure-25">
<figure id="figure-21">
            <div id="section-6.6.2-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.6.2-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="528" viewBox="0 0 528 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,160" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,128" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,160" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 520,160" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="140" y="116">Identifier</text>
                    <text x="364" y="116">Sequence</text>
                    <text x="428" y="116">Number</text>
                    <text x="196" y="148">Data</text>
                    <text x="224" y="148">(</text>
                    <text x="268" y="148">variable</text>
                    <text x="324" y="148">Len.</text>
                    <text x="352" y="148">)</text>
                  </g>
                </svg><a href="#section-6.6.2-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-echo-reply-format" class="selfRef">Echo Reply format</a>
            </figcaption></figure>
</div>
<span id="name-informational-message-field-"></span><table class="center" id="table-11">
            <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-informational-message-field-" class="selfRef">Informational Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">129</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier of the Echo Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">The sequence number of the Echo Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">The data of the Echo Request</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.2-3">Every node <span class="bcp14">SHOULD</span> implement a SCMP Echo responder function that receives Echo Requests and originates corresponding Echo replies.<a href="#section-6.6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.6.2-4">The data received in the SCMP Echo Request message <span class="bcp14">MUST</span> be returned entirely and unmodified in the SCMP Echo Reply message.<a href="#section-6.6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="traceroute-request">
<section id="section-6.6.3">
          <h4 id="name-traceroute-request">
<a href="#section-6.6.3" class="section-number selfRef">6.6.3. </a><a href="#name-traceroute-request" class="section-name selfRef">Traceroute Request</a>
          </h4>
<span id="name-traceroute-request-format"></span><div id="_figure-26">
<figure id="figure-22">
            <div id="section-6.6.3-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.6.3-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="528" viewBox="0 0 528 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,256" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,160" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,256" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 264,160" fill="none" stroke="black"></path>
                  <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
                  <path d="M 8,256 L 520,256" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="140" y="116">Identifier</text>
                    <text x="364" y="116">Sequence</text>
                    <text x="428" y="116">Number</text>
                    <text x="136" y="148">ISD</text>
                    <text x="388" y="164">AS</text>
                    <text x="256" y="228">Interface</text>
                    <text x="308" y="228">ID</text>
                  </g>
                </svg><a href="#section-6.6.3-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-traceroute-request-format" class="selfRef">Traceroute Request format</a>
            </figcaption></figure>
</div>
<p id="section-6.6.3-2">Given a SCION path constituted of hop fields, traceroute allows to identify the corresponding on-path ISD-ASes.<a href="#section-6.6.3-2" class="pilcrow">¶</a></p>
<span id="name-informational-message-field-v"></span><table class="center" id="table-12">
            <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-informational-message-field-v" class="selfRef">Informational Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">130</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit identifier to aid matching replies with requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">A 16-bit sequence number to aid matching replies with request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">Place holder set to zero by SCMP sender</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">Place holder set to zero by SCMP sender</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Interface ID</td>
                <td class="text-left" rowspan="1" colspan="1">Place holder set to zero by SCMP sender</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.3-4">A border router is alerted of a Traceroute Request message through the Ingress or Egress Router Alert flag set to 1 in the hop field that describes the traversal of that router in a packet's path (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "SCION Header Specification"). When such a packet is received, the border router <span class="bcp14">SHOULD</span> reply with a <span><a href="#traceroute-reply" class="internal xref">Traceroute Reply message</a> (<a href="#traceroute-reply" class="auto internal xref">Section 6.6.4</a>)</span>.<a href="#section-6.6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="traceroute-reply">
<section id="section-6.6.4">
          <h4 id="name-traceroute-reply">
<a href="#section-6.6.4" class="section-number selfRef">6.6.4. </a><a href="#name-traceroute-reply" class="section-name selfRef">Traceroute Reply</a>
          </h4>
<span id="name-traceroute-reply-format"></span><div id="_figure-27">
<figure id="figure-23">
            <div id="section-6.6.4-1.1">
              <div class="alignLeft art-svg artwork" id="section-6.6.4-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="528" viewBox="0 0 528 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,64 L 8,256" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,160" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,256" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
                  <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                  <path d="M 8,160 L 264,160" fill="none" stroke="black"></path>
                  <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
                  <path d="M 8,256 L 520,256" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="16" y="36">0</text>
                    <text x="176" y="36">1</text>
                    <text x="336" y="36">2</text>
                    <text x="496" y="36">3</text>
                    <text x="16" y="52">0</text>
                    <text x="32" y="52">1</text>
                    <text x="48" y="52">2</text>
                    <text x="64" y="52">3</text>
                    <text x="80" y="52">4</text>
                    <text x="96" y="52">5</text>
                    <text x="112" y="52">6</text>
                    <text x="128" y="52">7</text>
                    <text x="144" y="52">8</text>
                    <text x="160" y="52">9</text>
                    <text x="176" y="52">0</text>
                    <text x="192" y="52">1</text>
                    <text x="208" y="52">2</text>
                    <text x="224" y="52">3</text>
                    <text x="240" y="52">4</text>
                    <text x="256" y="52">5</text>
                    <text x="272" y="52">6</text>
                    <text x="288" y="52">7</text>
                    <text x="304" y="52">8</text>
                    <text x="320" y="52">9</text>
                    <text x="336" y="52">0</text>
                    <text x="352" y="52">1</text>
                    <text x="368" y="52">2</text>
                    <text x="384" y="52">3</text>
                    <text x="400" y="52">4</text>
                    <text x="416" y="52">5</text>
                    <text x="432" y="52">6</text>
                    <text x="448" y="52">7</text>
                    <text x="464" y="52">8</text>
                    <text x="480" y="52">9</text>
                    <text x="496" y="52">0</text>
                    <text x="512" y="52">1</text>
                    <text x="68" y="84">Type</text>
                    <text x="196" y="84">Code</text>
                    <text x="380" y="84">Checksum</text>
                    <text x="140" y="116">Identifier</text>
                    <text x="364" y="116">Sequence</text>
                    <text x="428" y="116">Number</text>
                    <text x="136" y="148">ISD</text>
                    <text x="388" y="164">AS</text>
                    <text x="256" y="228">Interface</text>
                    <text x="308" y="228">ID</text>
                  </g>
                </svg><a href="#section-6.6.4-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-traceroute-reply-format" class="selfRef">Traceroute Reply format</a>
            </figcaption></figure>
</div>
<span id="name-informational-message-field-va"></span><table class="center" id="table-13">
            <caption>
<a href="#table-13" class="selfRef">Table 13</a>:
<a href="#name-informational-message-field-va" class="selfRef">Informational Message field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Type</td>
                <td class="text-left" rowspan="1" colspan="1">131</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Code</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Identifier</td>
                <td class="text-left" rowspan="1" colspan="1">The identifier set in the Traceroute Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sequence Nr.</td>
                <td class="text-left" rowspan="1" colspan="1">The sequence number of the Tracroute Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ISD</td>
                <td class="text-left" rowspan="1" colspan="1">The 16-bit ISD identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AS</td>
                <td class="text-left" rowspan="1" colspan="1">The 48-bit AS identifier of the SCMP originator</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Interface ID</td>
                <td class="text-left" rowspan="1" colspan="1">The interface ID of the SCMP originating router</td>
              </tr>
            </tbody>
          </table>
<p id="section-6.6.4-3">The identifier is set to the identifier value from the <span><a href="#traceroute-request" class="internal xref">Traceroute Request message</a> (<a href="#traceroute-request" class="auto internal xref">Section 6.6.3</a>)</span>. The ISD and AS identifiers are set to the ISD-AS of the originating border router.<a href="#section-6.6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deployment-considerations">
<section id="section-7">
      <h2 id="name-deployment-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations</a>
      </h2>
<div id="destination-mapping">
<section id="section-7.1">
        <h3 id="name-destination-mapping">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-destination-mapping" class="section-name selfRef">Destination Mapping</a>
        </h3>
<p id="section-7.1-1">The mechanism by which endpoints determine the destination ISD-AS corresponding to a given destination address is outside the scope of this document. One option, still experimental in existing deployments, is that SCION-aware endpoints may resolve destination SCION addresses using a naming system (e.g., DNS).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">SCION-unaware endpoints may interface with a SCION network through a SCION IP Gateway (SIG), which tunnels IP traffic over SCION. In such cases, the source SIG is responsible for mapping destination IPs to the appropriate destination ISD-AS and gateway. More information can be found at <span>[<a href="#SIG" class="cite xref">SIG</a>]</span>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="monitoring-considerations">
<section id="section-7.2">
        <h3 id="name-monitoring-considerations">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-monitoring-considerations" class="section-name selfRef">Monitoring Considerations</a>
        </h3>
<p id="section-7.2-1">In order to maintain service availability, an AS operator <span class="bcp14">SHOULD</span> monitor the following aspects when deploying the SCION control plane:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">For routers (to enable correlation with link states): state of configured links (core, child, parent).<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">For any Control Service:<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.2.2.1">
                <p id="section-7.2-2.2.2.1.1">Fraction of path lookups served successfully (see <a href="#lookup" class="auto internal xref">Section 4</a>).<a href="#section-7.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-2.2.2.2">
                <p id="section-7.2-2.2.2.2.1">Time synchronization offset with other ASes (see <a href="#clock-inaccuracy" class="auto internal xref">Section 7.3</a>).<a href="#section-7.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-2.2.2.3">
                <p id="section-7.2-2.2.2.3.1">Fraction of ASes found in non-expired segments for which a non-expired certificate exists.<a href="#section-7.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.2-2.3">
            <p id="section-7.2-2.3.1">For a core AS:<a href="#section-7.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.3.2.1">
                <p id="section-7.2-2.3.2.1.1">Fraction of core ASes (preferably only those to which the link is up) that can be found in non-expired core segments.<a href="#section-7.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-2.3.2.2">
                <p id="section-7.2-2.3.2.2.1">Fraction of ASes, core or children, (preferably only those to which the link is up) to where a beacon was originated during the last propagation interval.<a href="#section-7.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-2.3.2.3">
                <p id="section-7.2-2.3.2.3.1">Fraction of freshly propagated beacons for which at least one corresponding down segment has been registered (see <a href="#path-segment-reg" class="auto internal xref">Section 3</a>).<a href="#section-7.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.2-2.4">
            <p id="section-7.2-2.4.1">For a non-core AS:<a href="#section-7.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.4.2.1">
                <p id="section-7.2-2.4.2.1.1">Number of up segments available (may be just 0/non-0) younger than the propagation interval (or some multiple thereof).<a href="#section-7.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-2.4.2.2">
                <p id="section-7.2-2.4.2.2.1">Fraction of up segments that were successfully registered as down segments (see <a href="#path-segment-reg" class="auto internal xref">Section 3</a>).<a href="#section-7.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2-2.4.2.3">
                <p id="section-7.2-2.4.2.3.1">Fraction of children ASes (preferably only those to which the link is up) to where a beacon was propagated during the last propagation interval.<a href="#section-7.2-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="clock-inaccuracy">
<section id="section-7.3">
        <h3 id="name-effects-of-clock-inaccuracy">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-effects-of-clock-inaccuracy" class="section-name selfRef">Effects of Clock Inaccuracy</a>
        </h3>
<p id="section-7.3-1">A PCB originated by a given core AS Control Service is validated by all the Control Services that receive it. All have different clocks and their differences affect the validation process:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">A fast clock at origination or a slow clock at reception will yield a lengthened expiration time for hops, and possibly an origination time in the future.<a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">A slow clock at origination or a fast clock at reception will yield a shortened expiration time for hops, and possibly an expiration time in the past.<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-3">This bias comes in addition to a structural delay: PCBs are propagated at a configurable interval, typically around one minute. As a result of this and the manner in which they are iteratively constructed, PCBs with N hops may be validated up to N intervals (so maximally N minutes) after origination which creates a constraint on the expiration of hops. Hops of the minimal expiration time (337.5 seconds - see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>) would make any PCB describing a path longer than 5 hops expire. For this reason it is unadvisable to create hops with a short expiration time - i.e., they <span class="bcp14">SHOULD</span> be around 6 hours.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">The Control Service and its clients authenticate each other in accordance with their respective AS's certificate. Path segments are authenticated based on the certificates of the ASes that they refer to. The <span class="bcp14">RECOMMENDED</span> expiration time of a SCION AS certificate is between 3h and 3 days, although some deployments use up to 5 days. In comparison to these time scales, clock offsets in the order of minutes are immaterial.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">Each administrator of a SCION Control Service is responsible for maintaining coarse time synchronization with SCION routers within the AS, neighbor ASes Control Services, and endpoints within the AS. In typical deployments, clock deviations on the order of several minutes are acceptable.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">The specific methods used to achieve this synchronization are outside the scope of this document. Security considerations on time synchronization are discussed in <a href="#time-security" class="auto internal xref">Section 8.4</a>.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scalability">
<section id="section-7.4">
        <h3 id="name-path-discovery-time-and-sca">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-path-discovery-time-and-sca" class="section-name selfRef">Path Discovery Time and Scalability</a>
        </h3>
<p id="section-7.4-1">The path discovery mechanism balances the number of discovered paths and the time it takes to discover them versus resource overhead of the discovery.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">The resource costs for path discovery are as follows:<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-3.1">
            <p id="section-7.4-3.1.1">Communication overhead is transmitting the PCBs and occasionally obtaining the required PKI material.<a href="#section-7.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-3.2">
            <p id="section-7.4-3.2.1">Processing overhead is validating the signatures of the AS entries, signing new AS entries, and to a lesser extent, evaluating the PCB selection policies.<a href="#section-7.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-3.3">
            <p id="section-7.4-3.3.1">Storage overhead is both the temporary storage of PCBs before the next propagation interval, and the storage of complete discovered path segments.<a href="#section-7.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-4">All of these are dependent on the number and length of the discovered path segments, i.e., the total number of AS entries of the discovered path segments. These in turn depend on the configured best PCBs set size (<a href="#propagation-interval-size" class="auto internal xref">Section 2.3.4</a>).<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">Relevant metrics for scalability and speed of path discovery are the time until all discoverable path segments have been discovered after a network bootstrap, and the time until a new link is usable. In general, the time until a specific PCB is built depends on its length, the propagation interval, and whether on-path ASes use "fast recovery" (see <a href="#propagation-interval-size" class="auto internal xref">Section 2.3.4</a>).<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">At each AS, the Control Service will process and propagate the PCB at the subsequent propagation event. As propagation events are not synchronized between different ASes, a PCB arrives at a random point in time during the interval and may be buffered before potentially being propagated. With a propagation interval T at each AS, the mean time until the PCB is propagated in one AS therefore is T / 2 and the mean total time for the propagation steps of a PCB of length L is at worst L * T / 2 (with a variance of L * T^2 / 12).<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<p id="section-7.4-7">Note that link removal is not part of path discovery in SCION. For scheduled removal of links, operators let path segments expire. On link failures, endpoints route around the failed link by switching to different paths in the data plane (see <span>[<a href="#I-D.dekater-scion-dataplane" class="cite xref">I-D.dekater-scion-dataplane</a>]</span> section "Handling Link Failures").<a href="#section-7.4-7" class="pilcrow">¶</a></p>
<p id="section-7.4-8">To achieve scalability, SCION ASes are partitioned into ISDs and in an ideal topology the inter-ISD core network should be kept to a moderate size. More specific observations require a distinction between intra-ISD and core beaconing.<a href="#section-7.4-8" class="pilcrow">¶</a></p>
<div id="intra-isd-beaconing">
<section id="section-7.4.1">
          <h4 id="name-intra-isd-beaconing">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-intra-isd-beaconing" class="section-name selfRef">Intra-ISD Beaconing</a>
          </h4>
<p id="section-7.4.1-1">In the intra-ISD beaconing, PCBs are propagated top down along parent-child links from core to downstream ASes. Each AS discovers path segments from itself to the core ASes of its ISD.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<p id="section-7.4.1-2">This produces an acyclic graph which is typically narrow at the top, widens towards downstream ASes, and is relatively shallow. Intermediate provider ASes will typically have a large number of children whilst only having a small number of parents. Therefore the chain of intermediate providers from a downstream AS to a core AS is typically not long (e.g., local, regional, national provider, then core).<a href="#section-7.4.1-2" class="pilcrow">¶</a></p>
<p id="section-7.4.1-3">Each AS potentially receives PCBs for all down path segments from the core to itself. While the number of distinct provider chains to the core is typically moderate, the multiplicity of links between provider ASes has multiplicative effect on the number of PCBs. Once this number grows above the maximum recommended best PCB set size of 50, ASes <span class="bcp14">SHOULD</span> trim the set of PCBs propagated.<a href="#section-7.4.1-3" class="pilcrow">¶</a></p>
<p id="section-7.4.1-4">Ultimately, the number of PCBs received by an AS per propagation interval remains bounded by 50 for each parent link of an AS, and at most 50 PCBs per child link are propagated. The length of these PCBs and thus the number of AS entries to be processed and stored, is expected to be moderate and not grow considerably with network size. The total resource overhead for beacon propagation is easily manageable even for highly connected ASes.<a href="#section-7.4.1-4" class="pilcrow">¶</a></p>
<p id="section-7.4.1-5">To illustrate this, an AS with a rather large number of 100 parent links receives at most 5,000 PCBs during a propagation interval. Assuming a generous average length of 10 AS entries for these PCBs, this corresponds to 50,000 AS entries.<a href="#section-7.4.1-5" class="pilcrow">¶</a></p>
<p id="section-7.4.1-6">Due to the variable length fields in AS entries, the sizes for storage and transmission cannot be predicted exactly, but assume an average of 250 bytes per AS entry. At the shortest recommended propagation interval of 5 seconds, this corresponds to an average bandwidth of around 2.5 MB/s and the processing of 10,000 signature verifications per second.<a href="#section-7.4.1-6" class="pilcrow">¶</a></p>
<p id="section-7.4.1-7">If the same AS has 1,000 child links, the propagation of the beacons will require signing one new AS entry for each of the propagated PCBs for each link (at most 50 per link) - i.e., at most 50,000 signatures per propagation event. The total bandwidth for the propagation of the PCBs for all 1,000 child links would be roughly around 25 MB/s which is manageable with even modest consumer hardware.<a href="#section-7.4.1-7" class="pilcrow">¶</a></p>
<p id="section-7.4.1-8">On a network bootstrap, path segments to each AS are discovered within a number of propagation steps proportional to the longest path. With a 5 second propagation interval and a generous longest path of length 10, all path segments are discovered after 25 seconds on average. When all ASes start propagation just after they've received the first PCBs from any of their upstreams (see "fast recovery" in <a href="#propagation-interval-size" class="auto internal xref">Section 2.3.4</a>), the construction of a first path to connect each AS to the ISD core is accelerated.<a href="#section-7.4.1-8" class="pilcrow">¶</a></p>
<p id="section-7.4.1-9">When a new parent-child link is added to the network, the parent AS will propagate the available PCBs in the next propagation event. If the AS on the child side of the new link has no children of its own, path discovery is complete after at most one propagation interval. Otherwise, child ASes at distance D below the new link, learn of the new link after at worst D further propagation intervals.<a href="#section-7.4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="core-beaconing">
<section id="section-7.4.2">
          <h4 id="name-core-beaconing">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-core-beaconing" class="section-name selfRef">Core Beaconing</a>
          </h4>
<p id="section-7.4.2-1">In core beaconing (typically inter-ISD), PCBs are propagated omnidirectionally along core links. Each AS discovers path segments from itself to any other core AS.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<p id="section-7.4.2-2">The number of distinct paths through the core network is typically very large. To keep the overhead manageable, at most 5 path segments to every destination AS are discovered and the propagation frequency is slower than in the intra-ISD beaconing (at least 60 seconds between propagation events).<a href="#section-7.4.2-2" class="pilcrow">¶</a></p>
<p id="section-7.4.2-3">Without making strong assumptions on the topology of the core network, it can be assumed that shortest paths through real world networks are relatively short - e.g., the Barabási-Albert random graph model predicts a diameter of log(N)/log(log(N)) for a network with N nodes <span>[<a href="#BollRio-2000" class="cite xref">BollRio-2000</a>]</span> and the average distance scales in the same way. Whilst it cannot be assumed that the selected PCBs are strictly the shortest paths through the network, they are likely to be not very much longer than the shortest paths either.<a href="#section-7.4.2-3" class="pilcrow">¶</a></p>
<p id="section-7.4.2-4">With N the number of participating core ASes, an AS receives up to 5 * N PCBs per propagation interval per core link interface. For highly connected ASes, the number of PCBs received thus becomes rather large and in a network of 1,000 ASes, an AS with 300 core links receives up to 1.5 million PCBs per propagation interval.<a href="#section-7.4.2-4" class="pilcrow">¶</a></p>
<p id="section-7.4.2-5">Assuming an average PCB length of 6 and the shortest propagation interval of 60 seconds, this corresponds to roughly 150,000 signature validations per second or roughly 38 MB/s. For much larger, more highly connected ASes, the path discovery tasks of the Control Service can be distributed over many instances in order to increase the PCB throughput.<a href="#section-7.4.2-5" class="pilcrow">¶</a></p>
<p id="section-7.4.2-6">On a network bootstrap, full connectivity is obtained after a number of propagation steps corresponding to the diameter of the network. Assuming a network diameter of 6, this corresponds to roughly 3 minutes on average. When a new link is added to the network, it will be available to connect two ASes at distances D1 and D2 from the link respectively, at worst after a mean time (D1+D2)*T/2.<a href="#section-7.4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">As described previously, the goal of SCION’s beaconing process in the control plane is to securely discover and disseminate paths between any two ASes. This section describes security considerations for SCION's Control Plane that focuses on <em>inter</em>-domain routing. SCION does not provide intra-domain routing, nor does it provide end-to-end payload encryption so these topics lie outside the scope of this section.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">This section discusses three kinds of threats to the control plane:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8-3">
<li id="section-8-3.1">
          <p id="section-8-3.1.1">When an adversary controls one or all core ASes of an ISD and tries to manipulate the beaconing process from the top down (see <a href="#topdown-manipulate" class="auto internal xref">Section 8.2</a>).<a href="#section-8-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-8-3.2">
          <p id="section-8-3.2.1">When "ordinary" (non-core) adversaries try to manipulate the beaconing process (see <a href="#manipulate-beaconing" class="auto internal xref">Section 8.3</a>).<a href="#section-8-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-8-3.3">
          <p id="section-8-3.3.1">Denial of Services (DoS) attacks where attackers overload different parts of the infrastructure (see <a href="#dos-cp" class="auto internal xref">Section 8.5</a>).<a href="#section-8-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="security-properties">
<section id="section-8.1">
        <h3 id="name-security-properties">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-security-properties" class="section-name selfRef">Security Properties</a>
        </h3>
<p id="section-8.1-1">The SCION control plane provides various security properties, as discussed below. Here a SCION AS is described as 'honest' if its private keys are unknown to the attacker and it correctly performs operations in accordance with this specification (e.g., uses a unique interface identifier for each link). An honest path is one that only traverses honest ASes. An honest segment is one created by an honest AS.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Security properties are:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">
            <p id="section-8.1-3.1.1">Connectivity - For every pair of honest ASes X and Y, X will eventually register enough segments to build at least one path (of any length) leading to Y.<a href="#section-8.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.2">
            <p id="section-8.1-3.2.1">Forwarding Path Consistency - For every honest path segment registered in any AS<a href="#section-8.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.2.2.1">
                <p id="section-8.1-3.2.2.1.1">its sequence of AS entries corresponds to a continuous SCION forwarding path in the network of inter-domain links<a href="#section-8.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.1-3.2.2.2">
                <p id="section-8.1-3.2.2.2.1">the inter-domain network topology remains unchanged since the segment was first generated.<a href="#section-8.1-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.1-3.3">
            <p id="section-8.1-3.3.1">Loop Freedom - For every honest path segment registered in any AS, its sequence of AS entries contains no duplicates, including current and next ISD-AS and Interface IDs.<a href="#section-8.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.4">
            <p id="section-8.1-3.4.1">Path Authorization - For every honest path segment registered in any AS and any AS X appearing on that segment (except for the previous one), AS X propagated a PCB corresponding to the segment portion ending in its own entry to its successor AS on the segment.<a href="#section-8.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-4">To ensure that the properties hold across the overall SCION network, these are the prerequisites to follow:
  - all core ASes <span class="bcp14">MUST</span> be able to reach each other with some sequence of core links;
  - and all non-core ASes <span class="bcp14">MUST</span> have at least one path up to a core AS.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">Furthermore, to ensure that the properties hold within a single ISD, all core ASes of the ISD <span class="bcp14">MUST</span> be able to reach each other without leaving the ISD - i.e, for every pair of cores in an ISD there is a sequence of SCION links that only traverse the ISD members.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">A core AS may reach other core ASes in the same ISD via other ISDs, depending on the ISD's policies.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="topdown-manipulate">
<section id="section-8.2">
        <h3 id="name-manipulation-of-the-beaconi">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-manipulation-of-the-beaconi" class="section-name selfRef">Manipulation of the Beaconing Process by a Core Adversary</a>
        </h3>
<p id="section-8.2-1">The first risk to the beaconing process comes from an adversary controlling one or more core ASes in an ISD. Non-core ASes depend on core ASes for beaconing. If an adversary compromises all upstream core ASes of a target AS and suppresses PCB propagation, the discovery of new paths for will halt. Although the downstream AS will no longer receive new PCBs, previously discovered and still valid paths remain usable for data plane forwarding until they expire. This is an unlikely attack scenario, as it would require compromise of all core ASes of a given downstream AS to be effective.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manipulate-beaconing">
<section id="section-8.3">
        <h3 id="name-manipulation-of-the-beaconin">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-manipulation-of-the-beaconin" class="section-name selfRef">Manipulation of the Beaconing Process by a Non-Core Adversary</a>
        </h3>
<p id="section-8.3-1">This section examines several possible approaches that could be taken by an "ordinary" non-core adversary to manipulate the beaconing process in the Control Plane. For each case it shows to what extent SCION's design can prevent the corresponding attack or help mitigate it.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div id="path-hijack">
<section id="section-8.3.1">
          <h4 id="name-path-hijacking-through-inte">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-path-hijacking-through-inte" class="section-name selfRef">Path Hijacking through Interposition</a>
          </h4>
<p id="section-8.3.1-1">A malicious AS M might try to manipulate the beaconing process between two neighbor ASes A and B, with the goal to hijack traffic to flow via AS M. If AS M can interpose itself on the path between A and B, then it could attempt several potential attacks:<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.1-2.1">
              <p id="section-8.3.1-2.1.1">The adversary AS M could intercept and disseminate a PCB on its way from A to the neighboring AS B, and inject its own AS entry into the PCB toward downstream ASes.<a href="#section-8.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-2.2">
              <p id="section-8.3.1-2.2.1">The adversary could modify the Hop Fields of an already existing path in order to insert its own AS in the path.<a href="#section-8.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-2.3">
              <p id="section-8.3.1-2.3.1">The adversary could fully block traffic between AS A and AS B in order to force traffic redirection through an alternate path that includes its own AS.<a href="#section-8.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.3.1-3">The first type of attack is detectable and blocked by downstream ASes (e.g., AS B) because a PCB disseminated by AS A towards AS B contains the "Next ISD AS" field in the entry of AS A, pointing to AS B and protected by A's signature. If AS M manipulates the PCB while in flight from AS A to AS B, then verification of the manipulated inbound PCBs will fail at AS B, as the adversary's PCBs cannot contain AS A's correct signature (see <a href="#reception" class="auto internal xref">Section 2.3.1</a>).<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<p id="section-8.3.1-4">The second type of attack is made impossible by the Hop Field's MAC which protects the Hop Field's integrity and chains it with the previous Hop Fields on the path.<a href="#section-8.3.1-4" class="pilcrow">¶</a></p>
<p id="section-8.3.1-5">The third type of attack generally cannot be prevented. However the alternate path would be immediately visible to endpoints as traffic <span class="bcp14">MUST</span> include Hop Fields from AS M.<a href="#section-8.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fake-ases">
<section id="section-8.3.2">
          <h4 id="name-creation-of-spurious-ases-a">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-creation-of-spurious-ases-a" class="section-name selfRef">Creation of Spurious ASes and ISDs</a>
          </h4>
<p id="section-8.3.2-1">An alternative scenario is when an adversary tries to introduce and spoof a non-existent AS. This would enable the adversary to send traffic with the spoofed AS as a source, allowing the adversary to complicate the detection of its attack and to plausibly deny the misbehavior.<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2-2">However, spoofing a new AS requires a registration of that AS with the ISD core to obtain a valid AS certificate, otherwise the adversary cannot construct valid PCBs. As this registration should include a thorough check and authentication by a CA, this cannot be done stealthily which defeats the original purpose.<a href="#section-8.3.2-2" class="pilcrow">¶</a></p>
<p id="section-8.3.2-3">Similarly to creating a fake AS, an adversary could try to introduce a new malicious ISD. This involves the generation of its own TRC, finding core ASes to peer with, and convincing other ISDs of its legitimacy to accept the new TRC. Although this setup is not entirely impossible, it requires substantial time and effort and may need the involvement of more than one malicious entity. Here the "costs" of setting up the fake ISD may outweigh the benefits.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="peer-link-misuse">
<section id="section-8.3.3">
          <h4 id="name-peering-link-misuse">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-peering-link-misuse" class="section-name selfRef">Peering Link Misuse</a>
          </h4>
<p id="section-8.3.3-1">The misuse of a peering link by an adversary represents another type of attack. Consider the case where AS A wants to share its peering link only with one of its downstream neighbors AS B, and therefore selectively includes the peering link only in PCBs sent to AS B. An adversary may now try to gain access to this peering link by prepending the relevant PCBs to its own path. For this, the adversary needs to be able to (1) eavesdrop on the link from AS A to AS B, and (2) obtain the necessary Hop Fields by querying a Control Service and extracting the Hop Fields from registered paths.<a href="#section-8.3.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3.3-2">Even if an adversary succeeds in misusing a peering link as described above, SCION is able to mitigate this kind of attack. Each AS includes an egress interface as well as specific “next hop” information to the PCB before disseminating it further downstream. If a malicious entity tries to misuse a stolen PCB by adding it to its own segments, verification will fail upstream as the egress interface mismatches. Therefore, the peering link can only be used by the intended AS.<a href="#section-8.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manipulate-selection">
<section id="section-8.3.4">
          <h4 id="name-manipulation-of-the-path-se">
<a href="#section-8.3.4" class="section-number selfRef">8.3.4. </a><a href="#name-manipulation-of-the-path-se" class="section-name selfRef">Manipulation of the Path-Selection Process</a>
          </h4>
<p id="section-8.3.4-1">SCION endpoints select inter-domain forwarding paths and this section discusses some mechanisms by which an adversary can attempt to trick endpoints downstream (in the direction of beaconing) into choosing non-optimal paths. The goal of such attacks is to make paths that are controlled by the adversary more attractive than other available paths.<a href="#section-8.3.4-1" class="pilcrow">¶</a></p>
<p id="section-8.3.4-2">In SCION, overall path selection is the result of three steps. Firstly, each AS selects which PCBs are further forwarded to its neighbors. Secondly, each AS chooses the paths it wants to register at the local Control Service (as up segments) and at the core Control Service (as down segments). Thirdly, the endpoint performs path selection among all available paths resulting from a path lookup process.<a href="#section-8.3.4-2" class="pilcrow">¶</a></p>
<p id="section-8.3.4-3">These attacks are only successful if the adversary is located within the same ISD and upstream relative to the victim AS. It is not possible to attract traffic away from the core as traffic travels upstream towards the core. Furthermore, the attack may either be discovered downstream (e.g., by seeing large numbers of paths becoming available), or during path registrations. After detection, non-core ASes will be able to identify paths traversing the adversary AS and avoid these paths.<a href="#section-8.3.4-3" class="pilcrow">¶</a></p>
<p id="section-8.3.4-4"><strong>Announcing Large Numbers of Path Segments</strong> <br>
This attack is possible if the adversary controls at least two ASes. The adversary can create a large number of links between the ASes under its control which do not necessarily correspond to physical links. This allows the adversary to multiply the number of PCBs forwarded to its downstream neighbor ASes and in turn increases the chance that one or several of these forwarded PCBs are selected by the downstream ASes.<a href="#section-8.3.4-4" class="pilcrow">¶</a></p>
<p id="section-8.3.4-5">In general, the number of PCBs that an adversary can announce this way scales exponentially with the number of consecutive ASes the adversary controls. However, this also decreases their chance of being chosen by a downstream AS for PCB dissemination or by an endpoint for path construction as these relatively long paths have to compete with other shorter paths. Furthermore, both endpoints and downstream ASes can detect poorer quality paths in the data plane and switch to better paths.<a href="#section-8.3.4-5" class="pilcrow">¶</a></p>
<p id="section-8.3.4-6"><strong>Wormhole Attack</strong> <br>
A malicious AS M1 can send a PCB not only to their downstream neighbor ASes, but also out-of-band to another non-neighbor colluding malicious AS M2. This creates new segments to M2 and M2's downstream neighbor ASes, simulating a link between M1 and M2 which may not correspond to an actual link in the network topology.<a href="#section-8.3.4-6" class="pilcrow">¶</a></p>
<p id="section-8.3.4-7">Similarly, two colluding ASes could announce a path through a fake peering link between them, even if in different ISDs, thus offering short paths to many destination ASes. Downstream ASes might have a policy of preferring paths with many peering links and thus are more likely to disseminate PCBs from the adversary. Endpoints are also more likely to choose short paths that make use of peering links.<a href="#section-8.3.4-7" class="pilcrow">¶</a></p>
<p id="section-8.3.4-8">In the data plane, whenever the adversary receives a packet containing a fake peering link, it can transparently exchange the fake peering Hop Fields with valid Hop Fields to the colluding AS. To avoid detection of the path alteration by the receiver, the colluding AS can replace the added Hop Fields with the fake peering link Hop Fields the sender inserted.<a href="#section-8.3.4-8" class="pilcrow">¶</a></p>
<p id="section-8.3.4-9">To defend against this attack, methods to detect the wormhole attack are needed. Per link or path latency measurements can help reveal the wormhole and render the fake peering link suspicious or unattractive. Without specific detection mechanisms these so-called wormhole attacks are unavoidable in routing.<a href="#section-8.3.4-9" class="pilcrow">¶</a></p>
<p id="section-8.3.4-10"><strong>Rogue SCMP Error Messages</strong>  <br>
SCMP External Interface Down (<a href="#external-interface-down" class="auto internal xref">Section 6.5.2</a>) and Internal Connectivity Down (<a href="#internal-connectivity-down" class="auto internal xref">Section 6.5.3</a>) can potentially be abused by an attacker to disrupt forwarding of information and/or force the traffic through a different paths. Endpoints should therefore consider them weak hints and apply heuristics to detect fraudulent SCMP messages (e.g., by actively probing whether the affected path is actually down).<a href="#section-8.3.4-10" class="pilcrow">¶</a></p>
<p id="section-8.3.4-11">Note that this would be mitigated through authentication of SCMP messages. Authentication is not specified here since it is currently still experimental.<a href="#section-8.3.4-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="time-security">
<section id="section-8.4">
        <h3 id="name-attacks-on-time-sources">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-attacks-on-time-sources" class="section-name selfRef">Attacks on time sources</a>
        </h3>
<p id="section-8.4-1">Operators should maintain coarse time synchronization among Control Service instances and other system components, as discussed in <a href="#clock-inaccuracy" class="auto internal xref">Section 7.3</a>. An adversary that significantly alters the system time of a component can disrupt SCION operations:<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-2.1">
            <p id="section-8.4-2.1.1">A Control Service instance: its beaconing process may halt as it cannot verify the validity of received PCBs (see <a href="#pcb-validity" class="auto internal xref">Section 2.2.4</a>) or correctly add timestamps to propagated PCBs (see <a href="#pcb-appending" class="auto internal xref">Section 2.1.2</a>).<a href="#section-8.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-2.2">
            <p id="section-8.4-2.2.1">An endpoint: it may fail to verify path segments during path lookup (see <a href="#lookup-process" class="auto internal xref">Section 4.1</a>).<a href="#section-8.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-2.3">
            <p id="section-8.4-2.3.1">A router: packets may be dropped ahead of the Control Service intended expiration time (see <a href="#hopfield" class="auto internal xref">Section 2.2.2.5</a>).<a href="#section-8.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-2.4">
            <p id="section-8.4-2.4.1">A Certificate Authority (see <span>[<a href="#I-D.dekater-scion-pki" class="cite xref">I-D.dekater-scion-pki</a>]</span>): it may issue AS certificates with incorrect validity periods, causing them to be rejected by verifiers.<a href="#section-8.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.4-3">It is therefore recommended to leverage secure time synchronization mechanisms, such as NTS <span>[<a href="#RFC8915" class="cite xref">RFC8915</a>]</span>, <span>[<a href="#BCP223" class="cite xref">BCP223</a>]</span>, or Khronos <span>[<a href="#RFC9523" class="cite xref">RFC9523</a>]</span>, or to leverage multiple diverse time sources (e.g., GNSS and network-based).<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dos-cp">
<section id="section-8.5">
        <h3 id="name-denial-of-service-attacks">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-denial-of-service-attacks" class="section-name selfRef">Denial of Service Attacks</a>
        </h3>
<p id="section-8.5-1">The beaconing process in the SCION Control Plane relies on control plane communication. ASes exchange control plane messages within each other when propagating PCBs to downstream neighbors, when registering PCBs as path segments, or during core path lookup. Volumetric DoS attacks, where attackers overload a link may make it difficult to exchange these messages.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">SCION limits the impact of such attacks which aim to exhaust network bandwidth on links as ASes can switch to alternative paths that do not contain the congested links. Reflection-based attacks are also prevented as response packets are returned on the same path to the actual sender.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">Other mechanisms are required to avoid transport protocol attacks where the attacker tries to exhaust the resources on a target server, such as for the Control Services, by opening many connections to this. The means to mitigate these kind of DoS attacks are basically the same as for the current Internet - e.g., filtering, geo-blocking or using cookies.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
<p id="section-8.5-4">Thanks to its path awareness, SCION enables more fine-grained filtering mechanisms based on certain path properties. For example, control plane RPC methods that are available to endpoints within an AS are strictly separate from methods available to endpoints from other ASes. Specifically, expensive recursive path segment and trust material lookups are thus shielded from abuse by unauthorized entities.<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<p id="section-8.5-5">For RPC methods exposed to other ASes, the Control Service implementation minimizes its attack surface by rejecting illegitimate callers based on ISD/AS, path type and length and any other available data points as soon as possible, i.e., immediately after determining the request type. For example:<a href="#section-8.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-6.1">
            <p id="section-8.5-6.1.1"><code>SegmentCreationService.Beacon</code> can only be called by direct neighbors and thus calls from peers with a path length greater than one can immediately be discarded.<a href="#section-8.5-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-6.2">
            <p id="section-8.5-6.2.1"><code>SegmentRegistrationService.SegmentsRegistration</code> can only be called from within the same ISD, thus the source address <span class="bcp14">MUST</span> match the local ISD and the number of path segments <span class="bcp14">MUST</span> be 1.<a href="#section-8.5-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.5-7">A combination of the mechanism above is used to prevent flooding attacks on the Control Service. In addition, operators <span class="bcp14">SHOULD</span> deploy the Control Service in a distributed and replicated manner so that requests can be balanced and a single instance failure does not result in a complete failure of the control plane of a SCION AS.<a href="#section-8.5-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The ISD and SCION AS number are SCION-specific numbers. They are allocated by the SCION Association (see <span>[<a href="#ISD-AS-assignments" class="cite xref">ISD-AS-assignments</a>]</span>).<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="Connect">[Connect]</dt>
        <dd>
<span class="refTitle">"Connect Protocol Reference"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://connectrpc.com/docs/protocol/">https://connectrpc.com/docs/protocol/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="gRPC">[gRPC]</dt>
        <dd>
<span class="refTitle">"gRPC, an open-source universal RPC framework"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://grpc.io/">https://grpc.io/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-scion-dataplane">[I-D.dekater-scion-dataplane]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, <span class="refAuthor">Hugly, J.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Data Plane"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-scion-dataplane-11</span>, <time datetime="2026-02-06" class="refDate">6 February 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-scion-dataplane-11">https://datatracker.ietf.org/doc/html/draft-dekater-scion-dataplane-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.dekater-scion-pki">[I-D.dekater-scion-pki]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Control Plane PKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dekater-scion-pki-11</span>, <time datetime="2026-01-16" class="refDate">16 January 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-dekater-scion-pki-11">https://datatracker.ietf.org/doc/html/draft-dekater-scion-pki-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX.1-2024">[POSIX.1-2024]</dt>
        <dd>
<span class="refTitle">"Standard for Information Technology--Portable Operating System Interface (POSIX™) Base Specifications, Issue 8"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://pubs.opengroup.org/onlinepubs/9799919799/basedefs/V1_chap04.html">https://pubs.opengroup.org/onlinepubs/9799919799/basedefs/V1_chap04.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="proto3">[proto3]</dt>
        <dd>
<span class="refTitle">"Protocol Buffers Language Guide version 3"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://protobuf.dev/programming-guides/proto3/">https://protobuf.dev/programming-guides/proto3/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4632">[RFC4632]</dt>
        <dd>
<span class="refAuthor">Fuller, V.</span> and <span class="refAuthor">T. Li</span>, <span class="refTitle">"Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan"</span>, <span class="seriesInfo">BCP 122</span>, <span class="seriesInfo">RFC 4632</span>, <span class="seriesInfo">DOI 10.17487/RFC4632</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4632">https://www.rfc-editor.org/rfc/rfc4632</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9114">[RFC9114]</dt>
      <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9114">https://www.rfc-editor.org/rfc/rfc9114</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP223">[BCP223]</dt>
        <dd>
<div class="refInstance">Best Current Practice 223, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp223">https://www.rfc-editor.org/info/bcp223</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC8633">
            <span class="refAuthor">Reilly, D.</span>, <span class="refAuthor">Stenn, H.</span>, and <span class="refAuthor">D. Sibold</span>, <span class="refTitle">"Network Time Protocol Best Current Practices"</span>, <span class="seriesInfo">BCP 223</span>, <span class="seriesInfo">RFC 8633</span>, <span class="seriesInfo">DOI 10.17487/RFC8633</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8633">https://www.rfc-editor.org/info/rfc8633</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="BollRio-2000">[BollRio-2000]</dt>
        <dd>
<span class="refAuthor">Bollobás, B.</span> and <span class="refAuthor">O. Riordan</span>, <span class="refTitle">"The diameter of a scale-free random graph"</span>, <span>n.d.</span>, <span>&lt;<a href="https://kam.mff.cuni.cz/~ksemweb/clanky/BollobasR-scale_free_random.pdf">https://kam.mff.cuni.cz/~ksemweb/clanky/BollobasR-scale_free_random.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHUAT22">[CHUAT22]</dt>
        <dd>
<span class="refAuthor">Chuat, L.</span>, <span class="refAuthor">Legner, M.</span>, <span class="refAuthor">Basin, D.</span>, <span class="refAuthor">Hausheer, D.</span>, <span class="refAuthor">Hitz, S.</span>, <span class="refAuthor">Mueller, P.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"The Complete Guide to SCION"</span>, <span class="seriesInfo">ISBN 978-3-031-05287-3</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-031-05288-0">https://doi.org/10.1007/978-3-031-05288-0</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISD-AS-assignments">[ISD-AS-assignments]</dt>
        <dd>
<span class="refTitle">"SCION Registry"</span>, <time datetime="2026" class="refDate">2026</time>, <span>&lt;<a href="http://scion.org/registry/">http://scion.org/registry/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PCBExtensions">[PCBExtensions]</dt>
        <dd>
<span class="refAuthor">Anapaya</span>, <span class="refAuthor">ETH</span>, and <span class="refAuthor">SCION Association</span>, <span class="refTitle">"PCB Path Metadata Extension"</span>, <time datetime="2025" class="refDate">2025</time>, <span>&lt;<a href="https://docs.scion.org/en/latest/beacon-metadata.html">https://docs.scion.org/en/latest/beacon-metadata.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1122">https://www.rfc-editor.org/rfc/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4271">https://www.rfc-editor.org/rfc/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5398">[RFC5398]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Autonomous System (AS) Number Reservation for Documentation Use"</span>, <span class="seriesInfo">RFC 5398</span>, <span class="seriesInfo">DOI 10.17487/RFC5398</span>, <time datetime="2008-12" class="refDate">December 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5398">https://www.rfc-editor.org/rfc/rfc5398</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6996">[RFC6996]</dt>
        <dd>
<span class="refAuthor">Mitchell, J.</span>, <span class="refTitle">"Autonomous System (AS) Reservation for Private Use"</span>, <span class="seriesInfo">BCP 6</span>, <span class="seriesInfo">RFC 6996</span>, <span class="seriesInfo">DOI 10.17487/RFC6996</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6996">https://www.rfc-editor.org/rfc/rfc6996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8915">[RFC8915]</dt>
        <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8915">https://www.rfc-editor.org/rfc/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9217">[RFC9217]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refTitle">"Current Open Questions in Path-Aware Networking"</span>, <span class="seriesInfo">RFC 9217</span>, <span class="seriesInfo">DOI 10.17487/RFC9217</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9217">https://www.rfc-editor.org/rfc/rfc9217</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9473">[RFC9473]</dt>
        <dd>
<span class="refAuthor">Enghardt, R.</span> and <span class="refAuthor">C. Krähenbühl</span>, <span class="refTitle">"A Vocabulary of Path Properties"</span>, <span class="seriesInfo">RFC 9473</span>, <span class="seriesInfo">DOI 10.17487/RFC9473</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9473">https://www.rfc-editor.org/rfc/rfc9473</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9523">[RFC9523]</dt>
        <dd>
<span class="refAuthor">Rozen-Schiff, N.</span>, <span class="refAuthor">Dolev, D.</span>, <span class="refAuthor">Mizrahi, T.</span>, and <span class="refAuthor">M. Schapira</span>, <span class="refTitle">"A Secure Selection and Filtering Mechanism for the Network Time Protocol with Khronos"</span>, <span class="seriesInfo">RFC 9523</span>, <span class="seriesInfo">DOI 10.17487/RFC9523</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9523">https://www.rfc-editor.org/rfc/rfc9523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCMP">[SCMP]</dt>
        <dd>
<span class="refAuthor">Anapaya</span>, <span class="refAuthor">ETH Zuerich</span>, and <span class="refAuthor">SCION Association</span>, <span class="refTitle">"SCMP Documentation"</span>, <time datetime="2025" class="refDate">2025</time>, <span>&lt;<a href="https://docs.scion.org/en/latest/protocols/scmp.html">https://docs.scion.org/en/latest/protocols/scmp.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIG">[SIG]</dt>
      <dd>
<span class="refAuthor">Anapaya</span>, <span class="refAuthor">ETH Zuerich</span>, and <span class="refAuthor">SCION</span>, <span class="refTitle">"SCION IP Gateway Documentation"</span>, <time datetime="2024" class="refDate">2024</time>, <span>&lt;<a href="https://docs.scion.org/en/latest/sig.html">https://docs.scion.org/en/latest/sig.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="app-c">
<section id="appendix-A">
      <h2 id="name-path-lookup-examples">
<a href="#name-path-lookup-examples" class="section-name selfRef">Path-Lookup Examples</a>
      </h2>
<p id="appendix-A-1">To illustrate how the path lookup works, two path-lookup examples are shown in sequence diagrams. The network topology of the examples is represented in <a href="#_figure-41" class="auto internal xref">Figure 24</a> below, where in both the source endpoint is in AS A.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"><a href="#_figure-42" class="auto internal xref">Figure 25</a> shows the sequence diagram for the path lookup process in case the destination is in AS D, whereas <a href="#_figure-43" class="auto internal xref">Figure 26</a> shows the path lookup sequence diagram if the destination is in AS G. ASes B and C are core ASes in the source ISD, while E and F are core ASes in a remote ISD. Core AS B is a provider of the local AS, but AS C is not - i.e., there is no up-segment from A to C. "CS" stands for Control Service.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<span id="name-topology-used-in-the-path-l"></span><div id="_figure-41">
<figure id="figure-24">
        <div id="appendix-A-3.1">
          <div class="alignLeft art-svg artwork" id="appendix-A-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="416" width="528" viewBox="0 0 528 416" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,400" fill="none" stroke="black"></path>
              <path d="M 32,80 L 32,224" fill="none" stroke="black"></path>
              <path d="M 48,128 L 48,160" fill="none" stroke="black"></path>
              <path d="M 64,320 L 64,352" fill="none" stroke="black"></path>
              <path d="M 80,160 L 80,320" fill="none" stroke="black"></path>
              <path d="M 96,128 L 96,160" fill="none" stroke="black"></path>
              <path d="M 96,272 L 96,320" fill="none" stroke="black"></path>
              <path d="M 112,320 L 112,352" fill="none" stroke="black"></path>
              <path d="M 128,192 L 128,272" fill="none" stroke="black"></path>
              <path d="M 144,128 L 144,160" fill="none" stroke="black"></path>
              <path d="M 144,320 L 144,352" fill="none" stroke="black"></path>
              <path d="M 168,160 L 168,320" fill="none" stroke="black"></path>
              <path d="M 192,128 L 192,160" fill="none" stroke="black"></path>
              <path d="M 192,320 L 192,352" fill="none" stroke="black"></path>
              <path d="M 208,80 L 208,136" fill="none" stroke="black"></path>
              <path d="M 208,152 L 208,184" fill="none" stroke="black"></path>
              <path d="M 208,200 L 208,224" fill="none" stroke="black"></path>
              <path d="M 240,32 L 240,136" fill="none" stroke="black"></path>
              <path d="M 240,152 L 240,184" fill="none" stroke="black"></path>
              <path d="M 240,200 L 240,400" fill="none" stroke="black"></path>
              <path d="M 288,32 L 288,136" fill="none" stroke="black"></path>
              <path d="M 288,152 L 288,184" fill="none" stroke="black"></path>
              <path d="M 288,200 L 288,400" fill="none" stroke="black"></path>
              <path d="M 328,80 L 328,136" fill="none" stroke="black"></path>
              <path d="M 328,152 L 328,184" fill="none" stroke="black"></path>
              <path d="M 328,200 L 328,224" fill="none" stroke="black"></path>
              <path d="M 344,176 L 344,208" fill="none" stroke="black"></path>
              <path d="M 352,320 L 352,352" fill="none" stroke="black"></path>
              <path d="M 368,208 L 368,320" fill="none" stroke="black"></path>
              <path d="M 376,128 L 376,144" fill="none" stroke="black"></path>
              <path d="M 384,272 L 384,320" fill="none" stroke="black"></path>
              <path d="M 392,176 L 392,208" fill="none" stroke="black"></path>
              <path d="M 400,320 L 400,352" fill="none" stroke="black"></path>
              <path d="M 416,112 L 416,144" fill="none" stroke="black"></path>
              <path d="M 432,176 L 432,192" fill="none" stroke="black"></path>
              <path d="M 448,144 L 448,272" fill="none" stroke="black"></path>
              <path d="M 464,112 L 464,144" fill="none" stroke="black"></path>
              <path d="M 480,80 L 480,224" fill="none" stroke="black"></path>
              <path d="M 520,32 L 520,400" fill="none" stroke="black"></path>
              <path d="M 8,32 L 240,32" fill="none" stroke="black"></path>
              <path d="M 288,32 L 520,32" fill="none" stroke="black"></path>
              <path d="M 32,80 L 208,80" fill="none" stroke="black"></path>
              <path d="M 328,80 L 480,80" fill="none" stroke="black"></path>
              <path d="M 416,112 L 464,112" fill="none" stroke="black"></path>
              <path d="M 48,128 L 96,128" fill="none" stroke="black"></path>
              <path d="M 144,128 L 192,128" fill="none" stroke="black"></path>
              <path d="M 376,128 L 400,128" fill="none" stroke="black"></path>
              <path d="M 112,144 L 128,144" fill="none" stroke="black"></path>
              <path d="M 208,144 L 376,144" fill="none" stroke="black"></path>
              <path d="M 416,144 L 464,144" fill="none" stroke="black"></path>
              <path d="M 48,160 L 96,160" fill="none" stroke="black"></path>
              <path d="M 144,160 L 192,160" fill="none" stroke="black"></path>
              <path d="M 344,176 L 392,176" fill="none" stroke="black"></path>
              <path d="M 200,192 L 328,192" fill="none" stroke="black"></path>
              <path d="M 408,192 L 432,192" fill="none" stroke="black"></path>
              <path d="M 344,208 L 392,208" fill="none" stroke="black"></path>
              <path d="M 32,224 L 72,224" fill="none" stroke="black"></path>
              <path d="M 88,224 L 120,224" fill="none" stroke="black"></path>
              <path d="M 136,224 L 160,224" fill="none" stroke="black"></path>
              <path d="M 176,224 L 208,224" fill="none" stroke="black"></path>
              <path d="M 328,224 L 360,224" fill="none" stroke="black"></path>
              <path d="M 376,224 L 440,224" fill="none" stroke="black"></path>
              <path d="M 456,224 L 480,224" fill="none" stroke="black"></path>
              <path d="M 96,272 L 128,272" fill="none" stroke="black"></path>
              <path d="M 384,272 L 448,272" fill="none" stroke="black"></path>
              <path d="M 64,320 L 112,320" fill="none" stroke="black"></path>
              <path d="M 144,320 L 192,320" fill="none" stroke="black"></path>
              <path d="M 352,320 L 400,320" fill="none" stroke="black"></path>
              <path d="M 64,352 L 112,352" fill="none" stroke="black"></path>
              <path d="M 144,352 L 192,352" fill="none" stroke="black"></path>
              <path d="M 352,352 L 400,352" fill="none" stroke="black"></path>
              <path d="M 8,400 L 240,400" fill="none" stroke="black"></path>
              <path d="M 288,400 L 520,400" fill="none" stroke="black"></path>
              <path d="M 188,168 L 200,192" fill="none" stroke="black"></path>
              <path d="M 128,192 L 144,160" fill="none" stroke="black"></path>
              <circle cx="80" cy="304" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="96" cy="304" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="168" cy="304" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="368" cy="304" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="384" cy="304" r="6" class="opendot" fill="white" stroke="black"></circle>
              <g class="text">
                <text x="124" y="100">Core</text>
                <text x="404" y="100">Core</text>
                <text x="408" y="132">c</text>
                <text x="428" y="132">AS</text>
                <text x="448" y="132">F</text>
                <text x="60" y="148">AS</text>
                <text x="80" y="148">C</text>
                <text x="104" y="148">c</text>
                <text x="136" y="148">c</text>
                <text x="156" y="148">AS</text>
                <text x="176" y="148">B</text>
                <text x="200" y="148">c</text>
                <text x="432" y="164">c</text>
                <text x="184" y="180">c</text>
                <text x="336" y="196">c</text>
                <text x="356" y="196">AS</text>
                <text x="376" y="196">E</text>
                <text x="400" y="196">c</text>
                <text x="76" y="340">AS</text>
                <text x="96" y="340">D</text>
                <text x="156" y="340">AS</text>
                <text x="176" y="340">A</text>
                <text x="364" y="340">AS</text>
                <text x="384" y="340">G</text>
                <text x="120" y="388">ISD</text>
                <text x="144" y="388">1</text>
                <text x="400" y="388">ISD</text>
                <text x="424" y="388">2</text>
              </g>
            </svg><a href="#appendix-A-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-topology-used-in-the-path-l" class="selfRef">Topology used in the path lookup examples</a>
        </figcaption></figure>
</div>
<span id="name-sequence-diagram-illustrati"></span><div id="_figure-42">
<figure id="figure-25">
        <div id="appendix-A-4.1">
          <div class="alignLeft art-svg artwork" id="appendix-A-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="864" width="592" viewBox="0 0 592 864" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
              <path d="M 8,128 L 8,176" fill="none" stroke="black"></path>
              <path d="M 8,768 L 8,800" fill="none" stroke="black"></path>
              <path d="M 32,80 L 32,128" fill="none" stroke="black"></path>
              <path d="M 32,176 L 32,768" fill="none" stroke="black"></path>
              <path d="M 48,80 L 48,128" fill="none" stroke="black"></path>
              <path d="M 48,176 L 48,216" fill="none" stroke="black"></path>
              <path d="M 48,248 L 48,768" fill="none" stroke="black"></path>
              <path d="M 48,800 L 48,848" fill="none" stroke="black"></path>
              <path d="M 64,80 L 64,128" fill="none" stroke="black"></path>
              <path d="M 64,176 L 64,216" fill="none" stroke="black"></path>
              <path d="M 64,256 L 64,312" fill="none" stroke="black"></path>
              <path d="M 64,328 L 64,392" fill="none" stroke="black"></path>
              <path d="M 64,408 L 64,768" fill="none" stroke="black"></path>
              <path d="M 88,32 L 88,80" fill="none" stroke="black"></path>
              <path d="M 120,128 L 120,176" fill="none" stroke="black"></path>
              <path d="M 144,768 L 144,800" fill="none" stroke="black"></path>
              <path d="M 160,480 L 160,528" fill="none" stroke="black"></path>
              <path d="M 176,32 L 176,80" fill="none" stroke="black"></path>
              <path d="M 208,528 L 208,720" fill="none" stroke="black"></path>
              <path d="M 216,80 L 216,400" fill="none" stroke="black"></path>
              <path d="M 216,432 L 216,480" fill="none" stroke="black"></path>
              <path d="M 216,752 L 216,848" fill="none" stroke="black"></path>
              <path d="M 224,528 L 224,568" fill="none" stroke="black"></path>
              <path d="M 224,600 L 224,720" fill="none" stroke="black"></path>
              <path d="M 256,32 L 256,80" fill="none" stroke="black"></path>
              <path d="M 272,480 L 272,528" fill="none" stroke="black"></path>
              <path d="M 344,32 L 344,80" fill="none" stroke="black"></path>
              <path d="M 384,80 L 384,648" fill="none" stroke="black"></path>
              <path d="M 384,680 L 384,848" fill="none" stroke="black"></path>
              <path d="M 424,32 L 424,80" fill="none" stroke="black"></path>
              <path d="M 504,32 L 504,80" fill="none" stroke="black"></path>
              <path d="M 544,80 L 544,848" fill="none" stroke="black"></path>
              <path d="M 584,32 L 584,80" fill="none" stroke="black"></path>
              <path d="M 8,32 L 88,32" fill="none" stroke="black"></path>
              <path d="M 176,32 L 256,32" fill="none" stroke="black"></path>
              <path d="M 344,32 L 424,32" fill="none" stroke="black"></path>
              <path d="M 504,32 L 584,32" fill="none" stroke="black"></path>
              <path d="M 8,80 L 88,80" fill="none" stroke="black"></path>
              <path d="M 176,80 L 256,80" fill="none" stroke="black"></path>
              <path d="M 344,80 L 424,80" fill="none" stroke="black"></path>
              <path d="M 504,80 L 584,80" fill="none" stroke="black"></path>
              <path d="M 8,128 L 120,128" fill="none" stroke="black"></path>
              <path d="M 8,176 L 120,176" fill="none" stroke="black"></path>
              <path d="M 32,224 L 208,224" fill="none" stroke="black"></path>
              <path d="M 40,240 L 56,240" fill="none" stroke="black"></path>
              <path d="M 48,320 L 208,320" fill="none" stroke="black"></path>
              <path d="M 216,352 L 376,352" fill="none" stroke="black"></path>
              <path d="M 224,368 L 240,368" fill="none" stroke="black"></path>
              <path d="M 56,400 L 72,400" fill="none" stroke="black"></path>
              <path d="M 160,480 L 272,480" fill="none" stroke="black"></path>
              <path d="M 64,496 L 152,496" fill="none" stroke="black"></path>
              <path d="M 160,528 L 272,528" fill="none" stroke="black"></path>
              <path d="M 208,576 L 376,576" fill="none" stroke="black"></path>
              <path d="M 216,592 L 232,592" fill="none" stroke="black"></path>
              <path d="M 368,592 L 384,592" fill="none" stroke="black"></path>
              <path d="M 224,656 L 536,656" fill="none" stroke="black"></path>
              <path d="M 232,672 L 248,672" fill="none" stroke="black"></path>
              <path d="M 528,672 L 544,672" fill="none" stroke="black"></path>
              <path d="M 72,720 L 96,720" fill="none" stroke="black"></path>
              <path d="M 208,720 L 224,720" fill="none" stroke="black"></path>
              <path d="M 8,768 L 144,768" fill="none" stroke="black"></path>
              <path d="M 8,800 L 144,800" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="544,656 532,650.4 532,661.6" fill="black" transform="rotate(0,536,656)"></polygon>
              <polygon class="arrowhead" points="384,576 372,570.4 372,581.6" fill="black" transform="rotate(0,376,576)"></polygon>
              <polygon class="arrowhead" points="384,352 372,346.4 372,357.6" fill="black" transform="rotate(0,376,352)"></polygon>
              <polygon class="arrowhead" points="240,672 228,666.4 228,677.6" fill="black" transform="rotate(180,232,672)"></polygon>
              <polygon class="arrowhead" points="232,368 220,362.4 220,373.6" fill="black" transform="rotate(180,224,368)"></polygon>
              <polygon class="arrowhead" points="224,592 212,586.4 212,597.6" fill="black" transform="rotate(180,216,592)"></polygon>
              <polygon class="arrowhead" points="216,320 204,314.4 204,325.6" fill="black" transform="rotate(0,208,320)"></polygon>
              <polygon class="arrowhead" points="216,224 204,218.4 204,229.6" fill="black" transform="rotate(0,208,224)"></polygon>
              <polygon class="arrowhead" points="160,496 148,490.4 148,501.6" fill="black" transform="rotate(0,152,496)"></polygon>
              <polygon class="arrowhead" points="80,720 68,714.4 68,725.6" fill="black" transform="rotate(180,72,720)"></polygon>
              <polygon class="arrowhead" points="64,400 52,394.4 52,405.6" fill="black" transform="rotate(180,56,400)"></polygon>
              <polygon class="arrowhead" points="48,240 36,234.4 36,245.6" fill="black" transform="rotate(180,40,240)"></polygon>
              <g class="text">
                <text x="44" y="52">Endpoint</text>
                <text x="204" y="52">Source</text>
                <text x="244" y="52">AS</text>
                <text x="372" y="52">Core</text>
                <text x="404" y="52">AS</text>
                <text x="532" y="52">Core</text>
                <text x="564" y="52">AS</text>
                <text x="196" y="68">CS</text>
                <text x="232" y="68">(A)</text>
                <text x="364" y="68">CS</text>
                <text x="400" y="68">(B)</text>
                <text x="524" y="68">CS</text>
                <text x="560" y="68">(C)</text>
                <text x="28" y="148">Send</text>
                <text x="84" y="148">Requests</text>
                <text x="28" y="164">in</text>
                <text x="76" y="164">parallel</text>
                <text x="96" y="212">request</text>
                <text x="148" y="212">(up)</text>
                <text x="76" y="244">--</text>
                <text x="100" y="244">--</text>
                <text x="124" y="244">--</text>
                <text x="148" y="244">--</text>
                <text x="172" y="244">--</text>
                <text x="196" y="244">--</text>
                <text x="96" y="260">reply</text>
                <text x="168" y="260">(up,[A-&gt;B])</text>
                <text x="96" y="308">request</text>
                <text x="172" y="308">(core,0,0)</text>
                <text x="248" y="340">request</text>
                <text x="324" y="340">(core,B,0)</text>
                <text x="260" y="372">--</text>
                <text x="284" y="372">--</text>
                <text x="308" y="372">--</text>
                <text x="332" y="372">--</text>
                <text x="356" y="372">--</text>
                <text x="376" y="372">-</text>
                <text x="308" y="388">reply(core,[B-&gt;C])</text>
                <text x="92" y="404">--</text>
                <text x="116" y="404">--</text>
                <text x="140" y="404">--</text>
                <text x="164" y="404">--</text>
                <text x="188" y="404">--</text>
                <text x="208" y="404">-</text>
                <text x="96" y="420">reply</text>
                <text x="176" y="420">(core,[B-&gt;C])</text>
                <text x="96" y="468">request</text>
                <text x="172" y="468">(down,0,D)</text>
                <text x="180" y="500">send</text>
                <text x="236" y="500">requests</text>
                <text x="180" y="516">in</text>
                <text x="228" y="516">parallel</text>
                <text x="256" y="564">request</text>
                <text x="332" y="564">(down,B,D)</text>
                <text x="252" y="596">--</text>
                <text x="276" y="596">--</text>
                <text x="300" y="596">--</text>
                <text x="324" y="596">--</text>
                <text x="348" y="596">--</text>
                <text x="308" y="612">reply(down,[B-&gt;D])</text>
                <text x="416" y="644">request</text>
                <text x="492" y="644">(down,C,D)</text>
                <text x="268" y="676">--</text>
                <text x="292" y="676">--</text>
                <text x="316" y="676">--</text>
                <text x="340" y="676">--</text>
                <text x="364" y="676">--</text>
                <text x="388" y="676">--</text>
                <text x="412" y="676">--</text>
                <text x="436" y="676">--</text>
                <text x="460" y="676">--</text>
                <text x="484" y="676">--</text>
                <text x="508" y="676">--</text>
                <text x="468" y="692">reply(down,[C-&gt;D])</text>
                <text x="116" y="724">--</text>
                <text x="140" y="724">--</text>
                <text x="164" y="724">--</text>
                <text x="188" y="724">--</text>
                <text x="104" y="740">reply</text>
                <text x="180" y="740">(down,[B-&gt;D,</text>
                <text x="260" y="740">C-&gt;D])</text>
                <text x="40" y="788">Combine</text>
                <text x="108" y="788">Segments</text>
              </g>
            </svg><a href="#appendix-A-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-sequence-diagram-illustrati" class="selfRef">Sequence diagram illustrating a path lookup for a destination D in the source ISD. The request (core, 0, 0) is for all pairs of core ASes in the source ISD. Similarly, (down, 0, D) is for down segments between any core AS in the source ISD and destination D.</a>
        </figcaption></figure>
</div>
<span id="name-sequence-diagram-illustratin"></span><div id="_figure-43">
<figure id="figure-26">
        <div id="appendix-A-5.1">
          <div class="alignLeft art-svg artwork" id="appendix-A-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="864" width="608" viewBox="0 0 608 864" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
              <path d="M 8,128 L 8,176" fill="none" stroke="black"></path>
              <path d="M 8,768 L 8,800" fill="none" stroke="black"></path>
              <path d="M 32,80 L 32,128" fill="none" stroke="black"></path>
              <path d="M 32,176 L 32,768" fill="none" stroke="black"></path>
              <path d="M 48,80 L 48,128" fill="none" stroke="black"></path>
              <path d="M 48,176 L 48,216" fill="none" stroke="black"></path>
              <path d="M 48,264 L 48,768" fill="none" stroke="black"></path>
              <path d="M 48,800 L 48,848" fill="none" stroke="black"></path>
              <path d="M 64,80 L 64,128" fill="none" stroke="black"></path>
              <path d="M 64,176 L 64,216" fill="none" stroke="black"></path>
              <path d="M 64,272 L 64,328" fill="none" stroke="black"></path>
              <path d="M 64,344 L 64,408" fill="none" stroke="black"></path>
              <path d="M 64,424 L 64,768" fill="none" stroke="black"></path>
              <path d="M 88,32 L 88,80" fill="none" stroke="black"></path>
              <path d="M 120,128 L 120,176" fill="none" stroke="black"></path>
              <path d="M 120,496 L 120,544" fill="none" stroke="black"></path>
              <path d="M 136,32 L 136,80" fill="none" stroke="black"></path>
              <path d="M 144,768 L 144,800" fill="none" stroke="black"></path>
              <path d="M 168,544 L 168,720" fill="none" stroke="black"></path>
              <path d="M 176,80 L 176,256" fill="none" stroke="black"></path>
              <path d="M 176,280 L 176,416" fill="none" stroke="black"></path>
              <path d="M 176,448 L 176,464" fill="none" stroke="black"></path>
              <path d="M 176,752 L 176,848" fill="none" stroke="black"></path>
              <path d="M 184,544 L 184,568" fill="none" stroke="black"></path>
              <path d="M 184,600 L 184,720" fill="none" stroke="black"></path>
              <path d="M 216,32 L 216,80" fill="none" stroke="black"></path>
              <path d="M 232,496 L 232,544" fill="none" stroke="black"></path>
              <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
              <path d="M 304,80 L 304,384" fill="none" stroke="black"></path>
              <path d="M 304,408 L 304,568" fill="none" stroke="black"></path>
              <path d="M 304,600 L 304,664" fill="none" stroke="black"></path>
              <path d="M 304,704 L 304,848" fill="none" stroke="black"></path>
              <path d="M 344,32 L 344,80" fill="none" stroke="black"></path>
              <path d="M 392,32 L 392,80" fill="none" stroke="black"></path>
              <path d="M 432,80 L 432,592" fill="none" stroke="black"></path>
              <path d="M 432,616 L 432,664" fill="none" stroke="black"></path>
              <path d="M 432,696 L 432,848" fill="none" stroke="black"></path>
              <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
              <path d="M 520,32 L 520,80" fill="none" stroke="black"></path>
              <path d="M 560,80 L 560,688" fill="none" stroke="black"></path>
              <path d="M 560,712 L 560,848" fill="none" stroke="black"></path>
              <path d="M 600,32 L 600,80" fill="none" stroke="black"></path>
              <path d="M 8,32 L 88,32" fill="none" stroke="black"></path>
              <path d="M 136,32 L 216,32" fill="none" stroke="black"></path>
              <path d="M 264,32 L 344,32" fill="none" stroke="black"></path>
              <path d="M 392,32 L 472,32" fill="none" stroke="black"></path>
              <path d="M 520,32 L 600,32" fill="none" stroke="black"></path>
              <path d="M 8,80 L 88,80" fill="none" stroke="black"></path>
              <path d="M 136,80 L 216,80" fill="none" stroke="black"></path>
              <path d="M 264,80 L 344,80" fill="none" stroke="black"></path>
              <path d="M 392,80 L 472,80" fill="none" stroke="black"></path>
              <path d="M 520,80 L 600,80" fill="none" stroke="black"></path>
              <path d="M 8,128 L 120,128" fill="none" stroke="black"></path>
              <path d="M 8,176 L 120,176" fill="none" stroke="black"></path>
              <path d="M 32,224 L 168,224" fill="none" stroke="black"></path>
              <path d="M 40,256 L 56,256" fill="none" stroke="black"></path>
              <path d="M 48,336 L 168,336" fill="none" stroke="black"></path>
              <path d="M 176,368 L 296,368" fill="none" stroke="black"></path>
              <path d="M 120,496 L 232,496" fill="none" stroke="black"></path>
              <path d="M 64,512 L 112,512" fill="none" stroke="black"></path>
              <path d="M 120,544 L 232,544" fill="none" stroke="black"></path>
              <path d="M 168,576 L 424,576" fill="none" stroke="black"></path>
              <path d="M 176,592 L 192,592" fill="none" stroke="black"></path>
              <path d="M 184,672 L 552,672" fill="none" stroke="black"></path>
              <path d="M 168,720 L 184,720" fill="none" stroke="black"></path>
              <path d="M 8,768 L 144,768" fill="none" stroke="black"></path>
              <path d="M 8,800 L 144,800" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,672 548,666.4 548,677.6" fill="black" transform="rotate(0,552,672)"></polygon>
              <polygon class="arrowhead" points="432,576 420,570.4 420,581.6" fill="black" transform="rotate(0,424,576)"></polygon>
              <polygon class="arrowhead" points="304,368 292,362.4 292,373.6" fill="black" transform="rotate(0,296,368)"></polygon>
              <polygon class="arrowhead" points="184,592 172,586.4 172,597.6" fill="black" transform="rotate(180,176,592)"></polygon>
              <polygon class="arrowhead" points="176,336 164,330.4 164,341.6" fill="black" transform="rotate(0,168,336)"></polygon>
              <polygon class="arrowhead" points="176,224 164,218.4 164,229.6" fill="black" transform="rotate(0,168,224)"></polygon>
              <polygon class="arrowhead" points="120,512 108,506.4 108,517.6" fill="black" transform="rotate(0,112,512)"></polygon>
              <polygon class="arrowhead" points="48,256 36,250.4 36,261.6" fill="black" transform="rotate(180,40,256)"></polygon>
              <g class="text">
                <text x="44" y="52">Endpoint</text>
                <text x="164" y="52">Source</text>
                <text x="204" y="52">AS</text>
                <text x="292" y="52">Core</text>
                <text x="324" y="52">AS</text>
                <text x="420" y="52">Core</text>
                <text x="452" y="52">AS</text>
                <text x="548" y="52">Core</text>
                <text x="580" y="52">AS</text>
                <text x="156" y="68">CS</text>
                <text x="192" y="68">(A)</text>
                <text x="284" y="68">CS</text>
                <text x="320" y="68">(B)</text>
                <text x="412" y="68">CS</text>
                <text x="448" y="68">(E)</text>
                <text x="540" y="68">CS</text>
                <text x="576" y="68">(F)</text>
                <text x="28" y="148">Send</text>
                <text x="84" y="148">Requests</text>
                <text x="28" y="164">in</text>
                <text x="76" y="164">parallel</text>
                <text x="96" y="212">request</text>
                <text x="148" y="212">(up)</text>
                <text x="48" y="244">|</text>
                <text x="64" y="244">|</text>
                <text x="76" y="260">--</text>
                <text x="100" y="260">--</text>
                <text x="124" y="260">--</text>
                <text x="148" y="260">--</text>
                <text x="168" y="260">-</text>
                <text x="96" y="276">reply</text>
                <text x="168" y="276">(up,[A-&gt;B])</text>
                <text x="96" y="324">request</text>
                <text x="152" y="324">(core</text>
                <text x="212" y="324">0,(2,0))</text>
                <text x="208" y="356">request</text>
                <text x="272" y="356">(core,0</text>
                <text x="332" y="356">(2,0))</text>
                <text x="188" y="388">&lt;-</text>
                <text x="212" y="388">--</text>
                <text x="236" y="388">--</text>
                <text x="260" y="388">--</text>
                <text x="284" y="388">--</text>
                <text x="208" y="404">reply</text>
                <text x="308" y="404">(core,[B-&gt;E,B-&gt;F])</text>
                <text x="60" y="420">&lt;-</text>
                <text x="84" y="420">--</text>
                <text x="108" y="420">--</text>
                <text x="132" y="420">--</text>
                <text x="156" y="420">--</text>
                <text x="96" y="436">reply</text>
                <text x="196" y="436">(core,[B-&gt;E,B-&gt;F])</text>
                <text x="104" y="484">request</text>
                <text x="196" y="484">(down,(2,0),G)</text>
                <text x="140" y="516">send</text>
                <text x="196" y="516">requests</text>
                <text x="140" y="532">in</text>
                <text x="188" y="532">parallel</text>
                <text x="336" y="564">request</text>
                <text x="400" y="564">(down,E</text>
                <text x="444" y="564">G)</text>
                <text x="212" y="596">--</text>
                <text x="236" y="596">--</text>
                <text x="260" y="596">--</text>
                <text x="284" y="596">--</text>
                <text x="308" y="596">--</text>
                <text x="332" y="596">--</text>
                <text x="356" y="596">--</text>
                <text x="380" y="596">--</text>
                <text x="404" y="596">--</text>
                <text x="424" y="596">-</text>
                <text x="336" y="612">reply</text>
                <text x="416" y="612">(down,[E-&gt;G])</text>
                <text x="464" y="660">request</text>
                <text x="528" y="660">(down,F</text>
                <text x="572" y="660">G)</text>
                <text x="196" y="692">&lt;-</text>
                <text x="220" y="692">--</text>
                <text x="244" y="692">--</text>
                <text x="268" y="692">--</text>
                <text x="292" y="692">--</text>
                <text x="316" y="692">--</text>
                <text x="340" y="692">--</text>
                <text x="364" y="692">--</text>
                <text x="388" y="692">--</text>
                <text x="412" y="692">--</text>
                <text x="436" y="692">--</text>
                <text x="460" y="692">--</text>
                <text x="484" y="692">--</text>
                <text x="508" y="692">--</text>
                <text x="532" y="692">--</text>
                <text x="552" y="692">-</text>
                <text x="464" y="708">reply</text>
                <text x="544" y="708">(down,[F-&gt;G])</text>
                <text x="76" y="724">&lt;-</text>
                <text x="100" y="724">--</text>
                <text x="124" y="724">--</text>
                <text x="148" y="724">--</text>
                <text x="96" y="740">reply</text>
                <text x="196" y="740">(down,[E-&gt;G,F-&gt;G])</text>
                <text x="40" y="788">Combine</text>
                <text x="108" y="788">Segments</text>
              </g>
            </svg><a href="#appendix-A-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-sequence-diagram-illustratin" class="selfRef">Sequence diagram illustrating a path lookup for a destination G in a remote ISD. The request (core, 0, (2, 0)) is for all path segments between a core AS in the source ISD and a core AS in ISD 2. Similarly, (down, (2, 0), G) is for down segments between any core AS in ISD 2 and destination G.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-B">
      <h2 id="name-change-log">
<a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-B-1">Changes made to drafts since ISE submission. This section is to be removed before publication.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="draft-dekater-scion-controlplane-15">
<section id="appendix-B.1">
        <h3 id="name-draft-dekater-scion-control">
<a href="#name-draft-dekater-scion-control" class="section-name selfRef">draft-dekater-scion-controlplane-15</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.1-1.1">
            <p id="appendix-B.1-1.1.1">Final read, wording<a href="#appendix-B.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.2">
            <p id="appendix-B.1-1.2.1">"originating/initiating" PCBs --&gt; consistently use originating<a href="#appendix-B.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.3">
            <p id="appendix-B.1-1.3.1">Section 2.3.5. Propagation of Selected PCBs: unify core and intra-ISD propagation, since steps are the same<a href="#appendix-B.1-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-15-1">
<section id="appendix-B.2">
        <h3 id="name-draft-dekater-scion-controlp">
<a href="#name-draft-dekater-scion-controlp" class="section-name selfRef">draft-dekater-scion-controlplane-15</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">
            <p id="appendix-B.2-1.1.1">Wording polish following ISE Editor's feedback.<a href="#appendix-B.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.2">
            <p id="appendix-B.2-1.2.1">Reduce use of passive tense and clarify subject (e.g., an AS --&gt; An AS operator)<a href="#appendix-B.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.3">
            <p id="appendix-B.2-1.3.1">ISD and AS numbers: clarify that identifiers in public ranges must be unique<a href="#appendix-B.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.4">
            <p id="appendix-B.2-1.4.1">Remove redundant section 1.7. Resistance to partitioning<a href="#appendix-B.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.5">
            <p id="appendix-B.2-1.5.1">Section 1.7.  Communication Protocol: Clarify DNS resolution is not needed<a href="#appendix-B.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.6">
            <p id="appendix-B.2-1.6.1">Figures 2, 3, 4: improve arrows in SVG version, move description text to after the figures<a href="#appendix-B.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.7">
            <p id="appendix-B.2-1.7.1">PCB Extensions: clarify behavior in case of unknown extensions<a href="#appendix-B.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.8">
            <p id="appendix-B.2-1.8.1">Configuration: ensure all items are mentioned and cross referenced.<a href="#appendix-B.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.9">
            <p id="appendix-B.2-1.9.1">Rename "registration period" to "registration interval" to ensure consistency with "propagation interval"<a href="#appendix-B.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.10">
            <p id="appendix-B.2-1.10.1">Timestamps: add normative reference to POSIX.1-2024 to clarify counting of leap seconds<a href="#appendix-B.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.11">
            <p id="appendix-B.2-1.11.1">Registration of Path Segments: clarify that a core AS has down segments registered by its direct or indirect customer ASes<a href="#appendix-B.2-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.12">
            <p id="appendix-B.2-1.12.1">Path Lookup Process: reformat and reword steps to clarify how an endpoint requests path segments<a href="#appendix-B.2-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.13">
            <p id="appendix-B.2-1.13.1">SCMP: remove experimental values from table and mention more error messages are in referenced spec<a href="#appendix-B.2-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.14">
            <p id="appendix-B.2-1.14.1">Move "Deployment Considerations" from section 3 to 7<a href="#appendix-B.2-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.15">
            <p id="appendix-B.2-1.15.1">Attacks on time sources: recommend use of secure time synchronization and mention CAs<a href="#appendix-B.2-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.16">
            <p id="appendix-B.2-1.16.1">Acknowledgements: ensure all reviewers are there<a href="#appendix-B.2-1.16.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-14">
<section id="appendix-B.3">
        <h3 id="name-draft-dekater-scion-controlpl">
<a href="#name-draft-dekater-scion-controlpl" class="section-name selfRef">draft-dekater-scion-controlplane-14</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.3-1.1">
            <p id="appendix-B.3-1.1.1">Clarify bits in timestamps.<a href="#appendix-B.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.2">
            <p id="appendix-B.3-1.2.1">Remove  informative reference to I-D.dekater-panrg-scion-overview  and to Anapaya's ISD assignments, since they are taken over by SCION Association in 2026<a href="#appendix-B.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.3">
            <p id="appendix-B.3-1.3.1">Overall review and wording polish<a href="#appendix-B.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.4">
            <p id="appendix-B.3-1.4.1">Protobuf messages syntax check, add missing empty <code>PathSegmentUnsignedExtensions</code> message definition<a href="#appendix-B.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.5">
            <p id="appendix-B.3-1.5.1"><code>SegmentLookupService</code> RPC: clarify wording on API exposure<a href="#appendix-B.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.6">
            <p id="appendix-B.3-1.6.1">Peer entry figure 14 - make fields consistent with protobuf definitions<a href="#appendix-B.3-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.7">
            <p id="appendix-B.3-1.7.1">New section: Renewal of Cryptographic Material<a href="#appendix-B.3-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-13">
<section id="appendix-B.4">
        <h3 id="name-draft-dekater-scion-controlpla">
<a href="#name-draft-dekater-scion-controlpla" class="section-name selfRef">draft-dekater-scion-controlplane-13</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.4-1.1">
            <p id="appendix-B.4-1.1.1">Clarify distinction between SCION ASes and BGP ASes through the text.<a href="#appendix-B.4-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-12">
<section id="appendix-B.5">
        <h3 id="name-draft-dekater-scion-controlplan">
<a href="#name-draft-dekater-scion-controlplan" class="section-name selfRef">draft-dekater-scion-controlplane-12</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.5-1.1">
            <p id="appendix-B.5-1.1.1">Security considerations: new section "Attacks on time sources"<a href="#appendix-B.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.2">
            <p id="appendix-B.5-1.2.1">Path Lookup Process: mention checks at endpoint<a href="#appendix-B.5-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-11">
<section id="appendix-B.6">
        <h3 id="name-draft-dekater-scion-controlplane">
<a href="#name-draft-dekater-scion-controlplane" class="section-name selfRef">draft-dekater-scion-controlplane-11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.6-1.1">
            <p id="appendix-B.6-1.1.1">Clarify use of wildcard ISD and ISD-AS text representation<a href="#appendix-B.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.6-1.2">
            <p id="appendix-B.6-1.2.1">Remove redundant PCB overview figure 6 and reorganized paragraphs in 2.2. PCBs<a href="#appendix-B.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.6-1.3">
            <p id="appendix-B.6-1.3.1">Small clarifications and nits<a href="#appendix-B.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.6-1.4">
            <p id="appendix-B.6-1.4.1">Figures: small changes to use aasvg in all figures<a href="#appendix-B.6-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.6-1.5">
            <p id="appendix-B.6-1.5.1">Appendix "Path-Lookup Examples": use wildcard AS 0 instead of * in figures in<a href="#appendix-B.6-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-10">
<section id="appendix-B.7">
        <h3 id="name-draft-dekater-scion-controlplane-">
<a href="#name-draft-dekater-scion-controlplane-" class="section-name selfRef">draft-dekater-scion-controlplane-10</a>
        </h3>
<p id="appendix-B.7-1">Major changes:<a href="#appendix-B.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.7-2.1">
            <p id="appendix-B.7-2.1.1">New section "Distribution of Cryptographic Material" containing definitions formerly in the gRPC API appendix<a href="#appendix-B.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-2.2">
            <p id="appendix-B.7-2.2.1">New section "Destination Mapping" including a SIG reference<a href="#appendix-B.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-2.3">
            <p id="appendix-B.7-2.3.1">New section "Lookup Requests Message Format" containing definitions formerly in the gRPC API appendix<a href="#appendix-B.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-2.4">
            <p id="appendix-B.7-2.4.1">Move appendix "Use of the SCION Data Plane" to new section "Control Service Discovery"<a href="#appendix-B.7-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-2.5">
            <p id="appendix-B.7-2.5.1">Mention ConnectRPC as main RPC method instead of gRPC<a href="#appendix-B.7-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-2.6">
            <p id="appendix-B.7-2.6.1">Remove appendix "Full Control Service gRPC API" and move corresponding protobuf definitions in new sections mentioned above<a href="#appendix-B.7-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.7-3">Minor changes:<a href="#appendix-B.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.7-4.1">
            <p id="appendix-B.7-4.1.1">Rename Inter-ISD Beaconing into Core Beaconing for consistency<a href="#appendix-B.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.2">
            <p id="appendix-B.7-4.2.1">Clarify descriptions of fields in the <code>HeaderAndBody</code> message and that metadata must be empty<a href="#appendix-B.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.3">
            <p id="appendix-B.7-4.3.1">AS Entry Signature: fix order of terms in one formula, clarify validity and meaning of associated data<a href="#appendix-B.7-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.4">
            <p id="appendix-B.7-4.4.1">PCB Extensions: clarified text, added example of the <code>StaticInfoExtension</code> and informative reference<a href="#appendix-B.7-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.5">
            <p id="appendix-B.7-4.5.1">PCB Validity: clarify text on timestamp validity and time allowances<a href="#appendix-B.7-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.6">
            <p id="appendix-B.7-4.6.1">Reception of PCBs: mention that incoming link <span class="bcp14">MUST</span> be core or parent<a href="#appendix-B.7-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.7">
            <p id="appendix-B.7-4.7.1">PCB selection policies: discourage use for traffic engineering<a href="#appendix-B.7-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.8">
            <p id="appendix-B.7-4.8.1">Best PCBs Set Size: clarify tradeoffs and avoid normative language when unnecessary<a href="#appendix-B.7-4.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.9">
            <p id="appendix-B.7-4.9.1">Path reversibility: mention that destination endpoints should estimate MTU<a href="#appendix-B.7-4.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.10">
            <p id="appendix-B.7-4.10.1">Move considerations on SCMP Authentication to the security considerations section (Rogue SCMP Error Messages)<a href="#appendix-B.7-4.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.7-4.11">
            <p id="appendix-B.7-4.11.1">Security Properties: use normative language to clarify assumptions<a href="#appendix-B.7-4.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-09">
<section id="appendix-B.8">
        <h3 id="name-draft-dekater-scion-controlplane-0">
<a href="#name-draft-dekater-scion-controlplane-0" class="section-name selfRef">draft-dekater-scion-controlplane-09</a>
        </h3>
<p id="appendix-B.8-1">Major changes:<a href="#appendix-B.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.8-2.1">
            <p id="appendix-B.8-2.1.1">"SCION AS numbers": make text representation for lower 32-bit ASes consistent with PKI draft, add reference to allocation.<a href="#appendix-B.8-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.8-3">Minor changes:<a href="#appendix-B.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.8-4.1">
            <p id="appendix-B.8-4.1.1">Nits and wording improvements<a href="#appendix-B.8-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.8-4.2">
            <p id="appendix-B.8-4.2.1">Reviewed use of normative language<a href="#appendix-B.8-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.8-4.3">
            <p id="appendix-B.8-4.3.1">Figures: redraw and use aasvg when possible<a href="#appendix-B.8-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.8-4.4">
            <p id="appendix-B.8-4.4.1">"Paths and Links": clarify relationship between path segments and links<a href="#appendix-B.8-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.8-4.5">
            <p id="appendix-B.8-4.5.1">Ensure consistent use of example ranges<a href="#appendix-B.8-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-08">
<section id="appendix-B.9">
        <h3 id="name-draft-dekater-scion-controlplane-08">
<a href="#name-draft-dekater-scion-controlplane-08" class="section-name selfRef">draft-dekater-scion-controlplane-08</a>
        </h3>
<p id="appendix-B.9-1">Major changes:<a href="#appendix-B.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.9-2.1">
            <p id="appendix-B.9-2.1.1">Abstract: reword, mention goal and that document is not an Internet Standard<a href="#appendix-B.9-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.9-2.2">
            <p id="appendix-B.9-2.2.1">"Propagation of PCBs" section:<a href="#appendix-B.9-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.9-2.2.2.1">
                <p id="appendix-B.9-2.2.2.1.1">clarify checks at reception<a href="#appendix-B.9-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.9-2.2.2.2">
                <p id="appendix-B.9-2.2.2.2.1">introduce criteria for PCB selection policies<a href="#appendix-B.9-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.9-2.2.2.3">
                <p id="appendix-B.9-2.2.2.3.1">remove superfluous policy example figure<a href="#appendix-B.9-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.9-2.2.2.4">
                <p id="appendix-B.9-2.2.2.4.1">Propagation Interval and Best PCBs Set Size: mention tradeoff between scalability and amount of paths discovered.<a href="#appendix-B.9-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.9-2.2.2.5">
                <p id="appendix-B.9-2.2.2.5.1">reorganize order of paragraphs<a href="#appendix-B.9-2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-B.9-2.3">
            <p id="appendix-B.9-2.3.1">New section "Security Properties" in Security considerations, based on formal model of SCION<a href="#appendix-B.9-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.9-2.4">
            <p id="appendix-B.9-2.4.1">New figure: Control Service RPC API - Trust Material definitions<a href="#appendix-B.9-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.9-3">Minor changes:<a href="#appendix-B.9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.9-4.1">
            <p id="appendix-B.9-4.1.1">Moved "Special-Purpose SCION AS Numbers" table later in text<a href="#appendix-B.9-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.9-4.2">
            <p id="appendix-B.9-4.2.1">Split "Circular dependencies and partitioning" into two sections: "Bootstrapping ability" and "Resistance to partitioning".<a href="#appendix-B.9-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.9-4.3">
            <p id="appendix-B.9-4.3.1">Explain why PCBs have a next_isd_as field<a href="#appendix-B.9-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.9-4.4">
            <p id="appendix-B.9-4.4.1">Qualified better the choice of time allowance in the definition of segment from the future in section "PCB Validity".<a href="#appendix-B.9-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-07">
<section id="appendix-B.10">
        <h3 id="name-draft-dekater-scion-controlplane-07">
<a href="#name-draft-dekater-scion-controlplane-07" class="section-name selfRef">draft-dekater-scion-controlplane-07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.10-1.1">
            <p id="appendix-B.10-1.1.1">Moved SCMP specification from draft-dekater-scion-dataplane-03 to this document<a href="#appendix-B.10-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-06">
<section id="appendix-B.11">
        <h3 id="name-draft-dekater-scion-controlplane-06">
<a href="#name-draft-dekater-scion-controlplane-06" class="section-name selfRef">draft-dekater-scion-controlplane-06</a>
        </h3>
<p id="appendix-B.11-1">Major changes:<a href="#appendix-B.11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.11-2.1">
            <p id="appendix-B.11-2.1.1">New section: Path MTU<a href="#appendix-B.11-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-2.2">
            <p id="appendix-B.11-2.2.1">New section: Monitoring Considerations<a href="#appendix-B.11-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-2.3">
            <p id="appendix-B.11-2.3.1">Completed description of Control Services RPC API in appendix<a href="#appendix-B.11-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.11-3">Minor changes:<a href="#appendix-B.11-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.11-4.1">
            <p id="appendix-B.11-4.1.1">Introduction: clarify goal of the document<a href="#appendix-B.11-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-4.2">
            <p id="appendix-B.11-4.2.1">Clarify typical vs recommended-limits values for best PCB set size and for certificate validity duration.<a href="#appendix-B.11-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-4.3">
            <p id="appendix-B.11-4.3.1">Clarify text representation of ISD-AS<a href="#appendix-B.11-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-4.4">
            <p id="appendix-B.11-4.4.1">General rewording<a href="#appendix-B.11-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-4.5">
            <p id="appendix-B.11-4.5.1">Added reference to SCIONLab as a testbed for implementors<a href="#appendix-B.11-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.11-4.6">
            <p id="appendix-B.11-4.6.1">Introduced this change log<a href="#appendix-B.11-4.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-05">
<section id="appendix-B.12">
        <h3 id="name-draft-dekater-scion-controlplane-05">
<a href="#name-draft-dekater-scion-controlplane-05" class="section-name selfRef">draft-dekater-scion-controlplane-05</a>
        </h3>
<p id="appendix-B.12-1">Minor changes:<a href="#appendix-B.12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.12-2.1">
            <p id="appendix-B.12-2.1.1">Clarify beaconing fast retry at bootstrapping<a href="#appendix-B.12-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-controlplane-04">
<section id="appendix-B.13">
        <h3 id="name-draft-dekater-scion-controlplane-04">
<a href="#name-draft-dekater-scion-controlplane-04" class="section-name selfRef">draft-dekater-scion-controlplane-04</a>
        </h3>
<p id="appendix-B.13-1">Major changes:<a href="#appendix-B.13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.13-2.1">
            <p id="appendix-B.13-2.1.1">Clarified selection of MAC including a default algorithm<a href="#appendix-B.13-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-2.2">
            <p id="appendix-B.13-2.2.1">New section: PCB validity<a href="#appendix-B.13-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-2.3">
            <p id="appendix-B.13-2.3.1">New section: configuration<a href="#appendix-B.13-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-2.4">
            <p id="appendix-B.13-2.4.1">New section: Path Discovery Time and Scalability<a href="#appendix-B.13-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-2.5">
            <p id="appendix-B.13-2.5.1">New section: Effects of Clock Inaccuracy<a href="#appendix-B.13-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-2.6">
            <p id="appendix-B.13-2.6.1">New appendix: Control Service RPC API<a href="#appendix-B.13-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.13-3">Minor changes:<a href="#appendix-B.13-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.13-4.1">
            <p id="appendix-B.13-4.1.1">Introduction: Added overview of SCION components<a href="#appendix-B.13-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.2">
            <p id="appendix-B.13-4.2.1">Clarified path reversibility, link types, Interface IDs<a href="#appendix-B.13-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.3">
            <p id="appendix-B.13-4.3.1">Fixed private AS range typo<a href="#appendix-B.13-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.4">
            <p id="appendix-B.13-4.4.1">Clarified PCB selection policies and endpoint requirements<a href="#appendix-B.13-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.5">
            <p id="appendix-B.13-4.5.1">Clarified PCB propagation<a href="#appendix-B.13-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.6">
            <p id="appendix-B.13-4.6.1">General edits to make terminology consistent, remove duplication and rationalize text<a href="#appendix-B.13-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.7">
            <p id="appendix-B.13-4.7.1">Removed forward references<a href="#appendix-B.13-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.13-4.8">
            <p id="appendix-B.13-4.8.1">Added RFC2119 compliant terminology<a href="#appendix-B.13-4.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">Many thanks go to Alvaro Retana (Futurewei), Joel M. Halpern (Ericsson), Brian Trammel (Google), William Boye (Swiss National Bank), Matthias Frei (SCION Association), Kevin Meynell (SCION Association), Jean-Christophe Hugly (SCION Association), Juan A. Garcia Prado (ETH Zurich), Tilmann Zäschke (ETH Zurich), Dominik Roos (Anapaya Systems), and Roger Lapuh (Extreme Networks) for reviewing this document. We also thank Daniel Galán Pascual and Christoph Sprenger from the Information Security Group at ETH Zurich for their inputs based on their formal verification work on SCION. We are also very grateful to Adrian Perrig (ETH Zurich), for providing guidance and feedback about every aspect of SCION. Finally, we are indebted to the SCION development teams of Anapaya and ETH Zurich for their practical knowledge and for the documentation about the SCION Control Plane, as well as to the authors of <span>[<a href="#CHUAT22" class="cite xref">CHUAT22</a>]</span> - the book is an important source of input and inspiration for this draft.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Corine de Kater</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:c_de_kater@gmx.ch" class="email">c_de_kater@gmx.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nicola Rustignoli</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nic@scion.org" class="email">nic@scion.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Hitz</span></div>
<div dir="auto" class="left"><span class="org">Anapaya Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hitz@anapaya.net" class="email">hitz@anapaya.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
